/*! ewebrtc-sdk - v1.0.2 - 28-08-2015 */
if(function(){"use strict";var a={"private":{factories:{},config:{},errorStore:{}},utils:{},errorDictionary:{},logManager:{},RESTClient:{},rtc:{},browser:{}};window.ATT=a}(),!ATT)var ATT={};if(function(a){"use strict";function b(a){return String(Number(a))===a?Number(a):a}function c(a,c,d,e){var f;if(e&&!d)c[e]=b(a[1]);else for(f=0;f<d.length;f+=1)a[f+1]&&(c[d[f]]=b(a[f+1]))}function d(a,b,d){var e,f=a.name&&a.names;a.push&&!b[a.push]?b[a.push]=[]:f&&!b[a.name]&&(b[a.name]={}),e=a.push?{}:f?b[a.name]:b,c(d.match(a.reg),e,a.names,a.name),a.push&&b[a.push].push(e)}function e(a){var b={},c=[],e=b;return a.split("\r\n").filter(m).forEach(function(a){var b,f,g=a[0],h=a.slice(2);for("m"===g&&(c.push({rtp:[],fmtp:[]}),e=c[c.length-1]),f=0;f<(k[g]||[]).length;f+=1)if(b=k[g][f],b.reg.test(h))return d(b,e,h)}),b.media=c,b}function f(a){var b=1,c=arguments,d=c.length;return a.replace(n,function(a){if(b>=d)return a;var e=c[b];switch(b+=1,a){case"%%":return"%";case"%s":return String(e);case"%d":return Number(e);case"%v":return""}})}function g(a,b,c){var d,e,g,h=b.format instanceof Function?b.format(b.push?c:c[b.name]):b.format;if(g=[a+"="+h],b.names)for(d=0;d<b.names.length;d+=1)e=b.names[d],b.name?g.push(c[b.name][e]):g.push(c[b.names[d]]);else g.push(c[b.name]);return f.apply(null,g)}function h(a,b){b=b||{},a.version||(a.version=0),a.name||(a.name=" "),a.media.forEach(function(a){null==a.payloads&&(a.payloads="")});var c=b.outerOrder||q,d=b.innerOrder||p,e=[];return c.forEach(function(b){k[b].forEach(function(c){a.hasOwnProperty(c.name)?e.push(g(b,c,a)):a.hasOwnProperty(c.push)&&a[c.push].forEach(function(a){e.push(g(b,c,a))})})}),a.media.forEach(function(a){e.push(g("m",k.m[0],a)),d.forEach(function(b){k[b].forEach(function(c){a.hasOwnProperty(c.name)?e.push(g(b,c,a)):a.hasOwnProperty(c.push)&&a[c.push].forEach(function(a){e.push(g(b,c,a))})})})}),e.join("\r\n")+"\r\n"}function i(){return{parse:function(a){return e(a)},write:function(a){return h(a)}}}var j,k,l,m,n,o={},p=["i","c","b","a"],q=["v","o","s","i","u","e","p","c","b","t","r","z","a"];k={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: ([\w\W]*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)\/(\d*)(?:\s*\/(\S*))?/,names:["payload","codec","rate","encoding"],format:function(a){return null!=a.encoding?"rtpmap:%d %s/%s/%s":"rtpmap:%d %s/%s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S\s]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:([\w\W]*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(a){return null!=a.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\-\w_]*)(?: ([\-\w_]*))?/,names:["payload","type","subtype"],format:function(a){return null!=a.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(a){return null!=a.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(a){return null!=a.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:(\S*)/,format:"mid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/,format:"%s"},{name:"iceLite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","generation"],format:function(a){var b="candidate:%s %d %s %d %s %d typ %s";return b+=a.raddr?" raddr %s rport %d":"%v%v",null!=a.generation&&(b+=" generation %d"),b}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:([\w\W]*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):([\w\W]*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{name:"ssrcGroup",reg:/^ssrc-group:(\w*) ([\w\W]*)/,names:["value","ssrcids"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{name:"msid",reg:/^msid:\{?([\w\-]*)\}?\s?\{?([\w\-]*)?\}?/,names:["id","appdata"],format:function(a){return null!=a.appdata?"msid:%s %s":"msid:%s"}},{push:"groups",reg:/^group:(\w*) ([\w\W]*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"3ge2ae",reg:/^3ge2ae:(\w*)/,names:["value"],format:"3ge2ae:%s"},{push:"invalid",names:["value"]}]},Object.keys(k).forEach(function(a){l=k[a],l.forEach(function(a){a.reg||(a.reg=/([\w\W]*)/),a.format||(a.format="%s")})}),m=RegExp.prototype.test.bind(/^([a-z])=([\w\W]*)/),n=/%[sdv%]/g,a.sdpParser=o,o.getInstance=function(){return j||(j=i()),j}}(ATT||{}),function(){"use strict";function a(){return["error","warn","info","debug","trace"]}function b(){return u}function c(a){var b;for(b in q)q.hasOwnProperty(b)&&q[b].setLogLevel(a)}function d(){var a,b="",c="",d=[],e="",f=[];try{throw new Error}catch(g){return c=0===g.stack.split("\n")[0].indexOf("Error")?g.stack.split("\n")[4]:g.stack.split("\n")[3],d=c.split(":"),5<=d.length?(e=d[2],f=void 0===e?[]:e.split("/"),b=f[f.length-1],void 0!==b&&b.indexOf("?")>-1&&(b=b.split("?")[0]),a=d[3]):(e=d[0],f=void 0===e?[]:e.split(" "),b=f[f.length-1],void 0!==b&&b.indexOf("?")>-1&&(b=b.split("?")[0]),a=d[1]),b+":"+a}}function e(b,c,e){var f,g,h,i=e||"",j=b;f=a().indexOf(b),g=t[f],void 0===console[b]&&(j="log"),(void 0===c||"function"==typeof c)&&(c=""),(void 0===e||"function"==typeof e)&&(i=""),void 0!==e&&"object"==typeof e&&(i=":",h=e),console[j](g,c,i,"["+d()+"]"),void 0!==h&&console[j](h)}function f(){return r}function g(){return s}function h(b){if(void 0===b||"string"!=typeof b||0===b.length)throw new Error("No log level provided");if(-1===a().indexOf(b))throw new Error("Invalid log level provided");s=b,c(b)}function i(){var a,b=[];for(a in q)q.hasOwnProperty(a)&&b.push(a);return b}function j(){var a;for(a in u)u.hasOwnProperty(a)&&void 0!==q[a]&&q[a].setLogLevel(u[a]);for(a in q)q.hasOwnProperty(a)&&void 0===u[a]&&q[a].setLogLevel(r)}function k(b){function c(){return m}function d(){return l}function f(b){if(void 0===b||"string"!=typeof b||0===b.length)throw new Error("No log level provided");if(-1===a().indexOf(b))throw new Error("Invalid log level provided");l=b}function g(b){var c=a(),d=this.getLogLevel();c.indexOf("error")<=c.indexOf(d)&&e("error",b)}function h(b){var c=a(),d=this.getLogLevel();c.indexOf("warn")<=c.indexOf(d)&&e("warn",b)}function i(b){var c=a(),d=this.getLogLevel();c.indexOf("info")<=c.indexOf(d)&&e("info",b)}function j(b){var c=a(),d=this.getLogLevel();c.indexOf("debug")<=c.indexOf(d)&&e("debug",b)}function k(b,c){var d=a(),f=this.getLogLevel();d.indexOf("trace")<=d.indexOf(f)&&e("trace",b,c)}var l="",m=b||!1;this.isCustomType=c,this.setLogLevel=f,this.getLogLevel=d,this.logError=g,this.logWarning=h,this.logInfo=i,this.logDebug=j,this.logTrace=k}function l(a,b){if(void 0===a||"string"!=typeof a||0===a.length)throw new Error("No module name provided");if(q[a])throw new Error("logger is already defined");return q[a]=new k(b),void 0!==u[a]?q[a].setLogLevel(u[a]):q[a].setLogLevel(r),q[a]}function m(a){return l(a,!0)}function n(a){if(void 0===a||"string"!=typeof a||0===a.length)throw new Error("No module name provided");if(!q[a])throw new Error("Invalid module name provided");if(q[a].isCustomType()!==!0)throw new Error("Cannot delete "+a+" logger");delete q[a]}function o(a){if(void 0===a||"string"!=typeof a||0===a.length)throw new Error("No module name provided");if(void 0===q[a])throw new Error("Logger "+a+" not found");return q[a]}function p(){var a,b={},c=i();for(a=0;a<c.length;a+=1)b[c[a]]=o(c[a]).getLogLevel();return b}var q={},r="warn",s=r,t=["[ERROR]","[WARNING]","[INFO]","[DEBUG]","[TRACE]"],u={call:"info",session:"info"};ATT.logManager=function(){return{getLogLevels:a,getCurrentModuleLogLevels:p,getLoggers:i,getLogger:o,getDefaultLogLevel:f,getGlobalLogLevel:g,setGlobalLogLevel:h,resetLogLevels:j,createLogger:l,createCustomLogger:m,deleteCustomLogger:n,getModuleDefaults:b}}()}(),function(){"use strict";function a(){function a(a,b){a.callback.apply(a.context,b)}var b={};return{getTopics:function(){return b},unsubscribe:function(a,c){var d,e;if(!b.hasOwnProperty(a))return!1;if("function"!=typeof c)throw new Error("Must pass in the callback you are unsubscribing");for(e=b[a],d=0;d<e.length;d+=1)if(e[d].callback===c)return e.splice(d,1),0===e.length&&delete b[a],!0;return!1},publish:function(){var c,d,e=Array.prototype.slice.call(arguments),f=e.shift();if(!b.hasOwnProperty(f))return!1;for(d=b[f],c=0;c<d.length;c+=1)setTimeout(a.bind(null,b[f][c],e),0);return!0},subscribe:function(a,c,d){var e,f,g;if(""===a||null===a||void 0===a)return!1;if("function"!=typeof c)return!1;if(void 0!==d&&(null===d||"object"!=typeof d))return!1;for(g={context:d,callback:c},b.hasOwnProperty(a)||(b[a]=[]),e=b[a],f=0;f<e.length;f+=1)if(c===e[f].callback)return!1;return b[a].push(g),!0}}}var b;b=typeof window.ATT,void 0===b?window.ATT={"private":{factories:{}}}:void 0===ATT["private"]&&(ATT["private"]={factories:{}}),ATT["private"].factories.createEventEmitter=a}(),!ATT)var ATT={};var attUtils=null;"object"==typeof module&&module&&"object"==typeof module.exports&&(attUtils={utils:require("./att.utils"),logManager:require("./att.log-manager.js")},module.exports=attUtils);var RESTClient=function(a){"use strict";function b(b){b.forEach(function(b){i.prototype[b]=function(c){c.method=b,c.headers=g(a).extend(this.config.headers,c.headers),this.ajax(c)}})}var c,d=typeof window,e="object"==typeof module&&module&&"object"==typeof module.exports,f={"Content-Type":"application/json",Accept:"application/json"},g=function(a){return e?attUtils.utils.utils:a.utils},h=ATT.logManager.createLogger("RESTClient"),i=function(b){this.config=g(a).extend({},b),this.config.async=this.config.async||!0,this.config.success=this.config.success||function(){},this.config.error=this.config.error||c,this.config.ontimeout=this.config.ontimeout||function(a){h.logDebug(a),h.logError("Request timed out")},this.config.headers=this.config.headers||f},j=function(a,b,c,d){var e,f=JSON.stringify(d);h.logDebug("---------Request---------------"),h.logDebug(a+" "+b+" HTTP/1.1"),h.logDebug("=========headers=======");for(e in c)c.hasOwnProperty(e)&&h.logDebug(e+": "+c[e]);void 0!==f&&(h.logDebug("=========body=========="),h.logDebug(f))},k=function(a){h.logDebug("---------Response--------------"),h.logDebug(a.getResponseStatus()),h.logDebug("=========headers======="),h.logDebug(a.headers),h.logDebug("=========body=========="),h.logDebug(a.responseText)},l=function(a){var b,c=a.getResponseHeader("Content-Type");return c&&0===c.indexOf("application/json")?(b=JSON.parse(a.responseText),"object"==typeof b?b:JSON.parse(b)):""},m=function(a,b){var c={getJson:function(){return l(a)},getResponseHeader:function(b){return a.getResponseHeader(b)},responseText:a.responseText,headers:a.getAllResponseHeaders(),statusText:a.statusText,getResponseStatus:function(){return a.status},getResourceURL:function(){return b.method.toUpperCase()+" "+b.url}};return c},n=function(b){var d=this,e=m(d,b),f=g(a).extend({},e);k(f),d.status>=400&&d.status<=599?"function"==typeof b.error?b.error.call(d,f):c.call(d,f):b.success.call(d,f)},o=function(b){var c=this,d=m(c,b),e=g(a).extend({},d);k(e),b.error.call(this,e)},p=function(b){var c=this,d=m(c,b),e=g(a).extend({},d);k(e),h.logError("Request timeout"),b.ontimeout.call(this,e)};return i.prototype.ajax=function(){var a=this.config,b=new XMLHttpRequest,d=null,e=null;try{d=a.data&&JSON.stringify(a.data),void 0!==a.timeout&&(b.timeout=a.timeout),b.onload=n.bind(b,a),b.onerror=function(){if("undefined"===a.error)throw new Error("Network error occurred in REST client.");o.call(this,a)},b.onreadystatechange=function(){4===this.readyState&&0===this.status&&""===this.statusText&&void 0===a.ontimeout&&(h.logError("Failed to complete request for resource:"+a.url),o.call(this,a))},b.onabort=o.bind(b,a),b.ontimeout=p.bind(b,a),b.open(a.method,a.url,a.async);for(e in a.headers)a.headers.hasOwnProperty(e)&&b.setRequestHeader(e,a.headers[e]);j(a.method,a.url,a.headers,d),b.send(d)}catch(f){h.logError("XHR request failed, "+f),"function"==typeof a.error?o.call(b,f):c.call(b,f)}},c=function(a){throw new Error("RESTClient error handler triggered!"+a)},b(["get","post","delete"]),i.prototype.getConfig=function(){return this.config},"undefined"!==d&&ATT&&(ATT.RESTClient=i),i}(ATT);if("object"==typeof module&&module&&"object"==typeof module.exports&&(module.exports=RESTClient),function(){"use strict";function a(b,c){var d;for(d in c)c.hasOwnProperty(d)&&(c[d]instanceof Object?b[d]=a(c[d]):b[d]=c[d]);return b}function b(a,b){a["super"]=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}function c(a,b){var c=b.split("."),d=a;return c.forEach(function(a){d[a]||(d[a]={}),d=d[a]}),d}function d(a){return null===a.match(new RegExp("[^0-9]"))?10===a.length?"tel:+"+a:0===a.indexOf("1")?"tel:+"+a:0===a.indexOf("+")?"tel:"+a:"sip:"+a+"@icmn.api.att.net":a.indexOf("@")>0?"sip:"+a:null}function e(){var a,b=navigator.userAgent,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(c[1])?(a=/\brv[ :]+(\d+)/g.exec(b)||[],"IE "+(a[1]||"")):"Chrome"===c[1]&&(a=b.match(/\bOPR\/(\d+)/),null!==a)?"Opera":(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],a=b.match(/version\/(\d+)/i),null!==a&&c.splice(1,1,a[1]),c[0])}function f(){var a,b=navigator.userAgent,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(c[1])?(a=/\brv[ :]+(\d+)/g.exec(b)||[],"IE "+(a[1]||"")):"Chrome"===c[1]&&(a=b.match(/\bOPR\/(\d+)/),null!==a)?a[1]:(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],a=b.match(/version\/(\d+)/i),null!==a&&c.splice(1,1,a[1]),c[1])}function g(a){var b,c;if(c=ATT.sdpParser.getInstance(),void 0===a||null===a)throw new Error("SDP not provided.");if(b=c.parse(a),1===b.media.length){if(void 0===b.media[0].direction&&(b.media[0].direction=b.direction),"sendrecv"===b.media[0].direction)return"audio";if("sendonly"===b.media[0].direction)return"audio";if("recvonly"===b.media[0].direction)return"nomedia";if("inactive"===b.media[0].direction)return"nomedia"}if(2===b.media.length){if("sendrecv"===b.media[0].direction&&"sendrecv"===b.media[1].direction&&0<b.media[1].port)return"video";if("sendonly"===b.media[0].direction&&"sendrecv"===b.media[1].direction)return"video";if("sendrecv"===b.media[0].direction&&"sendonly"===b.media[1].direction)return"video";if("sendonly"===b.media[0].direction&&"sendonly"===b.media[1].direction)return"video";if("sendrecv"===b.media[0].direction&&"recvonly"===b.media[1].direction)return"audio";if("sendrecv"===b.media[0].direction&&("inactive"===b.media[1].direction||0===b.media[1].port))return"audio";if("recvonly"===b.media[0].direction&&"recvonly"===b.media[1].direction)return"nomedia";if("inactive"===b.media[0].direction&&"inactive"===b.media[1].direction)return"nomedia"}return"unsupported"}function h(a){var b,c,d=[],e=ATT.sdpParser.getInstance().parse(a);for(b=0;b<e.media.length;b+=1)c={rtp:e.media[b].rtp,type:e.media[b].type},0<c.rtp.length&&d.push(c);return d}if(void 0===ATT)throw new Error("Error exporting ATT.utils");ATT.utils={createNamespace:c,extend:a,inherits:b,createCalledPartyUri:d,getBrowserName:e,getBrowserVersion:f,getCodecFromSdp:h,getMediaType:g}}(),function(a){"use strict";var b=a.logManager.createLogger("phoneNumber"),c={alphaLookup:{a:2,b:2,c:2,d:3,e:3,f:3,g:4,h:4,i:4,j:5,k:5,l:5,m:6,n:6,o:6,p:7,q:7,r:7,s:7,t:8,u:8,v:8,w:9,x:9,y:9,z:9},stringify:function(a){b.logDebug("att.phonenumber: stringify"),b.logInfo("removes all the special character "),b.logTrace(a);var d,e=c.translate(a),f=e.length,g="1"===e.charAt(0),h=e.split("");return f>(g?11:10)?e:!g&&4>f?e:(g&&h.splice(0,1),g?f>1&&(d=4-f,d=d>0?d:0,h.splice(0,0," ("),h.splice(4,0,new Array(d+1).join(" ")+") "),f>7&&h.splice(8,0,"-")):f>7?(h.splice(0,0,"("),h.splice(4,0,") "),h.splice(8,0,"-")):f>3&&h.splice(3,0,"-"),b.logTrace((g?"+1":"")+h.join("")),(g?"+1":"")+h.join(""))},translate:function(a){b.logDebug("att.phonenumber: translate"),b.logInfo("converts all the alphanumbers to Numbers "),b.logTrace(a);var d,e,f="";for(d=0;d<a.length;d+=1)e=a.charAt(d),isNaN(e)?void 0!==c.alphaLookup[e.toLowerCase()]&&(f+=c.alphaLookup[e.toLowerCase()]):f+=e;return b.logTrace(f),String(f)},getCallable:function(a,b){var d=b||"us",e=c.translate(a);return 10!==e.length?"us"===d&&11===e.length&&"1"===e.charAt(0)?e:e:"us"===d?"1"+e:void 0},cleanPhoneNumber:function(c){b.logDebug("att.phonenumber: cleanPhoneNumber"),b.logInfo("removes special character and convert the number to a callable format"),b.logTrace(c);var d;return-1!==c.indexOf("@")?c:(d=c.replace(/\s/g,""),a.SpecialNumbers[c]?(b.logTrace(c),c):(d=a.phoneNumber.translate(d),b.logTrace("Formatted Number",d),d))},formatNumber:function(c){b.logDebug("att.phonenumber: formatNumber"),b.logInfo("converts the given number to a universal format"),b.logTrace(c);var d=this.cleanPhoneNumber(c);return d?c.length<=10?(b.logTrace("Formatted Number",d),d):(b.logTrace("Formatted Number",a.phoneNumber.stringify(d)),a.phoneNumber.stringify(d)):void b.logWarning("Phone number cannot be formatted.")}};a.phoneNumber=c}(ATT),!ATT)var ATT={};if(function(a){"use strict";var b={};b.SpecialNumbers={911:!0,411:!0,611:!0,"*69":!0,"#89":!0},a.SpecialNumbers=Object.freeze(b.SpecialNumbers)}(ATT||{}),function(){"use strict";var a,b,c,d={};if(a={MOBILE_NUMBER:"MOBILE_NUMBER",VIRTUAL_NUMBER:"VIRTUAL_NUMBER",ACCOUNT_ID:"ACCOUNT_ID"},b={OUTGOING:"Outgoing",INCOMING:"Incoming"},c={INVITATION_RECEIVED:"invitation-received",SESSION_OPEN:"session-open",SESSION_MODIFIED:"session-modified",SESSION_TERMINATED:"session-terminated",MODIFICATION_RECEIVED:"mod-received",MODIFICATION_TERMINATED:"mod-terminated",MOVE_TERMINATED:"move-terminated",TRANSFER_INITIATED:"transfer-initiated",TRANSFER_TERMINATED:"transfer-terminated"},void 0===ATT["private"])throw new Error("Error exporting ATT.private.enum");d.USER_TYPE=Object.freeze(a),d.CALL_TYPE=Object.freeze(b),d.API_EVENT=Object.freeze(c),ATT["private"]["enum"]=d}(),!ATT)var ATT={};!function(){"use strict";function a(a){d.logDebug("ATT.private.config.api: configure"),d.logInfo("Configuring API..."),d.logTrace("appConfig",a);var b={rtc_endpoint:a.api_endpoint+a.ewebrtc_uri,headers:{"Content-Type":"application/json",Accept:"application/json"}};return{createWebRTCSession:{method:"POST",url:b.rtc_endpoint+"/sessions",formatters:{headers:{Authorization:function(a){return d.logDebug("createWebRTCSession:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a},"x-e911Id":function(a){return d.logDebug("createWebRTCSession:formatters:headers:x-e911Id"),d.logTrace("x-e911Id",a),a},"x-Arg":function(a){return d.logDebug("createWebRTCSession:formatters:headers:x-Arg"),d.logTrace("x-Arg",a),a}}},headers:b.headers},refreshWebRTCSession:{method:"PUT",formatters:{url:function(a){return d.logDebug("refreshWebRTCSession:formatters:url"),d.logTrace("sessionId",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a),b.rtc_endpoint+"/sessions/"+a},headers:{Authorization:function(a){return d.logDebug("refreshWebRTCSession:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a}}},headers:b.headers},deleteWebRTCSession:{method:"DELETE",formatters:{url:function(a){return d.logDebug("deleteWebRTCSession:formatters:url"),d.logTrace("sessionId",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a),b.rtc_endpoint+"/sessions/"+a},headers:{Authorization:function(a){return d.logDebug("deleteWebRTCSession:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a},"x-e911Id":function(a){return d.logDebug("deleteWebRTCSession:formatters:headers:x-e911Id"),d.logTrace("x-e911Id",a),a}}},headers:b.headers},associateTokenWithUserId:{method:"PUT",formatters:{url:function(a){return d.logDebug("associateTokenWithUserId:formatters:url"),d.logTrace("params",a),d.logTrace("url",b.rtc_endpoint+"/userIds/"+a.userId),b.rtc_endpoint+"/userIds/"+a.userId},headers:{Authorization:function(a){return d.logDebug("associateTokenWithUserId:formatters:headers:Authorization"),d.logTrace("oAuthToken",a),d.logTrace("Authorization","Bearer "+a),"Bearer "+a}}},headers:{Accept:"application/json"}},associateE911Id:{method:"PUT",formatters:{url:function(a){return d.logDebug("associateE911Id:formatters:url"),d.logTrace("sessionId",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a),b.rtc_endpoint+"/sessions/"+a},headers:{Authorization:function(a){return d.logDebug("associateE911Id:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a}}},headers:b.headers},getEvents:{formatters:{method:"GET",url:function(a){return d.logDebug("getEvents:formatters:url"),d.logTrace("params",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.eventChannelUri),b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.eventChannelUri},headers:{Authorization:function(a){return d.logDebug("getEvents:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a}}},headers:{Accept:"application/json"}},createCall:{method:"POST",formatters:{url:function(a){return d.logDebug("createCall:formatters:url"),d.logTrace("params",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type),b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type},headers:{Authorization:function(a){return d.logDebug("createCall:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a}}},headers:b.headers},modifyCall:{method:"PUT",formatters:{url:function(a){return d.logDebug("modifyCall:formatters:url"),d.logTrace("params",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId),b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId},headers:{Authorization:function(a){return d.logDebug("modifyCall:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a},options:{"x-conference-action":function(a){return d.logDebug("modifyCall:formatters:headers:options:x-conference-action"),d.logTrace("x-conference-action",a),a},"x-calls-action":function(a){return d.logDebug("modifyCall:formatters:headers:options:x-calls-action"),d.logTrace("x-calls-action",a),a}}}},headers:b.headers},addParticipant:{method:"PUT",formatters:{url:function(a){return d.logDebug("addParticipant:formatters:url"),d.logTrace("params",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a[0]+"/conferences/"+a[1]+"/participants/"+a[2]),b.rtc_endpoint+"/sessions/"+a[0]+"/conferences/"+a[1]+"/participants/"+a[2]},headers:{Authorization:function(a){return d.logDebug("addParticipant:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a}}},headers:b.headers},removeParticipant:{method:"DELETE",formatters:{url:function(a){return d.logDebug("removeParticipant:formatters:url"),d.logTrace("params",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a[0]+"/conferences/"+a[1]+"/participants/"+a[2]),b.rtc_endpoint+"/sessions/"+a[0]+"/conferences/"+a[1]+"/participants/"+a[2]},headers:{Authorization:function(a){return d.logDebug("removeParticipant:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a}}},headers:b.headers},rejectMediaModification:{method:"PUT",formatters:{url:function(a){return d.logDebug("rejectMediaModification:formatters:url"),d.logTrace("params",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId),b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId},headers:{Authorization:function(a){return d.logDebug("rejectMediaModification:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a},"x-modId":function(a){return d.logDebug("rejectMediaModification:formatters:headers:x-modId"),d.logTrace("x-modId",a),a}}},headers:ATT.utils.extend({"x-calls-action":"rejectCancel-call-mod"},b.headers)},acceptCallModifications:{method:"PUT",formatters:{url:function(a){return d.logDebug("acceptCallModifications:formatters:url"),d.logTrace("params",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId),b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId},headers:{Authorization:function(a){return d.logDebug("acceptCallModifications:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a},"x-modId":function(a){return d.logDebug("acceptCallModifications:formatters:headers:x-modId"),d.logTrace("x-modId",a),a}}},headers:ATT.utils.extend({"x-calls-action":"accept-call-mod"},b.headers)},acceptConferenceModifications:{method:"PUT",formatters:{url:function(a){return d.logDebug("acceptConferenceModifications:formatters:url"),d.logTrace("params",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId),b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId},headers:{Authorization:function(a){return d.logDebug("acceptConferenceModifications:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a},"x-mod-Id":function(a){return d.logDebug("acceptConferenceModifications:formatters:headers:x-mod-Id"),d.logTrace("x-mod-Id",a),a}}},headers:ATT.utils.extend({"x-conference-action":"accept-media-mod"},b.headers)},deleteCall:{method:"DELETE",formatters:{url:function(a){return d.logDebug("deleteCall:formatters:url"),d.logTrace("params",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId),b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId},headers:{Authorization:function(a){return d.logDebug("deleteCall:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a},"x-delete-reason":function(a){return d.logDebug("deleteCall:formatters:headers:x-delete-reason"),d.logTrace("x-delete-reason",a),a}}},headers:b.headers},transferCall:{method:"PUT",formatters:{url:function(a){return d.logDebug("transferCall:formatters:url"),d.logTrace("params",a),d.logTrace("url",b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId),b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId},headers:{Authorization:function(a){return d.logDebug("transferCall:formatters:headers:Authorization"),d.logTrace("Authorization","Bearer "+a),"Bearer "+a},"x-transferTargetCallId":function(a){return d.logDebug("transferCall:formatters:headers:x-transferTargetCallId"),d.logTrace("x-transferTargetCallId",a),a}}},headers:ATT.utils.extend({"x-calls-action":"initiate-call-transfer"},b.headers)}}}function b(){d.logDebug("ATT.private.config.api: getAPIConfiguration");var b=c.app.getAppConfiguration();return d.logTrace("currentConfig",b),a(b)}var c,d=ATT.logManager.createLogger("configAPI");if(void 0===ATT["private"]||void 0===ATT["private"].config)throw d.logError("Error exporting ATT.private.config.api"),new Error("Error exporting ATT.private.config.api");c=ATT["private"].config,c.api={getAPIConfiguration:b}}(),function(){"use strict";function a(){return k}function b(){return s.logDebug("ATT.private.config.app: getAppConfiguration"),s.logInfo("Getting app configuration"),i={api_endpoint:l,ewebrtc_uri:m,eventChannelType:o},s.logTrace("appConfig",i),i}function c(a){s.logDebug("ATT.private.config.app: setAppConfiguration"),s.logInfo("Setting app configuration"),s.logTrace("options",a),l=a.api_endpoint||l,m=a.ewebrtc_uri||m}function d(){return r}function e(){return j}function f(a){if(void 0===a||null===a)throw new Error("No PC configuration provided");if(0===Object.keys(a).length)throw new Error("Invalid PC configuration provided");if(a.hasOwnProperty("iceServers")){if(void 0===a.iceServers||null===a.iceServers)throw new Error("No iceServers provided");if(!Array.isArray(a.iceServers)||0===a.iceServers.length)throw new Error("Invalid iceServers provided");a.iceServers.forEach(function(a){if("string"!=typeof a.url||""===a.url)throw new Error("Invalid iceServer url provided")}),j.iceServers=a.iceServers}if(a.hasOwnProperty("iceTransports")){if("string"!=typeof a.iceTransports||-1===q.indexOf(a.iceTransports))throw new Error("Invalid iceTransports provided");j.iceTransports=a.iceTransports}if(a.hasOwnProperty("ipv6")){if("boolean"!=typeof a.ipv6)throw new Error("Invalid ipv6 provided");j.ipv6=a.ipv6}if(a.hasOwnProperty("audioCodec")){if("string"!=typeof a.audioCodec||""===a.audioCodec)throw new Error("Invalid audioCodec provided");var b=!1;if(r.forEach(function(c){c.toLowerCase()===a.audioCodec.toLowerCase()&&(b=!0)}),!b)throw new Error("Invalid audioCodec provided. Please use one of these options: "+r.join(", "));j.audioCodec=a.audioCodec}}function g(a){if(void 0!==a&&!p.hasOwnProperty(a))throw new Error("Invalid PC configuration provided");void 0===a&&(j=ATT.utils.extend({},p)),p.hasOwnProperty(a)&&(j[a]=p[a])}function h(){return t}var i,j,k={supported:[{name:"Chrome",version:{min:38}},{name:"Firefox",version:{min:33,max:33}}],not_certified:[{name:"Chrome",version:{min:32,max:37}},{name:"Firefox",version:{min:28,max:32}},{name:"Firefox",version:{min:34}},{name:"Opera"}]},l="https://api.att.com",m="/RTC/v1",n={WebSockets:"WebSockets",LongPolling:"LongPolling"},o=n.LongPolling,p={iceServers:[{url:"STUN:12.194.159.4"},{url:"STUN:12.194.159.7"},{url:"STUN:12.194.159.10"},{url:"STUN:12.194.194.4"},{url:"STUN:12.194.194.7"},{url:"STUN:12.194.194.10"}],iceTransports:"all",ipv6:!1,audioCodec:null},q=["all","none","relay"],r=["opus","G722","PCMU","PCMA"],s=ATT.logManager.createLogger("configApp"),t="1.0.2";if(j=ATT.utils.extend({},p),s.logDebug("Loading ATT.private.config.app..."),void 0===ATT["private"]||void 0===ATT["private"].config)throw new Error("Error exporting ATT.private.config.app");ATT["private"].config.app={getBrowserSupport:a,getAppConfiguration:b,setAppConfiguration:c,getSupportedAudioCodecs:d,getPCConfiguration:e,setPCConfiguration:f,resetPCConfiguration:g,getVersion:h}}(),function(){"use strict";var a,b={};if(a=[{JSObject:"*",JSMethod:"*",ErrorCode:"0000",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"*",JSMethod:"*",ErrorCode:"0001",ErrorMessage:"Error published with unknown error code.",Cause:"Error code is not defined in error dictionary.",Resolution:"Add the error object to the error dictionary."},{JSObject:"*",JSMethod:"*",ErrorCode:"0002",ErrorMessage:"Request timed out.",Cause:"Network failure.",Resolution:"Please check the logs and network connectivity and try again."
},{JSObject:"phone",JSMethod:"*",ErrorCode:"0020",ErrorMessage:"Cannot complete the operation.",Cause:"Permission denied to access local media (audio/video).",Resolution:"Please grant permission to access local media (audio/video) and retry the operation."},{JSObject:"phone",JSMethod:"login",ErrorCode:"2000",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"login",ErrorCode:"2001",ErrorMessage:"Cannot complete operation login without input parameters.",Cause:"Login invoked with no parameters.",Resolution:"Please invoke login with mandatory input parameters."},{JSObject:"phone",JSMethod:"login",ErrorCode:"2002",ErrorMessage:"Cannot complete operation login without `token`.",Cause:"Login invoked without `token`.",Resolution:"Please invoke login with mandatory parameter `token`."},{JSObject:"phone",JSMethod:"login",ErrorCode:"2003",ErrorMessage:"Cannot complete operation login as a login session already exists.",Cause:"Login invoked when there is an existing login session.",Resolution:"Invoke logout before trying to login again."},{JSObject:"phone",JSMethod:"associateE911Id",ErrorCode:"2050",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"associateE911Id",ErrorCode:"2051",ErrorMessage:"Cannot complete operation operation associate E911 id without input parameters.",Cause:"Associate E911 id invoked with no parameters.",Resolution:"Please invoke operation associate E911 id with mandatory input parameters."},{JSObject:"phone",JSMethod:"associateE911Id",ErrorCode:"2052",ErrorMessage:"Cannot complete operation associate E911 id without `e911Id`.",Cause:"Associate E911 id invoked without `e911Id`.",Resolution:"Please invoke associate E911 id with mandatory parameter `e911Id`."},{JSObject:"phone",JSMethod:"associateE911Id",ErrorCode:"2053",ErrorMessage:"Cannot complete operation associate E911 id as there is no login session.",Cause:"Associate E911 id invoked without a login session.",Resolution:"Please invoke associate E911 id after a login session is established."},{JSObject:"phone",JSMethod:"logout",ErrorCode:"2100",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"logout",ErrorCode:"2101",ErrorMessage:"Cannot complete operation logout as there is no existing login session.",Cause:"Logout invoked without an existing login session.",Resolution:"Please invoke logout after there is an existing login session."},{JSObject:"phone",JSMethod:"dial",ErrorCode:"2200",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"dial",ErrorCode:"2201",ErrorMessage:"Cannot complete operation dial without input parameters.",Cause:"Dial invoked with no parameters.",Resolution:"Please invoke dial with mandatory input parameters."},{JSObject:"phone",JSMethod:"dial",ErrorCode:"2211",ErrorMessage:"Cannot complete operation dial without valid `destination`.",Cause:"Dial invoked with invalid or missing `destination`.",Resolution:"Please invoke dial with a valid `destination` parameter."},{JSObject:"phone",JSMethod:"dial",ErrorCode:"2212",ErrorMessage:"Cannot complete operation dial as `destination` is a SIP or TEL URI.",Cause:"Dial invoked with `destination` that is a SIP or TEL URI.",Resolution:"Please invoke dial with a `destination` that is not a SIP or TEL URI."},{JSObject:"phone",JSMethod:"dial",ErrorCode:"2213",ErrorMessage:"Cannot complete operation dial as `destination` is an invalid address.",Cause:"Dial invoked with `destination` that is an invalid address string.",Resolution:"Please invoke dial with a `destination` that is a valid address string."},{JSObject:"phone",JSMethod:"dial",ErrorCode:"2221",ErrorMessage:"Cannot complete operation dial as `mediaType` is invalid.",Cause:"Dial invoked with invalid `mediaType`.",Resolution:"Please invoke dial with a valid `mediaType` parameter (audio or video)."},{JSObject:"phone",JSMethod:"dial",ErrorCode:"2231",ErrorMessage:"Cannot complete operation dial as `localMedia` is invalid.",Cause:"Dial invoked with invalid `localMedia` HTML media object.",Resolution:"Please invoke dial with a valid `localMedia` HTML media (audio / video) object."},{JSObject:"phone",JSMethod:"dial",ErrorCode:"2232",ErrorMessage:"Cannot complete operation dial as `remoteMedia` is invalid.",Cause:"Dial invoked with invalid `remoteMedia` HTML media object.",Resolution:"Please invoke dial with a valid `remoteMedia` HTML media (audio / video) object."},{JSObject:"phone",JSMethod:"dial",ErrorCode:"2241",ErrorMessage:"Cannot complete operation dial as there is no login session.",Cause:"Dial invoked without a login session.",Resolution:"Please invoke dial after a login session is established."},{JSObject:"phone",JSMethod:"dial",ErrorCode:"2251",ErrorMessage:"Cannot complete operation dial as there is an existing call trying to connect.",Cause:"Dial invoked while an existing call is trying to connect.",Resolution:"Please invoke dial after the existing call is connected."},{JSObject:"phone",JSMethod:"dial",ErrorCode:"2252",ErrorMessage:"Cannot complete operation dial as there is an existing active call.",Cause:"Dial invoked while there is an an existing active call.",Resolution:"Please use addCall to dial a second call instead."},{JSObject:"phone",JSMethod:"answer",ErrorCode:"2300",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"answer",ErrorCode:"2301",ErrorMessage:"Cannot complete operation answer without input parameters.",Cause:"Answer invoked with no parameters.",Resolution:"Please invoke answer with mandatory input parameters."},{JSObject:"phone",JSMethod:"answer",ErrorCode:"2311",ErrorMessage:"Cannot complete operation answer as `localMedia` is invalid.",Cause:"Answer invoked with invalid `localMedia` HTML media object.",Resolution:"Please invoke answer with a valid `localMedia` HTML media (audio / video) object."},{JSObject:"phone",JSMethod:"answer",ErrorCode:"2312",ErrorMessage:"Cannot complete operation answer as `remoteMedia` is invalid.",Cause:"Answer invoked with invalid `remoteMedia` HTML media object.",Resolution:"Please invoke answer with a valid `remoteMedia` HTML media (audio / video) object."},{JSObject:"phone",JSMethod:"answer",ErrorCode:"2321",ErrorMessage:"Cannot complete operation answer as there is no login session.",Cause:"Answer invoked without a login session.",Resolution:"Please invoke answer after a login session is established."},{JSObject:"phone",JSMethod:"answer",ErrorCode:"2331",ErrorMessage:"Cannot complete operation answer as there is no pending incoming call.",Cause:"Answer invoked without a pending incoming call.",Resolution:"Please invoke answer after there is a pending incoming call."},{JSObject:"phone",JSMethod:"answer",ErrorCode:"2341",ErrorMessage:"Cannot complete operation answer as `action` is invalid.",Cause:"Answer invoked with invalid `action` parameter.",Resolution:"Please invoke answer with a valid `action` parameter."},{JSObject:"phone",JSMethod:"hangup",ErrorCode:"2400",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"hangup",ErrorCode:"2401",ErrorMessage:"Cannot complete operation hangup as there is no login session.",Cause:"Hangup invoked without a login session.",Resolution:"Please invoke hangup after a login session is established."},{JSObject:"phone",JSMethod:"hangup",ErrorCode:"2402",ErrorMessage:"Cannot complete operation hangup as there is no active call.",Cause:"Hangup invoked without an active call.",Resolution:"Please invoke hangup after there is an active call."},{JSObject:"phone",JSMethod:"hold",ErrorCode:"2500",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"hold",ErrorCode:"2501",ErrorMessage:"Cannot complete operation hold as there is no login session.",Cause:"Hold invoked without a login session.",Resolution:"Please invoke hold after a login session is established."},{JSObject:"phone",JSMethod:"hold",ErrorCode:"2502",ErrorMessage:"Cannot complete operation hold as there is no active call.",Cause:"Hold invoked without an active call.",Resolution:"Please invoke hold after there is an active call."},{JSObject:"phone",JSMethod:"hold",ErrorCode:"2503",ErrorMessage:"Cannot complete operation hold as the active call is in an invalid state.",Cause:"Hold invoked with active call in an invalid state.",Resolution:"Please invoke hold when the active call is in a valid state."},{JSObject:"phone",JSMethod:"resume",ErrorCode:"2600",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"resume",ErrorCode:"2601",ErrorMessage:"Cannot complete operation resume as there is no login session.",Cause:"Resume invoked without a login session.",Resolution:"Please invoke resume after a login session is established."},{JSObject:"phone",JSMethod:"resume",ErrorCode:"2602",ErrorMessage:"Cannot complete operation resume as there is no active call.",Cause:"Resume invoked without an active call.",Resolution:"Please invoke resume after there is an active call."},{JSObject:"phone",JSMethod:"resume",ErrorCode:"2603",ErrorMessage:"Cannot complete operation resume as the active call is in an invalid state.",Cause:"Resume invoked with active call in an invalid state.",Resolution:"Please invoke resume when the active call is in a valid state."},{JSObject:"phone",JSMethod:"mute",ErrorCode:"2700",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"mute",ErrorCode:"2701",ErrorMessage:"Cannot complete operation mute as there is no login session.",Cause:"Mute invoked without a login session.",Resolution:"Please invoke mute after a login session is established."},{JSObject:"phone",JSMethod:"mute",ErrorCode:"2702",ErrorMessage:"Cannot complete operation mute as there is no active call.",Cause:"Mute invoked without an active call.",Resolution:"Please invoke mute after there is an active call."},{JSObject:"phone",JSMethod:"unmute",ErrorCode:"2800",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"unmute",ErrorCode:"2801",ErrorMessage:"Cannot complete operation unmute as there is no login session.",Cause:"Unmute invoked without a login session.",Resolution:"Please invoke mute after a login session is established."},{JSObject:"phone",JSMethod:"unmute",ErrorCode:"2802",ErrorMessage:"Cannot complete operation unmute as there is no active call.",Cause:"Unmute invoked without an active call.",Resolution:"Please invoke unmute after there is an active call."},{JSObject:"phone",JSMethod:"cancel",ErrorCode:"2900",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"cancel",ErrorCode:"2901",ErrorMessage:"Cannot complete operation cancel as there is no login session.",Cause:"Cancel invoked without a login session.",Resolution:"Please invoke cancel after a login session is established."},{JSObject:"phone",JSMethod:"cancel",ErrorCode:"2902",ErrorMessage:"Cannot complete operation cancel as there is no pending outgoing call.",Cause:"Cancel invoked without a pending outgoing call.",Resolution:"Please invoke cancel after there is a pending outgoing call."},{JSObject:"phone",JSMethod:"reject",ErrorCode:"3000",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"reject",ErrorCode:"3001",ErrorMessage:"Cannot complete operation reject as there is no login session.",Cause:"Reject invoked without a login session.",Resolution:"Please invoke reject after a login session is established."},{JSObject:"phone",JSMethod:"reject",ErrorCode:"3002",ErrorMessage:"Cannot complete operation reject as there is no pending incoming call.",Cause:"Reject invoked without a pending incoming call.",Resolution:"Please invoke reject after there is a pending incoming call."},{JSObject:"phone",JSMethod:"startConference",ErrorCode:"3100",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"startConference",ErrorCode:"3101",ErrorMessage:"Cannot complete operation start conference without input parameters.",Cause:"Start conference invoked with no parameters.",Resolution:"Please invoke start conference with mandatory input parameters."},{JSObject:"phone",JSMethod:"startConference",ErrorCode:"3111",ErrorMessage:"Cannot complete operation start conference as `mediaType` is invalid.",Cause:"Start conference invoked with invalid `mediaType`.",Resolution:"Please invoke start conference with a valid `mediaType` parameter (audio or video)."},{JSObject:"phone",JSMethod:"startConference",ErrorCode:"3121",ErrorMessage:"Cannot complete operation start conference as `localMedia` is invalid.",Cause:"Start conference invoked with invalid `localMedia` HTML media object.",Resolution:"Please invoke start conference with a valid `localMedia` HTML media (audio / video) object."},{JSObject:"phone",JSMethod:"startConference",ErrorCode:"3122",ErrorMessage:"Cannot complete operation start conference as `remoteMedia` is invalid.",Cause:"Start conference invoked with invalid `remoteMedia` HTML media object.",Resolution:"Please invoke start conference with a valid `remoteMedia` HTML media (audio / video) object."},{JSObject:"phone",JSMethod:"startConference",ErrorCode:"3131",ErrorMessage:"Cannot complete operation start conference as there is no login session.",Cause:"Start conference invoked without a login session.",Resolution:"Please invoke start conference after a login session is established."},{JSObject:"phone",JSMethod:"joinConference",ErrorCode:"3200",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"joinConference",ErrorCode:"3201",ErrorMessage:"Cannot complete operation join conference without input parameters.",Cause:"Join conference invoked with no parameters.",Resolution:"Please invoke join conference with mandatory input parameters."},{JSObject:"phone",JSMethod:"joinConference",ErrorCode:"3211",ErrorMessage:"Cannot complete operation join conference as `localMedia` is invalid.",Cause:"Join conference invoked with invalid `localMedia` HTML media object.",Resolution:"Please invoke join conference with a valid `localMedia` HTML media (audio / video) object."},{JSObject:"phone",JSMethod:"joinConference",ErrorCode:"3212",ErrorMessage:"Cannot complete operation join conference as `remoteMedia` is invalid.",Cause:"Join conference invoked with invalid `remoteMedia` HTML media object.",Resolution:"Please invoke join conference with a valid `remoteMedia` HTML media (audio / video) object."},{JSObject:"phone",JSMethod:"joinConference",ErrorCode:"3221",ErrorMessage:"Cannot complete operation join conference as there is no login session.",Cause:"Join conference invoked without a login session.",Resolution:"Please invoke join conference after a login session is established."},{JSObject:"phone",JSMethod:"joinConference",ErrorCode:"3231",ErrorMessage:"Cannot complete operation join conference as there is no pending conference invite.",Cause:"Join conference invoked without a pending conference invite.",Resolution:"Please invoke join conference after there is a pending conference invite."},{JSObject:"phone",JSMethod:"joinConference",ErrorCode:"3241",ErrorMessage:"Cannot complete operation join conference as `action` is invalid.",Cause:"Join conference invoked with invalid `action` parameter.",Resolution:"Please invoke join conference with a valid `action` parameter."},{JSObject:"phone",JSMethod:"rejectConference",ErrorCode:"3300",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"rejectConference",ErrorCode:"3301",ErrorMessage:"Cannot complete operation reject conference as there is no login session.",Cause:"Reject conference invoked without a login session.",Resolution:"Please invoke reject conference after a login session is established."},{JSObject:"phone",JSMethod:"rejectConference",ErrorCode:"3302",ErrorMessage:"Cannot complete operation reject conference as there is no pending incoming call.",Cause:"Reject conference invoked without a pending incoming call.",Resolution:"Please invoke reject conference after there is a pending incoming call."},{JSObject:"phone",JSMethod:"getParticipants",ErrorCode:"3400",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"getParticipants",ErrorCode:"3401",ErrorMessage:"Cannot complete operation get participants as there is no login session.",Cause:"Get participants invoked without a login session.",Resolution:"Please invoke get participants after a login session is established."},{JSObject:"phone",JSMethod:"getParticipants",ErrorCode:"3402",ErrorMessage:"Cannot complete operation get participants there is no active conference stated by you.",Cause:"Get participants invoked without an active conference started by you.",Resolution:"Please invoke get participants after there is an active conference started by you."},{JSObject:"phone",JSMethod:"endConference",ErrorCode:"3500",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"endConference",ErrorCode:"3501",ErrorMessage:"Cannot complete operation end conference as there is no login session.",Cause:"End conference invoked without a login session.",Resolution:"Please invoke end conference after a login session is established."},{JSObject:"phone",JSMethod:"endConference",ErrorCode:"3502",ErrorMessage:"Cannot complete operation end conference as there is no active conference.",Cause:"End conference invoked without an active conference.",Resolution:"Please invoke end conference after there is an active conference."},{JSObject:"phone",JSMethod:"addParticipant",ErrorCode:"3600",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"addParticipant",ErrorCode:"3611",ErrorMessage:"Cannot complete operation add participant without valid `participant`.",Cause:"Add participant invoked with invalid or missing `participant`.",Resolution:"Please invoke add participant with a valid `participant` parameter."},{JSObject:"phone",JSMethod:"addParticipant",ErrorCode:"3612",ErrorMessage:"Cannot complete operation add participant as `participant` is a SIP or TEL URI.",Cause:"Add participant invoked with `participant` that is a SIP or TEL URI.",Resolution:"Please invoke add participant with a `participant` that is not a SIP or TEL URI."},{JSObject:"phone",JSMethod:"addParticipant",ErrorCode:"3613",ErrorMessage:"Cannot complete operation add participant as `participant` is an invalid address.",Cause:"Add participant invoked with `participant` that is an invalid address string.",Resolution:"Please invoke add participant with a `participant` that is a valid address string."},{JSObject:"phone",JSMethod:"addParticipant",ErrorCode:"3621",ErrorMessage:"Cannot complete operation add participant as there is no login session.",Cause:"Add participant invoked without a login session.",Resolution:"Please invoke add participant after a login session is established."},{JSObject:"phone",JSMethod:"addParticipant",ErrorCode:"3631",ErrorMessage:"Cannot complete operation add participant as there is no active conference started by you.",Cause:"Add participant invoked without an active conference started by you.",Resolution:"Please invoke add participant after there is an active conference started by you."},{JSObject:"phone",JSMethod:"addParticipant",ErrorCode:"3641",ErrorMessage:"Cannot complete operation add participant with the specified participant.",Cause:"Add participant invoked with a participant that has already been added to the conference.",Resolution:"Please invoke add participant with a new participant."},{JSObject:"phone",JSMethod:"removeParticipant",ErrorCode:"3700",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"removeParticipant",ErrorCode:"3711",ErrorMessage:"Cannot complete operation remove participant without valid `participant`.",Cause:"Remove participant invoked with invalid or missing `participant`.",Resolution:"Please invoke remove participant with a valid `participant` parameter."},{JSObject:"phone",JSMethod:"removeParticipant",ErrorCode:"3721",ErrorMessage:"Cannot complete operation remove participant as there is no login session.",Cause:"Remove participant invoked without a login session.",Resolution:"Please invoke remove participant after a login session is established."},{JSObject:"phone",JSMethod:"removeParticipant",ErrorCode:"3731",ErrorMessage:"Cannot complete operation remove participant as there is no active conference started by you.",Cause:"Remove participant invoked without an active conference started by you.",Resolution:"Please invoke remove participant after there is an active conference started by you."},{JSObject:"phone",JSMethod:"cleanPhoneNumber",ErrorCode:"3810",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"formatNumber",ErrorCode:"3820",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"getCallerInfo",ErrorCode:"3830",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"addCall",ErrorCode:"3900",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"addCall",ErrorCode:"3901",ErrorMessage:"Cannot complete operation add call without input parameters.",Cause:"Add call invoked with no parameters.",Resolution:"Please invoke add call with mandatory input parameters."},{JSObject:"phone",JSMethod:"addCall",ErrorCode:"3911",ErrorMessage:"Cannot complete operation add call without valid `destination`.",Cause:"Add call invoked with invalid or missing `destination`.",Resolution:"Please invoke add call with a valid `destination` parameter."},{JSObject:"phone",JSMethod:"addCall",ErrorCode:"3912",ErrorMessage:"Cannot complete operation add call as `destination` is a SIP or TEL URI.",Cause:"Add call invoked with `destination` that is a SIP or TEL URI.",Resolution:"Please invoke add call with a `destination` that is not a SIP or TEL URI."},{JSObject:"phone",JSMethod:"addCall",ErrorCode:"3913",ErrorMessage:"Cannot complete operation add call as `destination` is an invalid address.",Cause:"Add call invoked with `destination` that is an invalid address string.",Resolution:"Please invoke add call with a `destination` that is a valid address string."},{JSObject:"phone",JSMethod:"addCall",ErrorCode:"3921",ErrorMessage:"Cannot complete operation add call as `mediaType` is invalid.",Cause:"Add call invoked with invalid `mediaType`.",Resolution:"Please invoke add call with a valid `mediaType` parameter (audio or video)."},{JSObject:"phone",JSMethod:"addCall",ErrorCode:"3931",ErrorMessage:"Cannot complete operation add call as `localMedia` is invalid.",Cause:"Add call invoked with invalid `localMedia` HTML media object.",Resolution:"Please invoke add call with a valid `localMedia` HTML media (audio / video) object."},{JSObject:"phone",JSMethod:"addCall",ErrorCode:"3932",ErrorMessage:"Cannot complete operation add call as `remoteMedia` is invalid.",Cause:"Add call invoked with invalid `remoteMedia` HTML media object.",Resolution:"Please invoke add call with a valid `remoteMedia` HTML media (audio / video) object."},{JSObject:"phone",JSMethod:"addCall",ErrorCode:"3941",ErrorMessage:"Cannot complete operation add call as there is no login session.",Cause:"Add call invoked without a login session.",Resolution:"Please invoke add call after a login session is established."},{JSObject:"phone",JSMethod:"addCall",ErrorCode:"3951",ErrorMessage:"Cannot complete operation add call as there is an existing call trying to connect.",Cause:"Add call invoked while an existing call is trying to connect.",Resolution:"Please invoke add call after the existing call is connected."},{JSObject:"phone",JSMethod:"addCall",ErrorCode:"3961",ErrorMessage:"Cannot complete operation add call to dial a third call.",Cause:"Add call invoked while there are two existing active calls.",Resolution:"Please invoke add call after disconnecting one of the existing active calls."},{JSObject:"phone",JSMethod:"move",ErrorCode:"4000",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"move",ErrorCode:"4001",ErrorMessage:"Cannot complete operation move as there is no login session.",Cause:"Move invoked without a login session.",Resolution:"Please invoke move after a login session is established."},{JSObject:"phone",JSMethod:"move",ErrorCode:"4002",ErrorMessage:"Cannot complete operation move as there is no active call.",Cause:"Move invoked without an active call.",Resolution:"Please invoke move after there is an active call."},{JSObject:"phone",JSMethod:"move",ErrorCode:"4003",ErrorMessage:"Cannot complete operation move as the active call is in an invalid state.",Cause:"Move invoked with active call in an invalid state.",Resolution:"Please invoke move when the active call is in a valid state."},{JSObject:"phone",JSMethod:"move",ErrorCode:"4004",ErrorMessage:"Cannot complete operation move as the active call is a conference.",Cause:"Move invoked on an active conference.",Resolution:"Move for a conference is not supported."},{JSObject:"phone",JSMethod:"transfer",ErrorCode:"4100",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"transfer",ErrorCode:"4101",ErrorMessage:"Cannot complete operation transfer as there is no login session.",Cause:"Transfer invoked without a login session.",Resolution:"Please invoke transfer after a login session is established."},{JSObject:"phone",JSMethod:"transfer",ErrorCode:"4102",ErrorMessage:"Cannot complete operation transfer as there is no active call.",Cause:"Transfer invoked without an active call.",Resolution:"Please invoke transfer after there is an active call."},{JSObject:"phone",JSMethod:"transfer",ErrorCode:"4103",ErrorMessage:"Cannot complete operation transfer as the active call is in an invalid state.",Cause:"Transfer invoked with active call in an invalid state.",Resolution:"Please invoke transfer when the active call is in a valid state."},{JSObject:"phone",JSMethod:"transfer",ErrorCode:"4104",ErrorMessage:"Cannot complete operation transfer as one of the active calls is a conference.",Cause:"Transfer invoked when one of the active calls is a conference.",Resolution:"Transfer for a conference is not supported."},{JSObject:"phone",JSMethod:"transfer",ErrorCode:"4105",ErrorMessage:"Cannot complete operation transfer as there is only one call.",Cause:"Transfer invoked when there is only one call.",Resolution:"Please invoke transfer after there are two active calls."},{JSObject:"phone",JSMethod:"switch",ErrorCode:"4200",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"switch",ErrorCode:"4201",ErrorMessage:"Cannot complete operation switch as there is no login session.",Cause:"Switch invoked without a login session.",Resolution:"Please invoke switch after a login session is established."},{JSObject:"phone",JSMethod:"switch",ErrorCode:"4202",ErrorMessage:"Cannot complete operation switch as there is no active call.",Cause:"Switch invoked without an active call.",Resolution:"Please invoke switch after there is an active call."},{JSObject:"phone",JSMethod:"switch",ErrorCode:"4203",ErrorMessage:"Cannot complete operation switch as there is only one call.",Cause:"Switch invoked when there is only one call.",Resolution:"Please invoke switch after there are two active calls."},{JSObject:"phone",JSMethod:"acceptModification",ErrorCode:"4300",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"acceptModification",ErrorCode:"4301",ErrorMessage:"Cannot complete operation accept modification as there is no login session.",Cause:"Accept modification invoked without a login session.",Resolution:"Please invoke accept modification after a login session is established."},{JSObject:"phone",JSMethod:"acceptModification",ErrorCode:"4302",ErrorMessage:"Cannot complete operation accept modification as there is no active call.",Cause:"Accept modification invoked without an active call.",Resolution:"Please invoke accept modification after there is an active call."},{JSObject:"phone",JSMethod:"acceptModification",ErrorCode:"4303",ErrorMessage:"Cannot complete operation accept modification as the active call is in an invalid state.",Cause:"Accept modification invoked with active call in an invalid state.",Resolution:"Please invoke accept modification when the active call is in a valid state."},{JSObject:"phone",JSMethod:"acceptModification",ErrorCode:"4304",ErrorMessage:"Cannot complete operation accept modification as there is no modification to accept.",Cause:"Accept modification invoked with with no modification to accept.",
Resolution:"Please invoke accept modification when there is a modification request."},{JSObject:"phone",JSMethod:"rejectModification",ErrorCode:"4400",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"rejectModification",ErrorCode:"4401",ErrorMessage:"Cannot complete operation reject modification as there is no login session.",Cause:"Reject modification invoked without a login session.",Resolution:"Please invoke reject modification after a login session is established."},{JSObject:"phone",JSMethod:"rejectModification",ErrorCode:"4402",ErrorMessage:"Cannot complete operation reject modification as there is no active call.",Cause:"Reject modification invoked without an active call.",Resolution:"Please invoke reject modification after there is an active call."},{JSObject:"phone",JSMethod:"rejectModification",ErrorCode:"4403",ErrorMessage:"Cannot complete operation reject modification as the active call is in an invalid state.",Cause:"Reject modification invoked with active call in an invalid state.",Resolution:"Please invoke reject modification when the active call is in a valid state."},{JSObject:"phone",JSMethod:"rejectModification",ErrorCode:"4404",ErrorMessage:"Cannot complete operation reject modification as there is no modification to accept.",Cause:"Reject modification invoked with with no modification to accept.",Resolution:"Please invoke reject modification when there is a modification request."},{JSObject:"phone",JSMethod:"downgrade",ErrorCode:"4500",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"downgrade",ErrorCode:"4501",ErrorMessage:"Cannot complete operation downgrade as there is no login session.",Cause:"Downgrade invoked without a login session.",Resolution:"Please invoke downgrade after a login session is established."},{JSObject:"phone",JSMethod:"downgrade",ErrorCode:"4502",ErrorMessage:"Cannot complete operation downgrade as there is no active call.",Cause:"Downgrade invoked without an active call.",Resolution:"Please invoke downgrade after there is an active call."},{JSObject:"phone",JSMethod:"downgrade",ErrorCode:"4503",ErrorMessage:"Cannot complete operation downgrade as the active call is in an invalid state.",Cause:"Downgrade invoked with active call in an invalid state.",Resolution:"Please invoke downgrade when the active call is in a valid state."},{JSObject:"phone",JSMethod:"downgrade",ErrorCode:"4504",ErrorMessage:"Cannot complete operation downgrade as the active call is an audio call.",Cause:"Downgrade invoked on an active audio call.",Resolution:"Downgrade for audio call is not supported."},{JSObject:"phone",JSMethod:"downgrade",ErrorCode:"4505",ErrorMessage:"Cannot complete operation downgrade as the active call is a conference.",Cause:"Downgrade invoked on an active conference.",Resolution:"Downgrade for a conference is not supported."},{JSObject:"phone",JSMethod:"upgrade",ErrorCode:"4600",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"upgrade",ErrorCode:"4601",ErrorMessage:"Cannot complete operation upgrade as there is no login session.",Cause:"Upgrade invoked without a login session.",Resolution:"Please invoke upgrade after a login session is established."},{JSObject:"phone",JSMethod:"upgrade",ErrorCode:"4602",ErrorMessage:"Cannot complete operation upgrade as there is no active call.",Cause:"Upgrade invoked without an active call.",Resolution:"Please invoke upgrade after there is an active call."},{JSObject:"phone",JSMethod:"upgrade",ErrorCode:"4603",ErrorMessage:"Cannot complete operation upgrade as the active call is in an invalid state.",Cause:"Upgrade invoked with active call in an invalid state.",Resolution:"Please invoke upgrade when the active call is in a valid state."},{JSObject:"phone",JSMethod:"upgrade",ErrorCode:"4604",ErrorMessage:"Cannot complete operation upgrade as the active call is an video call.",Cause:"Upgrade invoked on an active video call.",Resolution:"Upgrade for video call is not supported."},{JSObject:"phone",JSMethod:"upgrade",ErrorCode:"4605",ErrorMessage:"Cannot complete operation upgrade as the active call is a conference.",Cause:"Upgrade invoked on an active conference.",Resolution:"Upgrade for a conference is not supported."},{JSObject:"phone",JSMethod:"sendDTMFTone",ErrorCode:"4700",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"sendDTMFTone",ErrorCode:"4711",ErrorMessage:"Cannot complete operation send DTMF tone without input parameters.",Cause:"Send DTMF tone invoked with no parameters.",Resolution:"Please invoke send DTMF tone with mandatory input parameters."},{JSObject:"phone",JSMethod:"sendDTMFTone",ErrorCode:"4712",ErrorMessage:"Cannot complete operation send DTMF tone without valid `input`.",Cause:"Send DTMF tone invoked with invalid or missing `input`.",Resolution:"Please invoke send DTMF tone with a valid `input` parameter."},{JSObject:"phone",JSMethod:"sendDTMFTone",ErrorCode:"4721",ErrorMessage:"Cannot complete operation send DTMF tone as there is no login session.",Cause:"Send DTMF tone invoked without a login session.",Resolution:"Please invoke send DTMF tone  after a login session is established."},{JSObject:"phone",JSMethod:"sendDTMFTone",ErrorCode:"4731",ErrorMessage:"Cannot complete operation send DTMF tone as there is no active call.",Cause:"Send DTMF tone invoked without an active call.",Resolution:"Please invoke send DTMF tone  after there is an active call."},{JSObject:"phone",JSMethod:"sendDTMFTone",ErrorCode:"4741",ErrorMessage:"Cannot complete operation send DTMF tone as the active call is in an invalid state.",Cause:"Send DTMF tone invoked with active call in an invalid state.",Resolution:"Please invoke send DTMF tone  when the active call is in a valid state."},{JSObject:"phone",JSMethod:"setIceServers",ErrorCode:"4811",ErrorMessage:"Cannot complete operation set ICE servers.",Cause:"Set ICE servers invoked with an invalid ICE server URIs array.",Resolution:"Please invoke set ICE servers with a valid ICE server URIs array."},{JSObject:"phone",JSMethod:"setIceTransport",ErrorCode:"4821",ErrorMessage:"Cannot complete operation set ICE transport.",Cause:"Set ICE transport invoked with an invalid ICE transport.",Resolution:"Please invoke set ICE transport with a valid ICE transport (all, none or relay)."},{JSObject:"phone",JSMethod:"setIpv6",ErrorCode:"4831",ErrorMessage:"Cannot complete operation set IPv6.",Cause:"Set IPv6 invoked with an invalid value.",Resolution:"Please invoke set IPv6 with a valid value (true or false)."},{JSObject:"phone",JSMethod:"on",ErrorCode:"4901",ErrorMessage:"Cannot complete operation.",Cause:"`Phone.on` invoked with invalid parameters.",Resolution:"Please pass valid event name and handler function as parameters."},{JSObject:"phone",JSMethod:"on",ErrorCode:"4902",ErrorMessage:"Cannot complete operation.",Cause:"The event name provided is not registered.",Resolution:"Please register the event and try again."},{JSObject:"phone",JSMethod:"getUserMedia",ErrorCode:"5000",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"getUserMedia",ErrorCode:"5001",ErrorMessage:"Cannot complete operation get user media without input parameters.",Cause:"Get user media invoked with no parameters.",Resolution:"Please invoke get user media with mandatory input parameters."},{JSObject:"phone",JSMethod:"getUserMedia",ErrorCode:"5011",ErrorMessage:"Cannot complete operation get user media without `mediaType`.",Cause:"Get user media invoked without `mediaType`.",Resolution:"Please invoke get user media with mandatory parameter `mediaType`."},{JSObject:"phone",JSMethod:"getUserMedia",ErrorCode:"5012",ErrorMessage:"Cannot complete operation get user media as `mediaType` is invalid.",Cause:"Get user media invoked with invalid `mediaType`.",Resolution:"Please invoke get user media with a valid `mediaType` parameter (audio or video)."},{JSObject:"phone",JSMethod:"setup",ErrorCode:"5100",ErrorMessage:"Internal error occurred.",Cause:"There was a problem during the operation.",Resolution:"Please check the logs and additional information and contact support if needed."},{JSObject:"phone",JSMethod:"setup",ErrorCode:"5101",ErrorMessage:"Cannot complete operation setup without input parameters.",Cause:"Setup invoked with no parameters.",Resolution:"Please invoke setup with mandatory input parameters."},{JSObject:"phone",JSMethod:"setup",ErrorCode:"5111",ErrorMessage:"Cannot complete operation setup as `localMedia` is invalid.",Cause:"Setup invoked with invalid `localMedia` HTML media object.",Resolution:"Please invoke setup with a valid `localMedia` HTML media (audio / video) object."},{JSObject:"phone",JSMethod:"setup",ErrorCode:"5112",ErrorMessage:"Cannot complete operation setup as `remoteMedia` is invalid.",Cause:"Setup invoked with invalid `remoteMedia` HTML media object.",Resolution:"Please invoke setup with a valid `remoteMedia` HTML media (audio / video) object."}],void 0===ATT["private"]||void 0===ATT["private"].errorStore)throw new Error("Cannot export ATT.private.errorStore.SDKErrors");a.forEach(function(a){b[a.ErrorCode]=a}),ATT["private"].errorStore.SDKErrors=Object.freeze(b)}(),function(){"use strict";var a,b={};if(a=[{JSObject:"phone",JSMethod:"*",ErrorCode:"1000",ErrorMessage:"There was a problem completing the request.",Cause:"System error occurred.",Resolution:"Please check the logs and additional information and contact support if needed.",MessageId:""},{JSObject:"phone",JSMethod:"*",ErrorCode:"1001",ErrorMessage:"A service error has occurred.",Cause:"There was a problem with the request.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:400,MessageId:"SVC0001"},{JSObject:"phone",JSMethod:"*",ErrorCode:"1002",ErrorMessage:"A service error has occurred due to one or more of the the request parameters.",Cause:"There was a problem with one or more of the request parameter values.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:400,MessageId:"SVC0002"},{JSObject:"phone",JSMethod:"*",ErrorCode:"1003",ErrorMessage:"A service error has occurred due to one or more of the the request parameters.",Cause:"There was an unexpected value provided for one or more of the request parameters.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:400,MessageId:"SVC0003"},{JSObject:"phone",JSMethod:"*",ErrorCode:"1004",ErrorMessage:"A service error has occurred due to invalid addresses.",Cause:"The addresses provided with the request were invalid.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:400,MessageId:"SVC0004"},{JSObject:"phone",JSMethod:"createE911Id",ErrorCode:"1015",ErrorMessage:"Failed to complete the request.",Cause:"The address provided in the request is not a valid E911 address.",Resolution:"Please provide a valid E911 address.",HttpStatusCode:400,MessageId:"SVC0015"},{JSObject:"phone",JSMethod:"createE911Id",ErrorCode:"1016",ErrorMessage:"Failed to complete the request.",Cause:"The address provided in the request could not be confirmed.",Resolution:"Please confirm the address and retry.",HttpStatusCode:400,MessageId:"SVC0016"},{JSObject:"phone",JSMethod:"createE911Id",ErrorCode:"1017",ErrorMessage:"Failed to complete the request.",Cause:"The E911 provider system (NENA) is currently not available.",Resolution:"Please try again later.",HttpStatusCode:400,MessageId:"SVC0017"},{JSObject:"phone",JSMethod:"createE911Id",ErrorCode:"1018",ErrorMessage:"Failed to complete the request.",Cause:"There was an error in the E911 provider system (NENA).",Resolution:"Please contact system administrator or try again later.",HttpStatusCode:400,MessageId:"SVC0018"},{JSObject:"phone",JSMethod:"*",ErrorCode:"1019",ErrorMessage:"Failed to complete the request.",Cause:"The E911 ID provided with the request is not valid.",Resolution:"Please provide a valid E911 id.",HttpStatusCode:400,MessageId:"SVC0019"},{JSObject:"phone",JSMethod:"*",ErrorCode:"1021",ErrorMessage:"Failed to complete the request.",Cause:"The session ID provided with the request is not valid.",Resolution:"Please provide a valid session id.",HttpStatusCode:400,MessageId:"SVC0020"},{JSObject:"phone",JSMethod:"*",ErrorCode:"1401",ErrorMessage:"Failed to complete the request.",Cause:"A media modification is in progress for this call.",Resolution:"Please allow the current media modification to complete before initiating another media modification request.",HttpStatusCode:409,MessageId:"SVC8501"},{JSObject:"phone",JSMethod:"login",ErrorCode:"1501",ErrorMessage:"Failed to create a login session.",Cause:"E911 ID cannot be passed as a parameter for this request.",Resolution:"Please invoke login without E911 ID for this request.",HttpStatusCode:400,MessageId:"SVC8510"},{JSObject:"phone",JSMethod:"login",ErrorCode:"1511",ErrorMessage:"Failed to create a login session.",Cause:"E911 ID must be passed as a parameter for this request.",Resolution:"Please invoke login with E911 ID for this request.",HttpStatusCode:400,MessageId:"SVC8511"},{JSObject:"phone",JSMethod:"login",ErrorCode:"1521",ErrorMessage:"Failed to create a login session.",Cause:"The access token provided is not associated with the user.",Resolution:"Please associate the access token with the user and try again.",HttpStatusCode:400,MessageId:"SVC8512"},{JSObject:"phone",JSMethod:"login",ErrorCode:"1531",ErrorMessage:"Failed to create a login session.",Cause:"The access token provided is in use with another login session.",Resolution:"Please expire any other login session associated with the access token or use a different access token and try again.",HttpStatusCode:400,MessageId:"SVC8514"},{JSObject:"phone",JSMethod:"associateToken",ErrorCode:"1541",ErrorMessage:"Failed to associate access token to user ID.",Cause:"The user ID provided with the request is not valid.",Resolution:"Please provide a valid user ID and try again.",HttpStatusCode:404,MessageId:"SVC8514"},{JSObject:"phone",JSMethod:"*",ErrorCode:"1711",ErrorMessage:"A policy error occurred.",Cause:"The information provided in the request failed to verify against known sources.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:401,MessageId:"POL0001"},{JSObject:"phone",JSMethod:"*",ErrorCode:"1713",ErrorMessage:"A policy error occurred.",Cause:"The information provided in the request failed to verify against known sources.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:403,MessageId:"POL0001"},{JSObject:"phone",JSMethod:"*",ErrorCode:"1702",ErrorMessage:"Policy error occurred. Request was refused.",Cause:"Privacy verification failed for an address.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:403,MessageId:"POL0002"},{JSObject:"phone",JSMethod:"*",ErrorCode:"1703",ErrorMessage:"Policy error occurred.",Cause:"Too many addresses provided in the request.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:403,MessageId:"POL0003"},{JSObject:"phone",JSMethod:"*",ErrorCode:"1809",ErrorMessage:"Policy error occurred.",Cause:"User has not been provisioned for this service.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:403,MessageId:"POL1009"},{JSObject:"phone",JSMethod:"login",ErrorCode:"1901",ErrorMessage:"There was an error completing the login request.",Cause:"Number of login sessions exceeded the allowed limit.",Resolution:"For virtual number and account ID users, please contact the Administrator.",HttpStatusCode:403,MessageId:"POL1100"},{JSObject:"phone",JSMethod:"*",ErrorCode:"1921",ErrorMessage:"There was an error completing the request.",Cause:"Access token provided could not be mapped to the current session.",Resolution:"Please use the same access token that was used to create the login session.",HttpStatusCode:403,MessageId:"POL1102"},{JSObject:"phone",JSMethod:"*",ErrorCode:"404",ErrorMessage:"The server has not found anything matching the Request-URI.",Cause:"Not Found.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:404,MessageId:""},{JSObject:"phone",JSMethod:"*",ErrorCode:"500",ErrorMessage:"The server encountered an unexpected condition which prevented it from fulfilling the request.",Cause:"Internal Server Error.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:500,MessageId:""},{JSObject:"phone",JSMethod:"*",ErrorCode:"501",ErrorMessage:"The server does not support the functionality required to fulfill the request.",Cause:"Not Implemented.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:501,MessageId:""},{JSObject:"phone",JSMethod:"*",ErrorCode:"502",ErrorMessage:"The server, while acting as a gateway or proxy, received an invalid response from the upstream server it accessed in attempting to fulfill the request.",Cause:"Bad Gateway.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:502,MessageId:""},{JSObject:"phone",JSMethod:"*",ErrorCode:"503",ErrorMessage:"The server is currently unable to handle the request due to a temporary overloading or maintenance of the server.",Cause:"Service Unavailable.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:503,MessageId:""},{JSObject:"phone",JSMethod:"*",ErrorCode:"504",ErrorMessage:"The server, while acting as a gateway or proxy, did not receive a timely response from the upstream server specified by the URI (e.g. HTTP, FTP, LDAP) or some other auxiliary server (e.g. DNS) it needed to access in attempting to complete the request.",Cause:"Gateway Timeout.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:504,MessageId:""},{JSObject:"phone",JSMethod:"*",ErrorCode:"505",ErrorMessage:"The server does not support, or refuses to support, the HTTP protocol version that was used in the request message.",Cause:"HTTP Version Not Supported.",Resolution:"Please check the logs and additional information and contact support if needed.",HttpStatusCode:505,MessageId:""}],void 0===ATT["private"]||void 0===ATT["private"].errorStore)throw new Error("Cannot export ATT.private.errorStore.APIErrors");a.forEach(function(a){b[a.ErrorCode]=a}),ATT["private"].errorStore.APIErrors=Object.freeze(b)}(),function(){"use strict";function a(a){function b(a){return a.formatError=function(){var b=a.JSObject+"-"+a.JSMethod+"-"+a.ErrorCode+"-"+a.ErrorMessage+"-"+a.Cause+"-"+a.Resolution+"-"+a.APIError+"-"+a.ResourceMethod+"-"+a.HttpStatusCode+"-"+a.MessageId;return b},a}function d(a){return a.getId=function(){return a.ErrorCode},a}function e(a){return a.uniqueAPIErrorId=function(){return a.HttpStatusCode+a.MessageId},a}var f,g={JSObject:"",JSMethod:"",ErrorCode:"",ErrorMessage:"",Cause:"",Resolution:"",APIError:"",ResourceMethod:"",HttpStatusCode:"",MessageId:""};return f=Object.create(g),f=c.extend(f,a),f=b(f),f=d(f),f=e(f)}function b(b,c){var d={},e={};return Object.keys(b).forEach(function(c){var e=a(b[c]);d[e.getId()]=e}),Object.keys(c).forEach(function(b){var d=a(c[b]);e[d.getId()]=d}),{getError:function(a){return e[a]||d[a]},getSDKError:function(a){return d[a]},getAPIError:function(a,b){var c=null;return void 0===b&&(b=""),Object.keys(e).forEach(function(d){a+b===e[d].uniqueAPIErrorId()&&(c=e[d])}),c},createError:function(b){return a(b)}}}var c=ATT.utils;ATT["private"].createErrorDictionary=b}(),function(){"use strict";function a(a){b.logDebug("ATT.private.error: parseAPIErrorResponse"),b.logInfo("Parses the error response and checks for Type"),b.logTrace(a);var c,d;return c=""!==a.getJson()?a.getJson():a.responseText,c=c.RequestError,c&&(c=c.Exception||c.ServiceException||c.PolicyException||void 0,c&&(a.getResponseStatus()>=500?(d=ATT.errorDictionary.getAPIError(a.getResponseStatus()),null!==d&&(d.APIError=c.Text+", Variables="+c.Variables,b.logError(a.getResponseStatus()+": Internal server error: "+d.APIError))):(d=ATT.errorDictionary.getAPIError(a.getResponseStatus(),c.MessageId),null!==d&&(d.APIError=c.Text+", Variables="+c.Variables,b.logError(a.getResponseStatus()+": Internal error occurred: "+d.APIError))))),void 0===d&&(d=ATT.errorDictionary.getError("1000"),d.HttpStatusCode=a.getResponseStatus(),d.APIError=c,b.logError(a.getResponseStatus()+": Unknown error occurred."+d.APIError)),d.ResourceMethod=a.getResourceURL(),b.logTrace("error",d),d}var b=ATT.logManager.createLogger("privateError");if(b.logDebug("Initializing error module"),void 0===ATT["private"])throw new Error("Error exporting ATT.private.error");ATT["private"].error={parseAPIErrorResponse:a}}(),function(){"use strict";function a(){if(f.logDebug("ATT.rtc: hasWebRTC"),f.logInfo("Checking if Enhanced WebRTC is supported"),"function"==typeof navigator.mozGetUserMedia||"function"==typeof navigator.webkitGetUserMedia||"function"==typeof navigator.getUserMedia){var a,b,c=e.app.getBrowserSupport(),d=g.getBrowserName(),h=g.getBrowserVersion(),i=!1,j=!1;if(f.logInfo("Browser: "+d),f.logInfo("Version: "+h),0<c.supported.length&&0<c.not_certified.length){if(0<=c.supported.length)for(b=0;b<c.supported.length;b+=1)a=c.supported[b],d===a.name&&(i=!0,void 0!==a.version&&(void 0!==a.version.min&&a.version.min>Number.parseInt(h)&&(i=!1),void 0!==a.version.max&&a.version.max<Number.parseInt(h)&&(i=!1)));if(i)return f.logInfo("Browser supported"),"Supported";if(0<=c.not_certified.length)for(b=0;b<c.not_certified.length;b+=1)a=c.not_certified[b],d===a.name&&(j=!0,void 0!==a.version&&(void 0!==a.version.min&&a.version.min>Number.parseInt(h)&&(j=!1),void 0!==a.version.max&&a.version.max<Number.parseInt(h)&&(j=!1)));if(j)return f.logWarning("Browser not certified"),"Not Certified"}}return f.logError("Browser not supported"),"Not Supported"}function b(){return"undefined"!==navigator?window.isNavigatorOnline()?!0:!1:void 0}function c(){return window.navigator.onLine}function d(){return e.app.getBrowserSupport()}var e=ATT["private"].config,f=ATT.logManager.createLogger("browser"),g=ATT.utils;if(f.logDebug("Loading att.browser..."),window.isNavigatorOnline=c,void 0===ATT.browser)throw new Error("Error exporting ATT.browser methods");ATT.browser.hasWebRTC=a,ATT.browser.isNetworkConnected=b,ATT.browser.getBrowserSupport=d}(),function(){"use strict";function a(a){function f(a,b){e.logDebug("ATT.private.resourceManager: createRESTConfiguration"),e.logInfo("Creating REST configuration..."),e.logTrace("operationConfig",a),e.logTrace("options",b);var d,f,g,h,i,j,k,l;if(d=c.extend({},a),f=a.formatters||{},g=Object.keys(f).length,f&&g>0){if(void 0===b.params||g!==Object.keys(b.params).length)throw e.logError("Params passed in must match number of formatters"),e.logTrace("formatters",f),e.logTrace("params",b.params),new Error("Params passed in must match number of formatters.");if(f.method&&!b.params.method)throw e.logError("Missing method parameter for the method formatter."),new Error("Missing method parameter for the method formatter.");if(f.url&&!b.params.url)throw e.logError("Missing URL parameter for the URL formatter."),new Error("Missing URL parameter for the URL formatter.");if(f.headers&&Object.keys(b.params.headers).length!==Object.keys(a.formatters.headers).length)throw e.logError("Header formatters in APIConfigs do not match header parameters provided."),new Error("Header formatters in APIConfigs do not match the header parameters being passed in.");if("string"==typeof f.method&&(d.method=b.params.method||a.formatters.method,e.logInfo("updated restConfig method"),e.logTrace("restConfig.method",d.method)),"function"==typeof f.url&&(d.url=a.formatters.url(b.params.url),e.logInfo("updated restConfig url"),e.logTrace("restConfig.url",d.url)),"object"==typeof f.headers&&Object.keys(f.headers).length>0){l={},e.logInfo("Configuring request headers...");for(h in b.params.headers)if(b.params.headers.hasOwnProperty(h)){if("options"===h&&"object"==typeof a.formatters.headers[h]){if(0===Object.keys(b.params.headers[h]).length)throw e.logError("Options for header not passed in. Cannot construct request"),new Error("Options for header not passed in. Cannot construct request");k=Object.keys(b.params.headers[h])[0],i=a.formatters.headers[h][k],j=b.params.headers[h][k],h=k}else i=a.formatters.headers[h],j=b.params.headers[h];l[h]=i(j),e.logTrace(h,l[h])}d.headers=ATT.utils.extend({},d.headers),d.headers=ATT.utils.extend(d.headers,l),e.logTrace("restConfig.headers",d.headers)}}return b.data&&(d.data=b.data),e.logTrace("restConfig",d),d}function g(a){function c(c,f,g){e.logDebug("restOperation");var h;b=ATT.errorDictionary,a.success=c,a.error=function(a){var c;0===a.getResponseStatus()&&""===a.responseText?(c=b.getSDKError("0002"),c.HttpStatusCode=a.getResponseStatus(),c.ResourceMethod=a.getResourceURL(),f.call(this,c)):(c=d.parseAPIErrorResponse(a),f.call(this,c))},a.ontimeout=function(){var c=b.getSDKError("0002");c.HttpStatusCode=0,c.ResourceMethod=a.url,g?g.call(this,c):f.call(this,c)},h=new ATT.RESTClient(a),h.ajax()}return e.logDebug("ATT.private.resourceManager: createRESTOperation"),e.logInfo("Creating REST Operation..."),e.logTrace("restConfig",a),c}function h(a,b){e.logDebug("ATT.private.resourceManager: getOperation"),e.logTrace("operationName",a),e.logTrace("operationOpts",b);var c,d,h,i;if(i=k.getAPIConfiguration(),c=i[a],void 0===c)throw new Error("Operation not found.");if(void 0===b)throw new Error("No options found.");return d=f(c,b),h=g(d)}function i(a,b){if(e.logDebug("ATT.private.resourceManager: doOperation"),e.logTrace("operationName",a),e.logTrace("operationConfig",b),void 0===a||0===a.length)throw e.logError("no operation name provided"),new Error("Must specify an operation name.");if(void 0===b||0===Object.keys(b).length)throw new Error("No options found.");if(void 0===b.success)throw new Error("No `success` callback passed.");if("function"!=typeof b.success)throw new Error("`success` callback has to be a function.");if(void 0===b.error)throw new Error("No `error` callback passed.");if("function"!=typeof b.error)throw new Error("`error` callback has to be a function.");try{var c=h(a,b);e.logInfo("About to perform operation "+a),c(b.success,b.error,b.ontimeout)}catch(d){throw e.logError("Error performing operation: "+a),e.logTrace(d),d}}function j(){return e.logDebug("ATT.private.resourceManager: getRestOperationsConfig"),k.getAPIConfiguration()}e.logDebug("ATT.private.factories: createResourceManager"),e.logInfo("Creating resource manager..."),e.logTrace("apiConfig",a);var k;if(void 0===a||0===Object.keys(a).length)throw new Error("No API configuration passed");if(void 0===a.getAPIConfiguration)throw new Error("No `getAPIConfiguration` method found.");return k=a,{doOperation:i,getRestOperationsConfig:j}}var b,c=ATT.utils,d=ATT["private"].error,e=ATT.logManager.createLogger("resourceManager");if(e.logDebug("Loading att.private.resource-manager..."),void 0===ATT["private"].factories)throw new Error("Error exporting `createResourceManager`");ATT["private"].factories.createResourceManager=a}(),function(){"use strict";function a(a){function d(a){if(b.logDebug("ATT.utils.event-channel: processMessages"),b.logInfo("Processing events..."),b.logTrace("messages",a),l=s?JSON.parse(a.responseText):JSON.parse(a.data),b.logTrace("eventData",l),l.events){b.logInfo("Publish events individually");var c,d=l.events.eventList;for(c in d)d.hasOwnProperty(c)&&(b.logTrace("eventObject",d[c].eventObject),p.publish("api-event",d[c].eventObject))}}function e(){b.logDebug("ATT.utils.event-channel: stopListening"),b.logInfo("Stop listening to event channel"),r=!1}function f(a,c){if(b.logDebug("ATT.utils.event-channel: on"),b.logInfo("Subscribing to event-channel event "+a),"api-event"!==a&&"channel-error"!==a)throw b.logError("Event not defined"),new Error("Event not defined");if("function"!=typeof c)throw b.logError("Handler is not a function"),new Error("Handler is not a function");p.unsubscribe(a,c),p.subscribe(a,c,this)}function g(c,d){b.logDebug("ATT.utils.event-channel: retry"),b.logInfo("Retry polling ..."),b.logTrace("config",c),b.logTrace("error",d),204!==d.HttpStatusCode?(b.logInfo("Response code was: "+d.HttpStatusCode),b.logInfo("Re-polling..."),p.publish("channel-error",d)):0===d.HttpStatusCode?(b.logInfo("Request timed out"),b.logInfo("Re-polling...")):(b.logInfo("Response code was: "+d.HttpStatusCode),b.logInfo("Re-polling...")),setTimeout(function(){b.logInfo("Continue polling..."),a.resourceManager.doOperation(v,q)},0)}function h(c){b.logDebug("ATT.utils.event-channel: startListening"),b.logInfo("Start listening to event channel..."),b.logTrace("config",c),r=!0,q={params:{method:s?"GET":"POST",url:{sessionId:a.sessionId,eventChannelUri:s?"events":"websockets"},headers:{Authorization:a.accessToken}},success:m.bind(this,c),error:n.bind(this,c),ontimeout:o.bind(this,c)},a.resourceManager.doOperation(v,q)}b.logDebug("ATT.utils.event-channel: createEventChannel"),b.logInfo("Creating event channel..."),b.logTrace("channelConfig",a);var i,j,k,l,m,n,o,p,q={},r=!1,s=!0,t=2e3,u=3e5,v="getEvents";if(void 0===a||0===Object.keys(a).length)throw b.logError("No options"),new Error("No options");if(void 0===a.accessToken)throw b.logError("No Access Token"),new Error("No Access Token");if(void 0===a.sessionId)throw b.logError("NO Session Id"),new Error("No Session Id");if(void 0===a.resourceManager)throw b.logError("No Resource Manager"),new Error("No Resource Manager");return void 0!==a.interval&&(b.logInfo("Configuring interval"),b.logTrace("interval",a.interval),t=a.interval),void 0!==a.maxPollingTime&&(b.logInfo("Configuring maximum polling time"),b.logTrace("maxPollingTime",a.maxPollingTime),u=a.maxPollingTime),"WebSockets"===a.channelType&&(b.logInfo("Setting long polling to false for WebSockets"),b.logTrace("channelType",a.channelType),s=!1),p=c.createEventEmitter(),b.logTrace("event-channel: operationConfig",q),m=function(c,e){return b.logDebug("createEventChannel: onSuccess"),b.logInfo("Successfully created event channel"),b.logTrace("response",e),"function"==typeof c.success&&(b.logInfo("Successfully got response from event channel"),c.success("Successfully got response from event channel")),r?s?(b.logInfo("Processing messages..."),200===e.getResponseStatus()&&(d(e),b.logInfo("Messages processed, Re-polling..."),b.logTrace("response",e)),void setTimeout(function(){b.logInfo("Continue polling..."),a.resourceManager.doOperation(v,q)},0)):(k=e.getResponseHeader("location"),b.logInfo("Channel sockets"),b.logTrace("locationForSocket",k),void(void 0===j&&k&&(j=new WebSocket(k),j.onmessage=function(a){b.logDebug("createEventChannel: onMessage"),b.logInfo("Message received"),b.logTrace("message",a),d(a)}))):void b.logInfo("Not processing response because event channel is not running")},n=function(a,c){if(r){if(b.logDebug("createEventChannel: onError"),b.logError("Error creating event channel"),b.logTrace("config",a),
b.logInfo("Re-polling..."),t=2*t,t>u)return b.logInfo("Stopping event channel, maximum polling time reached"),b.logTrace("interval",t),b.logTrace("maxPollingTime",u),e(),void p.publish("channel-error",c);g(a,c)}else b.logError("Error running event channel"),b.logTrace("error",c)},o=function(a,c){b.logDebug("createEventChannel: onTimeOut"),b.logTrace("config",a),b.logTrace("error",c),r&&(b.logError("Request timed out"),g(a,c))},i={isListening:function(){return r},startListening:h,stopListening:e,on:f}}var b=ATT.logManager.createLogger("eventChannel"),c=ATT["private"].factories;if(void 0===ATT["private"].factories)throw b.logError("Error exporting `createEventChannel`"),new Error("Error exporting `createEventChannel`");ATT["private"].factories.createEventChannel=a}(),function(){"use strict";function a(a){function f(a){e.logDebug("ATT.event-manager: processEvent"),e.logInfo("Processing the events coming from event channel");var b,f,g,h,i=null;if(!a)return void e.logError("Not able to consume null event...");switch(e.logDebug("Consumed event from event channel:"),void 0!==a.type&&e.logTrace("type",a.type),void 0!==a.from&&e.logTrace("from",a.from),void 0!==a.state&&e.logTrace("state",a.state),void 0!==a.sdp&&e.logTrace("Event SDP",a.sdp),f="calls"===a.type?"call":"conference",void 0!==a.sdp&&(i=d.getMediaType(a.sdp),b=d.getCodecFromSdp(a.sdp)),g=a.resourceURL.split("/")[4],h=a.resourceURL.split("/")[6],(a.state===c.API_EVENT.SESSION_OPEN||a.state===c.API_EVENT.SESSION_MODIFIED)&&a.sdp&&-1!==a.sdp.indexOf("m=video 0")&&-1===a.sdp.indexOf("a=inactive")&&(-1===a.sdp.indexOf("c=IN IP4 0.0.0.0")?a.sdp=a.sdp.replace("sendrecv","inactive"):a.sdp=a.sdp+"a=inactive\r\n"),e.logTrace("Event state",a.state),a.state){case c.API_EVENT.INVITATION_RECEIVED:o.publish(c.API_EVENT.INVITATION_RECEIVED+":"+g,{type:f,id:h,from:a.from,mediaType:i,sdp:a.sdp});break;case c.API_EVENT.MODIFICATION_RECEIVED:o.publish(c.API_EVENT.MODIFICATION_RECEIVED+":"+h,{id:h,remoteSdp:a.sdp,mediaType:i,modificationId:a.modId});break;case c.API_EVENT.MODIFICATION_TERMINATED:o.publish(c.API_EVENT.MODIFICATION_TERMINATED+":"+h,{id:h,type:f,mediaType:i,remoteSdp:a.sdp,modificationId:a.modId,reason:a.reason,from:a.from});break;case c.API_EVENT.SESSION_OPEN:o.publish(c.API_EVENT.SESSION_OPEN+":"+h,{type:f,id:h,remoteSdp:a.sdp,mediaType:i,codec:b||null,provisionalSdp:a.provisionalSDP});break;case c.API_EVENT.SESSION_MODIFIED:o.publish(c.API_EVENT.SESSION_MODIFIED+":"+h,{type:f,id:h,remoteSdp:a.sdp});break;case c.API_EVENT.MOVE_TERMINATED:o.publish(c.API_EVENT.MOVE_TERMINATED+":"+h,{type:f,id:h,from:a.from,reason:a.reason});break;case c.API_EVENT.TRANSFER_INITIATED:o.publish(c.API_EVENT.TRANSFER_INITIATED+":"+h,{type:f,id:h,from:a.from,transferToCallId:a.transferToCallId});break;case c.API_EVENT.TRANSFER_TERMINATED:o.publish(c.API_EVENT.TRANSFER_TERMINATED+":"+h,{type:f,id:h,from:a.from,transferToCallId:a.transferToCallId,reason:a.reason});break;case c.API_EVENT.SESSION_TERMINATED:o.publish(c.API_EVENT.SESSION_TERMINATED+":"+h,{type:f,id:h,from:a.from,reason:a.reason});break;default:e.logError("Unrecognized event state: "+a.state)}}function g(a){e.logDebug("ATT.event-manager: setupEventChannel"),e.logInfo("Setting up the event channel"),e.logTrace(a);var c={accessToken:a.token,sessionId:a.sessionId,publisher:o,resourceManager:n,channelType:l};m=b.createEventChannel(c),m&&(e.logInfo("Event channel up and running"),m.on("api-event",function(a){f(a)}),m.on("channel-error",function(b){a.onError(b)}),e.logInfo("Subscribed to api-event from event channel"),m.startListening({success:function(a){e.logDebug("startListening: success"),e.logInfo("successfully started listening"),e.logTrace(a)},error:a.onError})),o.publish("listening")}function h(){e.logDebug("ATT.event-manager: stop"),e.logInfo("stop listening"),m&&(m.stopListening(),e.logInfo("Event channel shutdown successfully")),o.publish("stop-listening")}function i(a,b){e.logDebug("ATT.event-manager: off"),e.logInfo("Unsubscribing from event-manager event: "+a),o.unsubscribe(a,b)}function j(a,b){if(e.logDebug("ATT.rtc.RTCManager: on"),e.logInfo("Subscribing to event-manager event: "+a),"listening"!==a&&"stop-listening"!==a&&a.indexOf(c.API_EVENT.INVITATION_RECEIVED)<0&&a.indexOf(c.API_EVENT.SESSION_OPEN)<0&&a.indexOf(c.API_EVENT.SESSION_MODIFIED)<0&&a.indexOf(c.API_EVENT.MODIFICATION_RECEIVED)<0&&a.indexOf(c.API_EVENT.MODIFICATION_TERMINATED)<0&&a.indexOf(c.API_EVENT.MOVE_TERMINATED)<0&&a.indexOf(c.API_EVENT.TRANSFER_INITIATED)<0&&a.indexOf(c.API_EVENT.TRANSFER_TERMINATED)<0&&a.indexOf(c.API_EVENT.SESSION_TERMINATED)<0)throw e.logError("Event "+a+" not found"),new Error("Event "+a+" not found");o.unsubscribe(a,b),o.subscribe(a,b)}function k(a){if(e.logDebug("ATT.event-manager: setup"),e.logInfo("Setting up the event channel"),e.logTrace(a),void 0===a)throw e.logError("Options not defined"),new Error("Options not defined");if(void 0===a.sessionId)throw e.logError("Session id is not defined"),new Error("Session id is not defined");if(void 0===a.token)throw e.logError("Token not defined"),new Error("Token not defined");g(a)}e.logDebug("ATT.event-manager: createEventManager"),e.logTrace(a);var l,m,n,o;if(e.logDebug("createEventManager"),void 0===a||0===Object.keys(a).length)throw e.logError("Invalid options"),new Error("Invalid options");if(void 0===a.resourceManager)throw e.logError("Must pass `options.resourceManager`"),new Error("Must pass `options.resourceManager`");if(void 0===a.eventChannelType)throw e.logError("Must pass `options.eventChannelType`"),new Error("Must pass `options.eventChannelType`");return l=a.eventChannelType,n=a.resourceManager,o=b.createEventEmitter(),{on:j,off:i,setup:k,stop:h}}var b=ATT["private"].factories,c=ATT["private"]["enum"],d=ATT.utils,e=ATT.logManager.createLogger("eventManager");if(void 0===ATT["private"].factories)throw new Error("Error exporting createEventManager");ATT["private"].factories.createEventManager=a}(),function(){"use strict";function a(a){function c(a){e.logDebug("ATT.private.RTCManager: extractSessionInformation"),e.logTrace("responseObject",a);var b=null,c=null;if(a&&(a.getResponseHeader("Location")&&(b=a.getResponseHeader("Location").split("/")[4]),a.getResponseHeader("x-expires")&&(c=a.getResponseHeader("x-expires"),c=Number(c),c=isNaN(c)?0:1e3*c)),!b)throw"Failed to retrieve session id";return{sessionId:b,timeout:c}}function g(a,b){e.logDebug("ATT.private.RTCManager: on"),e.logInfo("Subscribing to RTCmanager event: "+a),C.on(a,b)}function h(a,b){e.logDebug("ATT.private.RTCManager: off"),e.logInfo("Unsubscribing from RTCmanager event: "+a),C.off(a,b)}function i(a){if(e.logDebug("ATT.private.RTCManager: refreshSession"),e.logTrace("refreshSessionOpts",a),void 0===a||0===Object.keys(a).length)throw new Error("Invalid options provided");if(void 0===a.sessionId)throw new Error("No sessionId provided");if(void 0===a.token)throw new Error("No token provided");if("function"!=typeof a.onSuccess)throw new Error("No `onSuccess` callback provided");if("function"!=typeof a.onError)throw new Error("No `onError` callback provided");e.logInfo("Calling operation refreshWebRTCSession to refresh session..."),D.doOperation("refreshWebRTCSession",{success:function(b){e.logDebug("doOperation(refreshWebRTCSession): success"),e.logInfo("Successfully completed operation refreshWebRTCSession");try{var c=parseInt(b.getResponseHeader("x-expires"),10);e.logTrace("Session timeout",c),a.onSuccess({timeout:(1e3*c).toString()})}catch(d){e.logError("Error during refreshSession"),e.logTrace(d),a.onError(d)}},error:a.onError,params:{url:[a.sessionId],headers:{Authorization:a.token}}})}function j(a){if(e.logDebug("ATT.private.RTCManager: connectSession"),e.logTrace("connectSessionOpts",a),void 0===a)throw new Error("No options defined.");if(void 0===a.token)throw new Error("No token defined.");if(void 0===a.onSessionConnected)throw new Error("Callback onSessionConnected not defined.");if(void 0===a.onSessionReady)throw new Error("Callback onSessionReady not defined.");if(void 0===a.onError)throw new Error("Callback onError not defined.");var b=function(b){var d,f;try{e.logDebug("doOperation(createWebRTCSession): success"),e.logInfo("Successfully created web rtc session"),f=c(b),a.onSessionConnected(f),d=function(){e.logInfo("listening@eventManager"),a.onSessionReady({sessionId:f.sessionId}),C.off("listening",d)},C.on("listening",d),e.logInfo("Trying to setup the event manager..."),C.setup({sessionId:f.sessionId,token:a.token,onError:function(b){e.logDebug("eventManager.setup: onError"),e.logError("There was an error setting up the eventManager"),e.logTrace(b),a.onError(b)}})}catch(g){e.logError("Error during connectionSession"),e.logTrace(g),a.onError(g)}};e.logInfo("Attempting to create enhanced webrtc session"),D.doOperation("createWebRTCSession",{data:{session:{mediaType:"dtls-srtp",ice:"true",services:["ip_voice_call","ip_video_call"]}},params:{headers:{Authorization:a.token,"x-e911Id":a.e911Id||"","x-Arg":"ClientSDK=WebRTCTestAppJavascript1"}},success:b,error:a.onError})}function k(a){if(e.logDebug("ATT.private.RTCManager: disconnectSession"),e.logTrace("disconnectSessionOpts",a),void 0===a)throw new Error("No options defined.");if(void 0===a.sessionId)throw new Error("No session id defined.");if(void 0===a.token)throw new Error("No token defined.");if(void 0===a.onSessionDisconnected)throw new Error("Callback onSessionDisconnected not defined.");e.logInfo("Attempting to stop event manager..."),C.stop(),e.logInfo("Attempting to delete enhanced webrtc session"),D.doOperation("deleteWebRTCSession",{params:{url:[a.sessionId],headers:{Authorization:a.token,"x-e911Id":a.e911Id}},success:a.onSessionDisconnected,error:a.onError})}function l(a){e.logDebug("ATT.private.RTCManager: connectCall"),e.logTrace("connectCallOpts",a);var b,c,d,g,h;if(void 0===a)throw new Error("No options provided");if(void 0===a.breed)throw new Error("No call breed provided");if("call"===a.breed&&void 0===a.peer)throw new Error("No peer provided");if(void 0===a.sessionId)throw new Error("No session id provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.description)throw new Error("No description provided");if(void 0===a.onSuccess&&"function"!=typeof a.onSuccess)throw new Error("No success callback provided");if(void 0===a.onError&&"function"!=typeof a.onError)throw new Error("No error callback provided");return void 0===a.callId?(h="call"===a.breed?{call:{calledParty:f.createCalledPartyUri(a.peer),sdp:a.description.sdp}}:{conference:{sdp:a.description.sdp}},d={params:{url:{sessionId:a.sessionId,type:a.breed+"s"},headers:{Authorization:a.token}},data:h,success:function(c){e.logDebug("doOperation(createCall): success"),e.logInfo("Success during creating call/conference"),e.logTrace("response",c),b={id:c.getResponseHeader("Location").split("/")[6],state:c.getResponseHeader("x-state")},a.onSuccess(b)},error:a.onError},e.logInfo("Attempting to create the call..."),void D.doOperation("createCall",d)):(g={Authorization:a.token,options:{}},"call"===a.breed?(g.options["x-calls-action"]="call-answer",h={callsMediaModifications:{sdp:a.description.sdp}}):(g.options["x-conference-action"]="call-answer",h={conferenceModifications:{sdp:a.description.sdp}}),c={params:{url:{sessionId:a.sessionId,callId:a.callId,type:a.breed+"s"},headers:g},data:h,success:function(c){e.logDebug("doOperation(modifyCall): success"),e.logInfo("Success during answering call/conference"),e.logTrace("response",c),b={state:c.getResponseHeader("x-state")},a.onSuccess(b)},error:a.onError},e.logInfo("Attempting to answer the call..."),void D.doOperation("modifyCall",c))}function m(a){e.logDebug("RTCManager: acceptMediaModifications"),e.logTrace("options",a);var b,c,d="call"===a.breed?"calls":"conferences";b={params:{url:{sessionId:a.sessionId,type:d,callId:a.callId},headers:{Authorization:a.token,"x-modId":a.modId}},data:{callsMediaModifications:{sdp:a.sdp}},success:function(){e.logDebug("doOperation(acceptMediaModifications): success"),e.logInfo("Successfully accepted media modifications for call"),a.onSuccess()},error:function(a){e.logDebug("doOperation(acceptMediaModifications): error"),e.logError("Error during accepting media modifications for call"),e.logTrace(a)}},c={params:{url:{sessionId:a.sessionId,type:d,callId:a.callId},headers:{Authorization:a.token,"x-mod-Id":a.modId}},data:{conferenceModifications:{sdp:a.sdp}},success:function(){e.logDebug("doOperation(acceptConferenceModifications): success"),e.logInfo("Successfully accepted media modifications for conference")},error:function(a){e.logDebug("doOperation(acceptConferenceModifications): error"),e.logError("Error during accepting media modifications for conference"),e.logTrace(a)}},e.logInfo("Attempting to accept media modifications for the "+a.breed),"calls"===d?D.doOperation("acceptCallModifications",b):D.doOperation("acceptConferenceModifications",c)}function n(a){e.logDebug("ATT.private.RTCManager: acceptMediaModifications"),e.logTrace("acceptMediaModOpts",a);var b,c="calls";b={params:{url:{sessionId:a.sessionId,type:c,callId:a.callId},headers:{Authorization:a.token,"x-modId":a.modId}},data:{callsMediaModifications:{sdp:a.sdp}},success:function(){e.logDebug("doOperation(rejectMediaModOpts): success"),e.logInfo("Successfully rejecting media modifications for call")},error:function(a){e.logDebug("doOperation(rejectMediaModOpts): error"),e.logError("Error during rejecting media modifications for call"),e.logTrace(a)}},e.logInfo("Attempting to reject media modifications for the "+a.breed),D.doOperation("rejectMediaModification",b)}function o(a){e.logDebug("ATT.private.RTCManager: addParticipant"),e.logTrace("addParticipantOpts",a);var b,c;if(void 0===a)throw new Error("No `options` passed");if(void 0===a.sessionInfo)throw new Error("No `sessionInfo` passed");if(void 0===a.confId)throw new Error("No `confId` passed");if("function"!=typeof a.onSuccess)throw new Error("No `onSuccess` callback passed");b=a.invitee.toString(),b=b.indexOf("@")>-1?"sip:"+b:"tel:+"+b,e.logInfo("Attempting to add a participant to the conference"),D.doOperation("addParticipant",{params:{url:[a.sessionInfo.sessionId,a.confId,b],headers:{Authorization:a.sessionInfo.token}},success:function(b){e.logDebug("doOperation(addParticipant): success"),e.logInfo("Successfully added participant to the conference"),e.logTrace("response",b),"add-pending"===b.getResponseHeader("x-state")&&(c=b.getResponseHeader("x-modId"),a.onSuccess(c))},error:function(b){e.logDebug("doOperation(addParticipant): error"),e.logError("Error during adding a participant to the conference"),e.logTrace(b),a.onError(b)}})}function p(a){e.logDebug("ATT.private.RTCManager: removeParticipant"),e.logTrace("removeParticipantOpts",a);var b;if(void 0===a)throw new Error("No `options` passed");if(void 0===a.sessionInfo)throw new Error("No `sessionInfo` passed");if(void 0===a.confId)throw new Error("No `confId` passed");if("function"!=typeof a.onSuccess)throw new Error("No `onSuccess` callback passed");b=a.participant.toString(),b=b.indexOf("@")>-1?"sip:"+b:"tel:+"+b,e.logInfo("Attempting to remove a participant from the the conference"),D.doOperation("removeParticipant",{params:{url:[a.sessionInfo.sessionId,a.confId,b],headers:{Authorization:a.sessionInfo.token}},success:function(b){e.logDebug("doOperation(removeParticipant): success"),e.logInfo("Successfully removed participant from the conference"),e.logTrace("response",b),"remove-pending"===b.getResponseHeader("x-state")&&a.onSuccess()},error:function(b){e.logDebug("doOperation(removeParticipant): error"),e.logError("Error during removing participant from the conference"),e.logTrace(b),a.onError(b)}})}function q(a){if(e.logDebug("ATT.private.RTCManager: disconnectCall"),e.logTrace("disconnectCallOpts",a),void 0===a)throw new Error("No options provided");if(void 0===a.callId)throw new Error("No CallId provided");if(void 0===a.breed)throw new Error("No call breed provided");if(void 0===a.sessionId)throw new Error("No sessionId provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.onSuccess)throw new Error("No success callback provided");if(void 0===a.onError)throw new Error("No error callback provided");e.logInfo("Attempting to delete the "+a.breed),D.doOperation("deleteCall",{params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:{Authorization:a.token,"x-delete-reason":"terminate"}},success:function(){e.logDebug("doOperation(deleteCall): success"),e.logInfo("Successfully deleted the "+a.breed)},error:function(b){e.logDebug("doOperation(deleteCall): error"),e.logError("Error deleting the "+a.breed),e.logTrace(b),a.onError(b)}})}function r(a){if(e.logDebug("ATT.private.RTCManager: cancelCall"),e.logTrace("cancelCallOpts",a),void 0===a)throw new Error("No options provided");if(void 0===a.callId)throw new Error("No callId provided");if(void 0===a.breed)throw new Error("No call breed provided");if(void 0===a.sessionId)throw new Error("No sessionId provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.onSuccess)throw new Error("No success callback provided");if(void 0===a.onError)throw new Error("No error callback provided");a.callId.length>0&&(e.logInfo("Attempting to cancel the "+a.breed),D.doOperation("deleteCall",{params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:{Authorization:a.token,"x-delete-reason":"cancel"}},success:function(){e.logDebug("doOperation(deleteCall): success"),e.logInfo("Successfully deleted the "+a.breed),a.onSuccess()},error:function(b){e.logDebug("doOperation(deleteCall): error"),e.logError("Error canceling the "+a.breed),e.logTrace(b),a.onError(b)}}))}function s(a,b){e.logDebug("ATT.private.RTCManager: holdOrMoveCall"),e.logTrace("holdOrMoveCallOpts",a),e.logTrace("action",b);var c,d,f;if(void 0!==a&&(f="move"===b?"move":"hold"),void 0===a)throw new Error("No options provided");if(void 0===a.callId)throw new Error("No callId provided");if(void 0===a.sessionId)throw new Error("No sessionId provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.description)throw new Error("No sdp provided");if(void 0===a.breed)throw new Error("No breed provided");if(void 0===a.onSuccess)throw new Error("No success callback provided");if(void 0===a.onError)throw new Error("No error callback provided");d={Authorization:a.token,options:{}},e.logDebug("Modification data:"),"conference"===a.breed?(c={conferenceModifications:{sdp:a.description.sdp,type:a.description.type}},d.options["x-conference-action"]="initiate-hold",e.logTrace("sdp",c.conferenceModifications.sdp),e.logTrace("type",c.conferenceModifications.type)):(c={callsMediaModifications:{sdp:a.description.sdp,type:a.description.type}},d.options["x-calls-action"]="initiate-call-"+f,e.logTrace("sdp",c.callsMediaModifications.sdp),e.logTrace("type",c.callsMediaModifications.type)),e.logInfo("Attempting to "+f+" the "+a.breed),D.doOperation("modifyCall",{params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:d},data:c,success:function(b){e.logDebug("doOperation(modifyCall): success"),e.logInfo("Successfully performed operation "+f+" on the "+a.breed),e.logTrace("response",b),204===b.getResponseStatus()?(e.logInfo("Response Status 204"),a.onSuccess()):(e.logError("Response Status is not 204"),a.onError())},error:function(b){e.logDebug("doOperation(modifyCall): error"),e.logError("Error during performing operation "+f+" on the "+a.breed),e.logTrace(b),a.onError(b)}})}function t(a){e.logDebug("ATT.private.RTCManager: holdCall"),e.logTrace("holdCallOpts",a),s(a,"hold")}function u(a){e.logDebug("ATT.private.RTCManager: moveCall"),e.logTrace("moveCallOpts",a),s(a,"move")}function v(a){e.logDebug("ATT.private.RTCManager: resumeCall"),e.logTrace("resumeCallOpts",a);var b,c;if(void 0===a)throw new Error("No options provided");if(void 0===a.callId)throw new Error("No callId provided");if(void 0===a.sessionId)throw new Error("No sessionId provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.description)throw new Error("No sdp provided");if(void 0===a.breed)throw new Error("No breed provided");if(void 0===a.onSuccess)throw new Error("No success callback provided");if(void 0===a.onError)throw new Error("No error callback provided");c={Authorization:a.token,options:{}},"conference"===a.breed?(b={conferenceModifications:{sdp:a.description.sdp,type:a.description.type}},c.options["x-conference-action"]="initiate-resume"):(b={callsMediaModifications:{sdp:a.description.sdp,type:a.description.type}},c.options["x-calls-action"]="initiate-call-resume"),e.logInfo("Attempting to resume the "+a.breed),D.doOperation("modifyCall",{params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:c},data:b,success:function(b){e.logDebug("doOperation(modifyCall): success"),e.logInfo("Successfully resuming the "+a.breed),e.logTrace("response",b),204===b.getResponseStatus()?(e.logInfo("Resume request sent..."),a.onSuccess()):a.onError()},error:function(b){e.logDebug("doOperation(modifyCall): error"),e.logError("Error resuming the "+a.breed),e.logTrace(b),a.onError(b)}})}function w(a){e.logDebug("ATT.private.RTCManager: associateE911Id"),e.logTrace("associateE911IdOpts",a);var b;if(void 0===a)throw"Invalid options";if(void 0===a.token||""===a.token)throw"No token passed";if(void 0===a.e911Id||""===a.e911Id)throw"No e911Id passed";if(void 0===a.sessionId||""===a.sessionId)throw"No session Id passed";if(void 0===a.onSuccess||"function"!=typeof a.onSuccess)throw"No success callback passed";if(void 0===a.onError||"function"!=typeof a.onError)throw"No error callback passed";b={data:{e911Association:{e911Id:a.e911Id}},params:{url:[a.sessionId],headers:{Authorization:a.token}},success:a.onSuccess,error:a.onError},e.logInfo("Attempting to associate the e911Id with session..."),D.doOperation("associateE911Id",b)}function x(a){if(e.logDebug("ATT.private.RTCManager: associateE911Id"),e.logTrace("associateTokenOpts",a),void 0===a)throw new Error("No options provided.");if(void 0===a.userId)throw new Error("No userId provided.");if(void 0===a.token)throw new Error("No token provided.");e.logInfo("Attempting to associate token with the user id..."),D.doOperation("associateTokenWithUserId",{params:{url:{userId:a.userId},headers:{Authorization:a.token}},success:a.success,error:a.error})}function y(a){if(e.logDebug("ATT.private.RTCManager: associateE911Id"),e.logTrace("rejectCallOpts",a),void 0===a)throw new Error("Invalid options");if(void 0===a.callId||""===a.callId)throw new Error("No callId provided");if(void 0===a.breed||""===a.breed)throw new Error("No call breed provided");if(void 0===a.sessionId||""===a.sessionId)throw new Error("No session Id provided");if(void 0===a.token||""===a.token)throw new Error("No token provided");if(void 0===a.onSuccess||"function"!=typeof a.onSuccess)throw new Error("No success callback provided");if(void 0===a.onError||"function"!=typeof a.onError)throw new Error("No error callback provided");e.logInfo("Attempting to reject the "+a.breed),D.doOperation("deleteCall",{params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:{Authorization:a.token,"x-delete-reason":"reject"}},success:function(){e.logDebug("doOperation(deleteCall): success"),e.logInfo("Successfully deleted the "+a.breed)},error:function(b){e.logDebug("doOperation(deleteCall): error"),e.logError("Error deleting the "+a.breed),e.logTrace(b),a.onError(b)}})}function z(a){if(e.logDebug("ATT.private.RTCManager: transferCall"),e.logTrace("transferCallOpts",a),void 0===a||0===Object.keys(a).length)throw new Error("No options provided");if(void 0===a.callId)throw new Error("No call id provided");if(void 0===a.breed)throw new Error("No call breed provided");if(void 0===a.sessionId)throw new Error("No session id provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.targetCallId)throw new Error("No target call id provided");if(void 0===a.transfereeSdp)throw new Error("No sdp provided");if(void 0===a.success)throw new Error("No success callback provided");if(void 0===a.error)throw new Error("No error callback provided");e.logInfo("Attempting to transfer the "+a.breed),D.doOperation("transferCall",{data:{callsMediaModifications:{sdp:a.transfereeSdp}},params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:{Authorization:a.token,"x-transferTargetCallId":a.targetCallId}},success:function(){e.logDebug("doOperation(transferCall): success"),e.logInfo("Successfully transferred the "+a.breed),a.success()},error:function(b){e.logDebug("doOperation(transferCall): error"),e.logError("Error transferring the "+a.breed),e.logTrace(b),a.error(b)}})}function A(a){e.logDebug("RTCManager: modifyCall"),e.logTrace("options",a);var b,c;if(void 0===a)throw new Error("No options provided");if(void 0===a.callId)throw new Error("No callId provided");if(void 0===a.sessionId)throw new Error("No sessionId provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.description)throw new Error("No sdp provided");if("function"!=typeof a.onSuccess)throw new Error("No success callback provided");if("function"!=typeof a.onError)throw new Error("No error callback provided");c={Authorization:a.token,options:{}},b={callsMediaModifications:{sdp:a.description.sdp}},c.options["x-calls-action"]="initiate-call-mod",D.doOperation("modifyCall",{params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:c},data:b,success:function(b){e.logDebug("Received response for modification:"),e.logTrace("response",b),204===b.getResponseStatus()?(e.logDebug("Modification sent successfully."),a.onSuccess()):(e.logError("Modification failed."),e.logTrace("responseStatus",b.getResponseStatus()),a.onError())},error:function(b){e.logError("Modification failed."),e.logTrace(b),a.onError(b)}})}var B,C,D;D=a.resourceManager,e.logDebug("ATT.private.RTCManager: Constructor"),e.logTrace("options",a),B=d.getAppConfiguration(),C=b.createEventManager({resourceManager:D,eventChannelType:B.eventChannelType}),this.on=g,this.off=h,this.connectSession=j,this.disconnectSession=k,this.connectCall=l,this.acceptMediaModifications=m,this.addParticipant=o,this.removeParticipant=p,this.disconnectCall=q,this.refreshSession=i,this.cancelCall=r,this.holdCall=t,this.moveCall=u,this.resumeCall=v,this.rejectCall=y,this.transferCall=z,this.associateE911Id=w,this.associateToken=x,this.modifyCall=A,this.rejectMediaModification=n}var b=ATT["private"].factories,c=ATT["private"].config.api,d=ATT["private"].config.app,e=ATT.logManager.createLogger("rtcManager"),f=ATT.utils;if(void 0===ATT["private"])throw new Error("Error exporting `RTCManager`");ATT["private"].RTCManager=a,ATT["private"].rtcManager=function(){var d,e;return{getRTCManager:function(){return void 0===d&&(e=b.createResourceManager(c),d=new a({resourceManager:e})),d}}}()}();var RTCPeerConnection=null,RTCSessionDescription,RTCIceCandidate=null,getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null,logger=ATT.logManager.createLogger("adapter"),createIceServer;if(navigator.mozGetUserMedia)logger.logInfo("This appears to be Firefox"),logger.logInfo(navigator.userAgent),webrtcDetectedBrowser="firefox",webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10),RTCPeerConnection=mozRTCPeerConnection,RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate,getUserMedia=navigator.mozGetUserMedia.bind(navigator),createIceServer=function(a,b,c){var d,e=null,f=a.split(":");return 0===f[0].indexOf("stun")?e={url:a}:0===f[0].indexOf("turn")?webrtcDetectedVersion>=27?e={url:a,credential:c,username:b}:(d=a.split("?"),0===d[1].indexOf("transport=udp")?e={url:d[0],credential:c,username:b}:null):void 0},attachMediaStream=function(a,b){logger.logInfo("Attaching media stream"),a.mozSrcObject=b,a.play()},reattachMediaStream=function(a,b){logger.logInfo("Reattaching media stream"),a.mozSrcObject=b.mozSrcObject,a.play()},MediaStream.prototype.getVideoTracks||(MediaStream.prototype.getVideoTracks=function(){return[]}),MediaStream.prototype.getAudioTracks||(MediaStream.prototype.getAudioTracks=function(){return[]});else if(navigator.webkitGetUserMedia){logger.logInfo("This appears to be Chrome"),logger.logInfo(navigator.userAgent),webrtcDetectedBrowser="chrome",webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10);var createIceServer=function(a,b,c){var d=null,e=a.split(":");return 0===e[0].indexOf("stun")?d={url:a}:0===e[0].indexOf("turn")&&(d={url:a,credential:c,username:b}),d};RTCPeerConnection=webkitRTCPeerConnection,getUserMedia=navigator.webkitGetUserMedia.bind(navigator),attachMediaStream=function(a,b){"undefined"!==a.srcObject?a.srcObject=b:"undefined"!==a.mozSrcObject?a.mozSrcObject=b:"undefined"!==a.src?a.src=URL.createObjectURL(b):logger.logError("Error attaching stream to element.")},reattachMediaStream=function(a,b){a.src=b.src}}else logger.logError("Browser does not appear to be WebRTC-capable");!function(){"use strict";function a(a){function e(a){return{sdp:a.sdp,type:a.type}}function f(a){if(void 0===a||null===a)throw new Error("Stream is undefined");c.logDebug("peerConnection: Removing stream"),c.logTrace("stream.id",a.id),r.removeStream(a)}function g(a){if(void 0===a||null===a)throw new Error("Stream is undefined");c.logDebug("peerConnection: Adding stream"),c.logTrace("stream.id",a.id),r.addStream(a),"function"==typeof r.createDTMFSender&&(w=r.createDTMFSender(a.getAudioTracks()[0]))}function h(d,f,g){if(c.logDebug("peerConnection: setLocalDescription"),c.logTrace("description.type",d.type),c.logTrace("description.sdp",d.sdp),void 0!==a.pcConfiguration.audioCodec){var h=b.createSdp(e(d));d=h.modifyForSetAudioCodec(a.pcConfiguration.audioCodec).getDescription(),c.logTrace("modified description.sdp",d.sdp)}r.setLocalDescription(new RTCSessionDescription(d),function(){c.logDebug("Successfully set the local description."),void 0!==f&&"function"==typeof f&&f()},function(a){c.logError("Error setting the local description."),c.logTrace("error",a),void 0!==g&&"function"==typeof g&&g(a)})}function i(a,b,d){c.logDebug("peerConnection: setRemoteDescription"),c.logTrace("description.type",a.type),c.logTrace("description.sdp",a.sdp),r.setRemoteDescription(new RTCSessionDescription(a),function(){c.logDebug("Successfully set remote description."),void 0!==b&&"function"==typeof b&&b()},function(a){c.logError("Failed to set remote description."),c.logTrace("error",a),void 0!==d&&"function"==typeof d&&d(a)})}function j(a,b,d){if(c.logDebug("peerConnection: createOffer"),c.logTrace("constraints",d),void 0===a)throw new Error("No success callback defined.");if(void 0===b)throw new Error("No error callback defined.");r.createOffer(a,b,{mandatory:d})}function k(a,b,d){if(c.logDebug("peerConnection: createAnswer"),c.logTrace("constraints",d),void 0===a)throw new Error("No success callback defined.");if(void 0===b)throw new Error("No error callback defined.");r.createAnswer(a,b,{mandatory:d})}function l(b){c.logDebug("ATT.private.peer-connection: createSdpOffer"),c.logTrace("createSdpOffer: options",b),c.logInfo("Trying to create an SDP offer..."),r.createOffer(function(a){c.logDebug("createOffer: success"),c.logInfo("Successfully created the sdp offer"),c.logTrace("local description",a),c.logInfo("Trying to set the local description..."),h(a,function(){c.logDebug("createOffer:setLocalDescription: success"),c.logInfo("Successfully set the local description during createSdpOffer"),void 0!==b.onSuccess&&b.onSuccess()},function(a){c.logDebug("createSdpOffer:setLocalDescription: error"),c.logError("Error during createSdpOffer:setLocalDescription"),c.logTrace(a),b.onError(a)})},function(a){c.logError("Error during createSdpOffer"),c.logTrace(a),b.onError(a)},{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:"video"===a.mediaType
}})}function m(a){if(void 0===a)throw new Error("No options provided.");if(void 0===a.constraints)throw new Error("No constraints provided.");if(void 0===a.onOfferReady)throw new Error("No onOfferReady callback provided.");if(void 0===a.onError)throw new Error("No onError callback provided.");c.logDebug("ATT.private.peer-connection: generateOffer"),c.logInfo("Trying to generate an SDP offer..."),j(function(b){c.logDebug("createOffer: success"),c.logInfo("Successfully created the sdp offer during generateOffer"),"function"==typeof a.onOfferCreated&&(b=a.onOfferCreated(e(b))),c.logTrace("local description",b),c.logInfo("Trying to set the local description..."),h(b,function(){c.logDebug("createOffer:setLocalDescription: success"),c.logInfo("Successfully set the local description during generateOffer"),"complete"===r.iceGatheringState?a.onOfferReady(e(b)):t=a.onOfferReady},function(b){c.logDebug("generateOffer:setLocalDescription: error"),c.logError("Error during generateOffer:setLocalDescription"),c.logTrace(b),a.onError(b)})},function(b){c.logDebug("generateOffer:setLocalDescription: error"),c.logError("Error during generateOffer:createOffer"),c.logTrace(b),a.onError(b)},a.constraints)}function n(d){c.logDebug("ATT.private.peer-connection: createSdpAnswer"),c.logTrace("createSdpAnswer: options",d),c.logInfo("Trying to create an SDP answer..."),r.createAnswer(function(a){c.logDebug("createAnswer: success"),c.logInfo("Successfully created the SDP answer"),c.logTrace("localSdp",a);var e=b.createSdp({sdp:a.sdp,type:a.type});e.replaceUFragPwd(),a=e.getDescription(),h(a,function(){c.logDebug("createSdpAnswer:setLocalDescription: success"),c.logInfo("Successfully set the local description during createSdpAnswer"),void 0!==d.onSuccess&&d.onSuccess(a)},function(a){c.logDebug("createSdpAnswer:setLocalDescription: error"),c.logError("Error during createSdpAnswer:setLocalDescription"),c.logTrace(a),d.onError(a)})},function(a){c.logDebug("createAnswer: error"),c.logInfo("Error creating the SDP answer"),c.logTrace(a),d.onError(a)},{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:"video"===a.mediaType}})}function o(a){c.logDebug("ATT.private.peer-connection: acceptSdpOffer"),c.logTrace("acceptSdpOffer: options",a),c.logInfo("Trying to set the remote description..."),i(a.remoteDescription,function(){c.logDebug("acceptSdpOffer:setRemoteDescription: success"),c.logInfo("Trying to create the SDP answer..."),n(a)},function(b){c.logDebug("acceptSdpOffer:setRemoteDescription: error"),c.logInfo("Error during acceptSdpOffer:setRemoteDescription"),c.logTrace(b),a.onError(b)})}function p(a){if(c.logDebug("ATT.private.peer-connection: generateAnswer"),void 0===a)throw new Error("No options provided.");if(void 0===a.constraints)throw new Error("No constraints provided.");if("function"!=typeof a.onAnswerReady)throw new Error("No onAnswerReady callback provided.");if("function"!=typeof a.onError)throw new Error("No onError callback provided.");c.logInfo("Trying to generate an SDP answer..."),k(function(b){c.logDebug("createAnswer: success"),c.logInfo("Successfully created the sdp offer during generateAnswer"),c.logTrace("description on createAnswer success",b),"function"==typeof a.onAnswerCreated&&(b=a.onAnswerCreated(e(b))),h(b,function(){c.logDebug("createAnswer:setLocalDescription: success"),c.logInfo("Successfully set the local description during generateAnswer"),"complete"===r.iceGatheringState?a.onAnswerReady(e(b)):t=a.onAnswerReady},function(b){c.logDebug("generateAnswer:setLocalDescription: error"),c.logError("Error during generateAnswer:setLocalDescription"),c.logTrace(b),a.onError(b)})},function(b){c.logDebug("generateAnswer:createAnswer: error"),c.logError("Error during generateOffer:createAnswer"),c.logTrace(b),a.onError(b)},a.constraints)}function q(a){if(void 0===a||0===Object.keys(a).length)throw new Error("No options provided");if(void 0===a.input)throw new Error("No input provided");if("function"!=typeof a.onToneSent)throw new Error("No onToneSend callback passed");if("function"!=typeof a.onToneSending)throw new Error("No onToneSending callback provided");if(void 0===w)throw new Error("DTMF is not supported on this browser.Browser "+navigator.appName+"Version"+navigator.appVersion);if(void 0!==w){var b=!1;if(w.ontonechange=function(c){b||a.onToneSent(c),b=!0},a.onToneSending(),void 0!==a.gap)return void w.insertDTMF(a.input,w.duration,a.gap);w.insertDTMF(a.input)}}c.logDebug("ATT.private.factories: createPeerConnection"),c.logTrace("createPeerConnection.config",a);var r,s,t,u,v,w;if(void 0===a||0===Object.keys(a).length)throw c.logError("No options passed."),new Error("No options passed.");if(void 0===a.stream)throw c.logError("No `stream` passed."),new Error("No `stream` passed.");if(void 0===a.mediaType)throw c.logError("No `mediaType` passed."),new Error("No `mediaType` passed.");if("function"!=typeof a.onSuccess)throw c.logError("No `onSuccess` callback passed."),new Error("No `onSuccess` callback passed.");if(t=a.onSuccess,"function"!=typeof a.onRemoteStream)throw c.logError("No `onRemoteStream` callback passed."),new Error("No `onRemoteStream` callback passed.");if(s=a.onRemoteStream,"function"!=typeof a.onError)throw c.logError("No `onError` callback passed."),new Error("No `onError` callback passed.");if("object"!=typeof a.pcConfiguration)throw c.logError("No `pcConfiguration` parameter passed."),new Error("No `pcConfiguration` parameter passed.");try{c.logInfo("Creating the peer connection"),u={iceServers:a.pcConfiguration.iceServers,iceTransports:a.pcConfiguration.iceTransports},v={optional:[{googIPv6:a.pcConfiguration.ipv6}]},r=new RTCPeerConnection(u,v)}catch(x){throw c.logError("Failed to create PeerConnection."),c.logTrace(x),new Error("Failed to create PeerConnection.")}return r.addStream(a.stream),"function"==typeof r.createDTMFSender&&(w=r.createDTMFSender(a.stream.getAudioTracks()[0])),r.onaddstream=function(a){s(a.stream)},r.onicecandidate=function(a){var f,g=d.getBrowserName();return c.logDebug("createPeerConnection: onIceCandidate"),c.logInfo("Got ICE candidate"),c.logTrace("candidate",a.candidate),"Chrome"===g&&"function"==typeof t?(f=b.createSdp(e(r.localDescription)),void(f.hasICECandidates()&&(t(e(r.localDescription)),t=void 0))):void(a.candidate?(c.logInfo("Got new ICE Candidate"),c.logTrace("Candidate",a.candidate)):(c.logInfo("End of ICE Candidates"),"Firefox"===g&&"function"==typeof t&&t(e(r.localDescription))))},void 0===a.remoteSdp?l({onError:a.onError}):o({remoteDescription:a.remoteSdp,onError:a.onError}),c.logInfo("Peer connection created"),c.logTrace("Peer connection",r),{isStateStable:function(){return"stable"===r.signalingState},hasLocalOffer:function(){return"have-local-offer"===r.signalingState},hasRemoteOffer:function(){return"have-remote-offer"===r.signalingState},getLocalDescription:function(){return e(r.localDescription)},setRemoteDescription:i,setLocalDescription:h,createSdpOffer:l,createSdpAnswer:n,acceptSdpOffer:o,getRemoteDescription:function(){return e(r.remoteDescription)},close:function(){r.close(),r=null},removeStream:f,addStream:g,generateOffer:m,generateAnswer:p,sendDTMFTone:q}}var b=ATT["private"].factories,c=ATT.logManager.createLogger("peerConnection"),d=ATT.utils;if(c.logDebug("Loading att.peer-connection"),void 0===ATT["private"].factories)throw new Error("Error exporting `ATT.private.factories.createPeerConnection`");ATT["private"].factories.createPeerConnection=a}(),function(){"use strict";function a(a,e){function f(){return N.media.forEach(function(a){a.setup="actpass"}),L=d.write(N),this}function g(a){return N.media.forEach(function(b){(void 0===a||a===b.type)&&(b.setup="passive")}),L=d.write(N),this}function h(){return N.media.forEach(function(a){a.direction="inactive"}),L=d.write(N),this}function i(){return N.media.forEach(function(a){a.direction="recvonly"}),L=d.write(N),this}function j(a){return-1!==a.indexOf("c=IN IP4")?a.split("c=IN IP4 ")[1].split("\r\n")[0]:null}function k(a,b){return-1===a.indexOf("m="+b)?!1:!0}function l(a,b){var c;return!1===k(a,b)?null:(c=a.split("m="+b)[1],void 0===c?null:c)}function m(a){var b;return!1===k(a.sdp,a.mediaType)?null:(b=l(a.sdp,a.mediaType).split(" ")[1],void 0===b?null:b)}function n(a){return"string"!=typeof a||0===a.length?!1:-1===a.toLowerCase().indexOf("2 udp")?!1:!0}function o(a){var b,c,d,e;return"string"!=typeof a.sdp||0===a.sdp.length?null:(c=l(a.sdp,a.mediaType),!1===n(c)?null:(b=c.split(/2 udp/i)[1],void 0===b?null:(d=b.split(a.ip)[1],void 0===d?null:e=d.split("typ")[0].trim())))}function p(a){var b,c,d,e,f;return d=j(a),b=m({sdp:a,mediaType:"audio"}),e=o({sdp:a,ip:d,mediaType:"audio"}),!0===k(a,"video")&&(c=m({sdp:a,mediaType:"video"}),e=o({sdp:a.split("m=video")[0],ip:d,mediaType:"audio"}),f=o({sdp:a,ip:d,mediaType:"video"})),{audioPort:b,videoPort:c,audioPortRTCP:e,videoPortRTCP:f,ip:d}}function q(a){var b,c,d;return void 0===a.sdpPorts.ip||null===a.sdpPorts.ip?a.sdp:(d=a.sdp,void 0!==a.sdpPorts.audioPort&&void 0!==a.sdpPorts.audioPortRTCP&&(b=parseInt(a.sdpPorts.audioPort,10)+1,d=a.sdp.replace(a.sdpPorts.ip+" "+a.sdpPorts.audioPortRTCP,a.sdpPorts.ip+" "+b)),!0===k(a.sdp,"video")&&void 0!==a.sdpPorts.videoPort&&void 0!==a.sdpPorts.videoPortRTCP&&(c=parseInt(a.sdpPorts.videoPort,10)+1,d=d.replace(a.sdpPorts.ip+" "+a.sdpPorts.videoPortRTCP,a.sdpPorts.ip+" "+c)),d)}function r(a){return-1===a.sdp.indexOf("a=rtcp:"+a.sdpPorts.audioPort+" IN IP4")?!1:!0}function s(a){return!1===r(a)?!1:"string"!=typeof a.sdpPorts.ip||"0.0.0.0"===a.sdpPorts.ip?!1:!1===k(a.sdp,"audio")?!1:"string"!=typeof a.sdpPorts.audioPort||"string"!=typeof a.sdpPorts.audioPortRTCP||parseInt(a.sdpPorts.audioPortRTCP,10)!==parseInt(a.sdpPorts.audioPort,10)+1?!1:!0!==k(a.sdp,"video")||"string"==typeof a.sdpPorts.videoPortRTCP&&"string"==typeof a.sdpPorts.videoPort&&parseInt(a.sdpPorts.videoPortRTCP,10)===parseInt(a.sdpPorts.videoPort,10)+1?!0:!1}function t(){return c.logDebug("getParsedSdp"),c.logTrace("parsedSdp",N),N}function u(){return O}function v(){return c.logDebug("getOriginal"),c.logTrace("originalSdp",L),{sdp:L,type:M}}function w(){return c.logDebug("getMinimal"),c.logTrace("minimalSdp:string",L),c.logTrace("minimalSdp:parsed",N),{sdp:d.write(N),type:M}}function x(){return O?w():v()}function y(){var a,c,e;if(a=b.getBrowserName(),"Firefox"===a){if(c=p(L),e={sdp:L,sdpPorts:c,browser:a},!0===s(e)||0===Object.keys(c).length)return;L=q(e),N=d.parse(L)}return this}function z(){return L=L.replace(/a=sendonly/g,"a=inactive"),N=d.parse(L),this}function A(){return f(),this}function B(a){return void 0!==a&&null!==a&&N.media.forEach(function(b){if("audio"===b.type&&void 0!==b.rtp){var c=[],d=[],e=[];b.rtp.forEach(function(b){("telephone-event"===b.codec.toLowerCase()||a.toLowerCase()===b.codec.toLowerCase())&&(c.push(b),d.push(b.payload))}),void 0!==b.fmtp&&b.fmtp.forEach(function(a){-1!==d.indexOf(a.payload)&&e.push(a)}),b.rtp=c,b.payloads=d.join(" "),0===e.length?delete b.fmtp:b.fmtp=e}}),L=d.write(N),this}function C(){var a,b,c=!1,d=null,e=1,f=2;return void 0!==N.media&&0<N.media.length&&(N.media.forEach(function(c){0!==c.port&&(a=!1,b=!1,void 0!==c.candidates&&c.candidates.forEach(function(c){"udp"===c.transport&&(e===c.component&&(a=!0),f===c.component&&(b=!0))}),d=(null===d||d)&&a&&b),d=null===d||d}),c=d),c}function D(){var a=null;return void 0===N.media?!1:(N.media.forEach(function(b){a="sendonly"===b.direction||"inactive"===b.direction?null===a?!0:a:!1}),a)}function E(){var a=null;return void 0===N.media?!1:(N.media.forEach(function(b){a="sendrecv"===b.direction||"recvonly"===b.direction?null===a?!0:a:!1}),a)}function F(){var a=null;return void 0===N.media?!1:(N.media.forEach(function(b){a="recvonly"===b.direction||"inactive"===b.direction?null===a?!0:a:!1}),a)}function G(){var a=!1,b=!1;return void 0===N.media?!1:(N.media.forEach(function(c){"audio"===c.type&&"sendrecv"===c.direction?a=!0:"video"===c.type&&"sendrecv"===c.direction&&(b=!0)}),a&&b)}function H(){var a=!1,b=!1;return void 0===N.media?!1:(N.media.forEach(function(c){"audio"===c.type&&"sendrecv"===c.direction?a=!0:"video"===c.type&&"recvonly"===c.direction&&(b=!0)}),a&&b)}function I(){return N.media&&(void 0!==N.media[1]&&void 0!==N.media[1].ssrcs?(delete N.media[0].ssrcs,delete N.media[1].ssrcs,delete N.media[1].ssrcGroup):void 0!==N.media[0]&&void 0!==N.media[0].ssrcs&&delete N.media[0].ssrcs),L=d.write(N),this}function J(){return N.media&&void 0!==N.media[1]&&0===N.media[1].port&&void 0!==N.media[1].ssrcs&&(delete N.media[1].ssrcs,delete N.media[1].ssrcGroup),L=d.write(N),this}function K(){return N.media&&void 0!==N.media[1]&&void 0!==N.media[1].iceUfrag&&(N.media[1].iceUfrag=N.media[0].iceUfrag,N.media[1].icePwd=N.media[0].icePwd),L=d.write(N),this}c.logDebug("ATT.private.factories.createSdp: Constructor");var L,M,N,O=!0;if(void 0===a)throw new Error("No description provided");if(0===Object.keys(a).length||void 0===a.sdp||"string"!=typeof a.sdp)throw new Error("Invalid description provided");if(void 0===a.type)throw new Error("No type provided");return void 0!==e&&(O=e),L=a.sdp,M=a.type,N=d.parse(L),{getParsedSdp:t,usingMinimalSdp:u,getOriginal:v,getMinimal:w,getDescription:x,hasICECandidates:C,isHoldSdp:D,isResumeSdp:E,isHeldSdp:F,isUpgradeSdp:G,isDowngradeSdp:H,setupActivePassive:f,setupPassive:g,createInactiveSdp:h,createResumeSdp:i,modifyForConnect:y,modifyForConnectFCD:z,modifyForAcceptOffer:A,modifyForSetAudioCodec:B,removeSSRCS:I,removeSSRCSForTransfer:J,replaceUFragPwd:K}}var b=ATT.utils,c=ATT.logManager.createLogger("sdp"),d=ATT.sdpParser.getInstance();if(void 0===ATT["private"].factories)throw new Error("Error exporting `ATT.private.factories.createSdp`");ATT["private"].factories.createSdp=a}(),function(){"use strict";function a(a){function g(a,b){f.logDebug("ATT.rtc.Call: publishError");var c;"object"==typeof a&&a.hasOwnProperty("ErrorCode")?(c=a,a=c.ErrorCode):"object"==typeof b&&b.hasOwnProperty("ErrorCode")?(c=b,a=c.ErrorCode,b=void 0):"string"==typeof a?c=Da.getSDKError(a):a instanceof Error&&(b=a,c=Da.getSDKError("0000"),a="0000"),void 0===c&&(b=new Error("TODO: Error with error code "+a+" is not defined in the SDK error dictionary"),a="0001",c=Da.getSDKError(a)),void 0!==b&&(b instanceof Error?c.AdditionalInformation=b.message:"string"==typeof b?c.AdditionalInformation=b:c.AdditionalInformation=JSON.stringify(b)),f.logInfo("Publishing SDK error "+a),Ba.publish("error",c)}function h(){var a={index:fa,timestamp:new Date,callType:ka,mediaType:ia};return void 0!==ya&&(a.codec=ya),void 0!==ma&&(a.downgrade=ma),ja===c.CALL_TYPE.OUTGOING?a.to=ea:ja===c.CALL_TYPE.INCOMING&&(a.from=ea),null!==Ga&&(a.generator=Ga?"initiator":"receiver"),null!==Fa&&(a.operation=Fa),Object.keys(oa).length>0&&(a.invitations=oa),Object.keys(pa).length>0&&(a.participants=pa),a}function i(a){f.logDebug("ATT.rtc.Call: toggleLocalAudio");var b;null!==sa&&(b=sa.getAudioTracks(),b.forEach(function(b){b.enabled=a}))}function j(a){f.logDebug("ATT.rtc.Call: toggleLocalVideo");var b;null!==sa&&(b=sa.getVideoTracks(),b.forEach(function(b){b.enabled=a}))}function k(){f.logDebug("ATT.rtc.Call: disableLocalMedia"),i(!1),j(!1)}function l(){f.logDebug("ATT.rtc.Call: enableLocalMedia"),i(!xa),j(!0)}function m(){var a,b,c,d;return sa&&(b=sa.getTracks()),b&&0<b.length&&b.forEach(function(a){"audio"===a.kind&&(a.enabled||xa)?c=!0:"video"===a.kind&&a.enabled&&(d=!0)}),a=c||d?c&&!d?"audio":c&&d?"video":"unsupported":"nomedia"}function n(){void 0!==ha&&ha.addStream(sa),ia=m()}function o(){l(),ia=m()}function p(){void 0!==ha&&ha.removeStream(sa),ia=m()}function q(){k(),ia=m()}function r(a){f.logDebug("previousState call state:"+ua),f.logDebug("New call state:"+a),ua=va,va=a,ua!==va&&Ba.publish("state-changed",ATT.utils.extend(h(),{oldState:ua,newState:va}))}function s(a){r(a),Ba.publish(a,h())}function t(a){f.logDebug("Call: Adding local stream"),f.logTrace("Local stream ID",a.id),sa=a,i(!xa),n()}function u(a){null!==sa&&sa.id===a.id&&(f.logDebug("Call: Removing local stream"),f.logTrace("Local stream ID",a.id),p(),sa=null)}function v(a,b){var c,d,e,f=na.invitations();for(c in f)f.hasOwnProperty(c)&&(d=f[c],a===d.id&&(e=d.invitee,pa[e]={participant:e,status:b},Ba.publish("invite-accepted",h())))}function w(a,b,c){oa[a]={invitee:a,id:b,status:c}}function x(a,b){var c,d,e,f=na.invitations();for(c in f)f.hasOwnProperty(c)&&(d=f[c],a===d.id&&(e=d.invitee,oa[e].status=b))}function y(a){return a.toString(),a.indexOf("tel")>-1?a.split("+")[1]:a.indexOf("sip")>-1?a.split(":")[1].split("@")[0]:a}function z(){setTimeout(function(){Fa=null,Ga=null},5)}function A(a){f.logDebug("ATT.rtc.Call: modifyCall"),f.logInfo("Trying to send modify call request"),f.logTrace("description",a),Ca.modifyCall({description:a,callId:da,breed:ka,sessionId:la.sessionId,token:la.token,onSuccess:function(){f.logDebug("modifyCall: onSuccess"),f.logInfo("Successfully sent media modification."),r("modification-initiated"),Ba.publish("modification-in-progress",h())},onError:function(a){f.logDebug("modifyCall: onError"),f.logError("Failed to send media modification"),f.logTrace("error",a),g(a)}})}function B(a){f.logDebug("ATT.rtc.Call: acceptMediaModifications"),f.logInfo("Trying to send accept media modification request"),f.logTrace("description",a),Ca.acceptMediaModifications({sessionId:la.sessionId,token:la.token,callId:da,breed:ka,sdp:a.sdp,modId:null!==Ea?Ea.modId:null,onSuccess:function(){f.logDebug("acceptMediaModification: onSuccess"),f.logInfo("Successfully accepted media modification."),r("modification-accepted"),Ea=null},onError:function(a){f.logDebug("acceptMediaModification: onError"),f.logError("Error accepting media modification"),f.logTrace("error",a),g(a),Ea=null}})}function C(a){var b,c,d;return f.logDebug("Event: onModReceived"),f.logTrace("modificationId",a.modificationId),f.logTrace("remoteSdp",a.remoteSdp),Ga=!1,Ea={modId:a.modificationId,mediaType:a.mediaType},c=na.localSdp().getDescription(),f.logTrace("localDescription",c),void 0===a.remoteSdp?(f.logInfo("No remote sdp, accepting media modifications"),void B(c)):(f.logInfo("Remote sdp exists"),na.setRemoteSdp({sdp:a.remoteSdp,type:"offer"}),na.remoteSdp().modifyForAcceptOffer(),na.remoteSdp().isHoldSdp()?na.remoteSdp().removeSSRCS():na.remoteSdp().removeSSRCSForTransfer(),d=na.remoteSdp().getDescription(),void ha.setRemoteDescription(d,function(){return f.logDebug("peerConnection.setRemoteDescription: success"),f.logInfo("Remote description set successfully on receiving modifications"),"connected"===va&&("audio"===ia&&na.remoteSdp().isUpgradeSdp()||"video"===ia&&na.remoteSdp().isDowngradeSdp())?(f.logInfo("Call media modification received."),Fa="audio"===ia&&na.remoteSdp().isUpgradeSdp()?"upgrade":"video"===ia&&na.remoteSdp().isDowngradeSdp()?"downgrade":null,f.logTrace("modifications",Ea),b=h(),b.newMediaType=a.mediaType,void Ba.publish("media-modification",b)):(f.logInfo("Accepting SDP Offer"),Fa=!wa&&na.remoteSdp().isHoldSdp()?"hold":wa&&na.remoteSdp().isResumeSdp()?"resume":null,void ha.generateAnswer({constraints:{OfferToReceiveAudio:!wa,OfferToReceiveVideo:!wa&&"video"===ia},onAnswerReady:function(a){f.logDebug("generateAnswer: onAnswerReady"),f.logInfo("Successfully generated SDP answer"),na.setLocalSdp(a),c=na.localSdp().getDescription(),f.logTrace("local description",c),B(c)},onError:function(a){f.logDebug("peerConnection.generateAnswer: error"),f.logError("Error during accept sdp offer on peer connection"),f.logTrace(a),g(a)}}))},function(a){f.logDebug("peerConnection.setRemoteDescription: error"),f.logError("Error setting remote description on receiving modifications"),f.logTrace(a),g(a)}))}function D(a){f.logDebug("Event: onModTerminated"),f.logTrace("type",a.type),f.logTrace("reason",a.reason);var b,d;if(f.logInfo("Media modification terminated"),"success"===a.reason){if(f.logInfo("Media modification successful"),void 0===a.remoteSdp){if(f.logInfo("No remote SDP"),Ga=!1,"modification-accepted"===va&&("connected"===ua?na.localSdp().isHeldSdp()?(f.logInfo("Call is held."),wa=!0,r("connected"),Ba.publish("held",h())):wa===!0&&na.localSdp().isResumeSdp()?(r("connected"),Ba.publish("resumed",h())):(f.logInfo("Call is connected."),wa=!1,r("connected")):"held"===ua?na.localSdp().isHeldSdp()?(f.logInfo("Call is held."),wa=!0,s("held")):(f.logInfo("Call is held."),wa=!1,s("held")):wa?na.localSdp().isHoldSdp()?(f.logInfo("Call is resumed."),wa=!1,r("held"),Ba.publish("resumed",h())):na.localSdp().isResumeSdp()&&(f.logInfo("Call is resumed."),wa=!1,r("connected"),Ba.publish("resumed",h())):(f.logInfo("Call is connected."),r("connected")),z()),"conference"===a.type){if(void 0!==a.modificationId)return f.logInfo("Conference: invitation-accepted"),void v(a.modificationId,"active");return}return}return Ga=!0,f.logInfo("Remote SDP exists"),d=ha.hasLocalOffer()?"answer":"offer",na.setRemoteSdp({sdp:a.remoteSdp,type:d}),na.remoteSdp().isHoldSdp()?na.remoteSdp().removeSSRCS():na.remoteSdp().removeSSRCSForTransfer(),c.CALL_TYPE.INCOMING===ja&&("audio"===ia?"audio"===a.mediaType?na.remoteSdp().setupPassive("audio"):"video"===a.mediaType&&na.remoteSdp().setupPassive():"video"===ia?"video"===a.mediaType?"held"===ua?na.remoteSdp().setupPassive():na.remoteSdp().setupPassive("audio"):"audio"===a.mediaType&&na.remoteSdp().setupPassive("audio"):"nomedia"===ia&&"nomedia"===a.mediaType&&na.remoteSdp().setupPassive()),b=na.remoteSdp().getDescription(),void ha.setRemoteDescription(b,function(){f.logDebug("peerConnection.setRemoteDescription: onSuccess"),f.logInfo("Successfully set remote description."),"modification-initiated"===va&&("connected"===ua&&na.localSdp().isHoldSdp()?(f.logInfo("Call is on hold."),s("held")):"held"===ua&&na.localSdp().isResumeSdp()?(f.logInfo("Call is resumed."),r("connected"),Ba.publish("resumed",h())):(f.logInfo("Call is connected."),r("connected")),z())},function(a){f.logDebug("peerConnection.setRemoteDescription: onError"),f.logError("Failed to set the remote description."),f.logTrace("error",a),g(a)})}if("Call rejected"!==a.reason)Ba.publish("notification",ATT.utils.extend(h(),{message:a.reason}));else if("conference"===a.type){if(void 0!==a.modificationId)return f.logInfo("Conference: invitation-rejected"),x(a.modificationId,"rejected"),void Ba.publish("rejected",h());return}}function E(a){return f.logDebug("att.call.js: onMoveTerminated"),f.logInfo("Move terminated"),f.logTrace("data",a),"success"!==a.reason?(r("move-failed"),f.logError("Move failed"),void g(new Error("There was an error moving the call. Reason: "+a.reason))):(f.logInfo("Move success"),void r("move-initiated"))}function F(a){if(f.logDebug("onSessionOpen"),f.logTrace("data",a),a.mediaType&&("audio"===a.mediaType&&"video"===ia&&(ma=!0,j(!1)),ia=a.mediaType),a.provisionalSdp||s("connected"),void 0!==a.remoteSdp){f.logTrace("Remote SDP",a.remoteSdp);var b={sdp:a.remoteSdp,type:"answer"};na.setRemoteSdp(b),na.remoteSdp().removeSSRCS(),b=na.remoteSdp().getDescription(),ha.setRemoteDescription(b,function(){f.logDebug("peerConnection.setRemoteDescription: success"),f.logDebug("Successfully set remote description on peer connection")},function(a){f.logDebug("peerConnection.setRemoteDescription: error"),f.logError("Error during set remote description on peer connection"),f.logTrace(a),g(a)})}}function G(a){f.logDebug("onSessionModified");var b,c,d;return"connecting"===va?s("connected"):"move-initiated"===va?s("moved"):"move-failed"===va?(r("connected"),1===ATT["private"].holdResumeOpt?n():o()):r("connected"),void 0===a.remoteSdp?void f.logInfo("No Remote SDP"):(f.logInfo("Remote SDP exists"),f.logTrace("Remote SDP",a.remoteSdp),d=ha.hasLocalOffer()?"answer":"offer",c={sdp:a.remoteSdp,type:d},na.setRemoteSdp(c),ha.isStateStable()&&na.remoteSdp().modifyForAcceptOffer(),c=na.remoteSdp().getDescription(),void ha.setRemoteDescription(c,function(){f.logDebug("peerConnection.setRemoteDescription: onSuccess"),f.logDebug("Successfully set remote description on peer connection"),ha.hasRemoteOffer()&&ha.generateAnswer({constraints:{OfferToReceiveAudio:!0,OfferToReceiveVideo:"video"===ia},onAnswerReady:function(a){f.logDebug("generateAnswer: onAnswerReady"),f.logInfo("Successfully generated SDP answer"),na.setLocalSdp(a),b=na.localSdp().getDescription(),f.logTrace("local description",b)},onError:function(a){f.logDebug("peerConnection.generateAnswer: error"),f.logError("Error during accept sdp offer on peer connection"),f.logTrace(a),g(a)}})},function(a){f.logDebug("peerConnection.setRemoteDescription: onError"),f.logError("Error during set remote description on peer connection"),f.logTrace(a),g(a)}))}function H(){f.logDebug("att.call.js: onTransferInitiated"),f.logInfo("Transfer initiated successfully"),s("transferring")}function I(a){return f.logDebug("att.call.js: onTransferTerminated"),f.logInfo("Transfer terminated"),f.logTrace("data",a),"success"!==a.reason?void g(new Error("There was an error transferring the call. "+a.reason)):void s("transferred")}function J(a){f.logDebug("onSessionTerminated"),f.logTrace(a);var b;void 0!==a?"Call rejected"===a.reason||Aa?s("rejected"):"Call canceled"===a.reason||za?s("canceled"):void 0!==a.reason?(r("disconnected"),b=h(),b.message=a.reason,Ba.publish("disconnected",b)):s("created"===va?"canceled":"disconnected"):s("disconnected"),Ca.off(c.API_EVENT.SESSION_OPEN+":"+da,F),Ca.off(c.API_EVENT.SESSION_MODIFIED+":"+da,G),Ca.off(c.API_EVENT.SESSION_TERMINATED+":"+da,J),Ca.off(c.API_EVENT.MODIFICATION_RECEIVED+":"+da,C),Ca.off(c.API_EVENT.MODIFICATION_TERMINATED+":"+da,D),Ca.off(c.API_EVENT.MOVE_TERMINATED+":"+da,E),Ca.off(c.API_EVENT.TRANSFER_INITIATED+":"+da,H),Ca.off(c.API_EVENT.TRANSFER_TERMINATED+":"+da,I),void 0!==ha&&(ha.close(),ha=void 0)}function K(){f.logDebug("ATT.rtc.Call: registerForRTCEvents"),Ca.on(c.API_EVENT.SESSION_OPEN+":"+da,F),Ca.on(c.API_EVENT.SESSION_MODIFIED+":"+da,G),Ca.on(c.API_EVENT.SESSION_TERMINATED+":"+da,J),Ca.on(c.API_EVENT.MODIFICATION_RECEIVED+":"+da,C),Ca.on(c.API_EVENT.MODIFICATION_TERMINATED+":"+da,D),Ca.on(c.API_EVENT.MOVE_TERMINATED+":"+da,E),Ca.on(c.API_EVENT.TRANSFER_INITIATED+":"+da,H),Ca.on(c.API_EVENT.TRANSFER_TERMINATED+":"+da,I)}function L(a){return f.logDebug("ATT.rtc.Call: setId"),f.logInfo("Setting the call id"),f.logTrace("setId",a),da=a,null===da?(f.logInfo("Null call Id"),void s("disconnected")):void s("connecting")}function M(a){if(f.logDebug("ATT.rtc.Call: setLocalSdp"),f.logTrace("description",a),void 0===a)throw new Error("No local description provided");if("object"!=typeof a||0===Object.keys(a).length||void 0===a.sdp)throw new Error("Invalid local description provided");qa=b.createSdp(a)}function N(a){if(f.logDebug("ATT.rtc.Call: setRemoteSdp"),f.logTrace("description",a),void 0===a)throw new Error("No remote description provided");if("object"!=typeof a||0===Object.keys(a).length||void 0===a.sdp)throw new Error("Invalid remote description provided");ra=b.createSdp(a),ya=d.getCodecFromSdp(a.sdp),f.logTrace("codec",ya)}function O(a,b){if(f.logDebug("ATT.rtc.Call: on"),f.logInfo("Subscribing to call event: "+a),"connecting"!==a&&"response-pending"!==a&&"invite-accepted"!==a&&"participant-removed"!==a&&"canceled"!==a&&"rejected"!==a&&"connected"!==a&&"muted"!==a&&"unmuted"!==a&&"stream-added"!==a&&"error"!==a&&"held"!==a&&"resumed"!==a&&"disconnecting"!==a&&"disconnected"!==a&&"notification"!==a&&"moved"!==a&&"transferring"!==a&&"transferred"!==a&&"modification-in-progress"!==a&&"state-changed"!==a&&"media-modification"!==a&&"tone-sending"!==a&&"tone-sent"!==a)throw new Error("Event "+a+" not defined");Ba.unsubscribe(a,b),Ba.subscribe(a,b,this)}function P(a,b){f.logDebug("ATT.rtc.Call: off"),f.logInfo("Unsubscribing from call event: "+a),Ba.unsubscribe(a,b)}function Q(){function a(a){f.logInfo("Offer is ready"),na.setLocalSdp(a),A(na.localSdp().getDescription())}function d(a){f.logInfo("Answer is ready"),na.setLocalSdp(a),B(na.localSdp().getDescription())}function e(){f.logDebug("createPeerConnection: onSuccess");try{if(za)return f.logInfo("Call is being canceled..."),za=!1,void J({reason:"Call canceled"});na.setLocalSdp(ha.getLocalDescription()),j=na.localSdp().getDescription(),f.logTrace("Call.connect SDP",j),l={sessionId:la.sessionId,token:la.token,description:j,breed:ka,onSuccess:function(a){f.logDebug("connectCall: onSuccess"),f.logInfo("Success during connectCall"),f.logTrace(a),c.CALL_TYPE.INCOMING===ja?s("connecting"):(L(a.id),K())},onError:function(a){f.logDebug("connectCall: onError"),f.logError("Error during connectCall"),f.logTrace(a),g(a)}},void 0!==da&&null!==da&&(l.callId=da),"call"===ka&&(l.peer=ea),f.logInfo("Peer Connection created. Connecting now.."),Ca.connectCall(l)}catch(a){f.logError("Error during connectCall"),f.logTrace("error",a),g(a)}}f.logDebug("Call: connect");var h,i,j,k,l;return null!==na.remoteSdp()&&(na.remoteSdp().modifyForConnectFCD(),na.remoteSdp().removeSSRCS(),k=na.remoteSdp().getDescription()),void 0!==ha&&null!==ha?(f.logInfo("Peer connection exists"),null===Ea||void 0===Ea?(f.logInfo("The call mediaType is: "+ia),Fa="video"===ia?"upgrade":"downgrade",Ga=!0,i={constraints:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},onOfferCreated:function(a){return f.logDebug("peerConnection.generateOffer: onOfferCreated"),f.logInfo("Successfully created SDP offer"),f.logTrace("description",a),a},onOfferReady:a,onError:function(a){f.logError("peerConnection.generateOffer: onError"),f.logTrace("error",a),g(a)}},f.logInfo("Trying to initiate media modification"),f.logTrace("generateOfferOptions",i),void ha.generateOffer(i)):(f.logInfo("Media modifications exists"),f.logTrace("modifications",Ea),f.logInfo("The current call state is: "+va),"connected"===va?(f.logInfo("The call mediaType is: "+ia),i={constraints:{OfferToReceiveAudio:!0,OfferToReceiveVideo:"video"===Ea.mediaType},onAnswerCreated:function(a){return f.logDebug("peerConnection.generateOffer: onAnswerCreated"),f.logInfo("Successfully created SDP answer"),f.logTrace("description",a),a},onAnswerReady:d,onError:function(a){f.logError("peerConnection.generateAnswer: onError"),f.logTrace("error",a),g(a)}},f.logInfo("Trying to accept media modification"),f.logTrace("generateAnswerOptions",i),void ha.generateAnswer(i)):void f.logWarning("Connect for accept media modifications called in wrong state: "+va))):(h={pcConfiguration:ga,mediaType:ia,stream:sa,remoteSdp:k,onSuccess:e,onError:function(a){f.logDebug("createPeerConnection: onError"),f.logError("Error creating peer connection"),f.logTrace(a),g(a)},onRemoteStream:function(a){f.logDebug("createPeerConnection: onRemoteStream"),f.logInfo("Remote stream playing"),f.logTrace(a),ta=a,Ba.publish("stream-added",{stream:a})}},f.logInfo("Trying to create a peer connection..."),f.logTrace("options",h),void(ha=b.createPeerConnection(h)))}function R(a){f.logDebug("ATT.rtc.Call: addParticipant"),f.logInfo("adding participant..."),f.logTrace(a);try{Ca.addParticipant({sessionInfo:la,invitee:a,confId:da,onSuccess:function(b){f.logDebug("rtcManager.addParticipant: onSuccess"),f.logInfo("Successfully added participant"),f.logTrace(b),w(y(a),b,"invited"),Ba.publish("response-pending",h())},onError:function(a){f.logDebug("rtcManager.addParticipant: onError"),f.logError("Error adding participant"),f.logTrace(a),g(a)}})}catch(b){f.logError("Error adding participant"),f.logTrace(b),g(b)}}function S(a){f.logDebug("ATT.rtc.Call: removeParticipant"),f.logTrace(a);try{Ca.removeParticipant({sessionInfo:la,participant:a,confId:da,onSuccess:function(){f.logDebug("rtcManager.removeParticipant: onSuccess"),f.logInfo("Successfully removed participant"),delete na.participants()[a],Ba.publish("participant-removed",h())},onError:function(a){f.logDebug("rtcManager.removeParticipant: onError"),f.logError("Error removing participant"),f.logTrace(a),g(a)}})}catch(b){f.logError("Error removing participant"),f.logTrace(b),g(b)}}function T(){if(f.logDebug("ATT.rtc.Call: disconnect"),na.on("error",J),"created"===va||"connecting"===va){if(f.logInfo("Canceling call.."),za=!0,null===da)return void f.logInfo("Call connecting not completed yet");
f.logInfo("Call connecting completed. Sending cancel request"),Ca.cancelCall({callId:da,breed:ka,sessionId:la.sessionId,token:la.token,onSuccess:function(){f.logDebug("cancelCall: success"),f.logInfo("Successfully canceled call")},onError:function(a){f.logDebug("cancelCall: onError"),f.logError("Error canceling call"),f.logTrace(a),g(a)}})}else null!==da&&(f.logInfo("Disconnecting call..."),s("disconnecting"),Ca.disconnectCall({sessionId:la.sessionId,breed:ka,token:la.token,callId:da,onSuccess:function(){f.logDebug("disconnectCall: onSuccess"),f.logInfo("Successfully disconnected call")},onError:function(a){f.logDebug("disconnectCall: onError"),f.logError("Error disconnecting call"),f.logTrace(a),g(a)}}))}function U(){f.logDebug("ATT.rtc.Call: disconnectConference"),f.logInfo("Disconnecting Conference..."),s("disconnecting"),Ca.disconnectCall({sessionId:la.sessionId,token:la.token,breed:"conference",callId:da,onSuccess:function(){f.logDebug("disconnectCall: onSuccess"),f.logInfo("Successfully disconnected conference")},onError:function(a){f.logDebug("disconnectCall: onError"),f.logError("Error disconnecting conference"),f.logTrace(a),g(a)}})}function V(a){var b=!1;if(f.logDebug("ATT.rtc.Phone: validOperation"),f.logTrace("Operation",a),f.logTrace("State",va),!Ha.hasOwnProperty(a))throw new Error(a+" is not a valid operation");if(Ha[a].forEach(function(a){va===a&&(b=!0)}),!b)throw new Error("Cannot "+a+" call. The operation was called in invalid call state: "+va)}function W(){f.logDebug("ATT.rtc.Call: mute"),f.logInfo("Muting call...");try{i(!1),xa=!0,Ba.publish("muted",h())}catch(a){f.logError("Error muting call"),f.logTrace(a),g(a)}}function X(){f.logDebug("ATT.rtc.Call: unmute"),f.logInfo("Unmuting call...");try{i(!0),xa=!1,Ba.publish("unmuted",h())}catch(a){f.logError("Error unmuting call"),f.logTrace(a),g(a)}}function Y(a){var c,d;Fa=a,Ga=!0,f.logInfo("Creating offer for "+a),1===ATT["private"].holdResumeOpt?p():q(),ha.generateOffer({constraints:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1},onOfferCreated:function(a){return f.logDebug("peerConnection.generateOffer: onOfferCreated"),wa&&(a=b.createSdp(a).createInactiveSdp().getDescription()),a},onOfferReady:function(b){return f.logDebug("peerConnection.generateOffer: onOfferReady"),na.setLocalSdp(b),d=na.localSdp().getDescription(),f.logTrace("localSDP",d),c={description:d,sessionId:la.sessionId,token:la.token,breed:ka,callId:da,onSuccess:function(){f.logDebug(a+"Call: onSuccess"),f.logInfo("Successfully sent offer for "+a+" call"),r("modification-initiated"),Ba.publish("modification-in-progress",h())},onError:function(b){f.logDebug(a+"Call: onError"),f.logInfo("Error sending offer for "+a+" call"),f.logTrace(b),g(b)}},"move"===a?void Ca.moveCall(c):void Ca.holdCall(c)},onError:function(a){f.logDebug("peerConnection.createSdpOffer: onError"),f.logInfo("Error during create sdp offer"),f.logTrace(a),g(a)}})}function Z(){f.logDebug("ATT.rtc.Call: hold"),f.logInfo("Holding call..."),Y("hold")}function $(){f.logDebug("ATT.rtc.Call: move"),f.logInfo("Moving call..."),Y("move")}function _(){var a;f.logDebug("ATT.rtc.Call: resume"),f.logInfo("Creating offer for resume"),Fa="resume",Ga=!0,1===ATT["private"].holdResumeOpt?n():o(),ha.generateOffer({constraints:{OfferToReceiveAudio:!0,OfferToReceiveVideo:"video"===ia},onOfferCreated:function(a){return f.logDebug("peerConnection.generateOffer: onOfferCreated"),wa&&(a=b.createSdp(a).createResumeSdp().getDescription()),a},onOfferReady:function(b){f.logDebug("peerConnection.generateOffer: onOfferReady"),na.setLocalSdp(b),a=na.localSdp().getDescription(),f.logTrace("localDescription",a),Ca.resumeCall({description:a,sessionId:la.sessionId,token:la.token,callId:da,breed:ka,onSuccess:function(){f.logDebug("resumeCall: onSuccess"),f.logInfo("Successfully sent resume call offer"),r("modification-initiated"),Ba.publish("modification-in-progress",h())},onError:function(a){f.logDebug("resumeCall: onError"),f.logError("Error sending resume call offer"),f.logTrace(a),g(a)}})},onError:function(a){f.logDebug("peerConnection.createSdpOffer: onError"),f.logInfo("Error during create sdp offer"),f.logTrace(a),g(a)}})}function aa(){f.logDebug("ATT.rtc.Call: reject"),f.logInfo("Rejecting call..."),Aa=!0,Ca.rejectCall({callId:da,sessionId:la.sessionId,token:la.token,breed:ka,onSuccess:function(){f.logDebug("rejectCall: onSuccess"),f.logInfo("Successfully rejected the call")},onError:function(a){f.logDebug("rejectCall: onError"),f.logError("Error rejecting the call"),f.logTrace(a),g(a)}})}function ba(a){if(void 0===a||0===Object.keys(a).length)throw new Error("No options provided");if(void 0===a.input)throw new Error("No input provided");try{a.onToneSent=function(a){var b=h();b.tone=a.tone,b.timestamp=new Date(a.timeStamp),Ba.publish("tone-sent",b)},a.onToneSending=function(){Ba.publish("tone-sending",h())},ha.sendDTMFTone(a)}catch(b){f.logError("Error sending dtmf tone"),f.logTrace(b),g(b)}}function ca(a){if(f.logDebug("ATT.rtc.Call: transfer"),f.logInfo("Transferring call..."),f.logTrace(a),void 0===a||0===Object.keys(a).length||void 0===a.targetCallId)throw new Error("No targetCallId provided");Ca.transferCall({callId:da,breed:ka,sessionId:la.sessionId,token:la.token,targetCallId:a.targetCallId,transfereeSdp:na.remoteSdp().getDescription().sdp,success:function(){f.logDebug("transferCall: success"),f.logInfo("Successfully transferred the call"),"function"==typeof a.success&&a.success()},error:function(b){f.logDebug("transferCall: error"),f.logError("Error transferring the call"),f.logTrace(b),"function"==typeof a.error&&a.error(b)}})}f.logDebug("ATT.rtc.Call: Constructor");var da,ea,fa,ga,ha,ia,ja,ka,la,ma,na=this,oa={},pa={},qa=null,ra=null,sa=null,ta=null,ua=null,va=null,wa=!1,xa=!1,ya=[],za=!1,Aa=!1,Ba=b.createEventEmitter(),Ca=e.getRTCManager(),Da=ATT.errorDictionary,Ea=null,Fa=null,Ga=null,Ha={hold:["connected"],resume:["held"],move:["connected"],transfer:["held"],upgrade:["connected"],downgrade:["connected"],acceptMod:["connected","held"],rejectMod:["connected","held"],sendDTMFTone:["connected"]};if(void 0===a||0===Object.keys(a).length)throw new Error("No input provided");if(void 0===a.breed)throw new Error("No breed provided");if("call"===a.breed&&void 0===a.peer)throw new Error("No peer provided");if(void 0===a.type)throw new Error("No type provided");if(void 0===a.mediaType)throw new Error("No mediaType provided");if(void 0===a.pcConfiguration)throw new Error("No peer connection configuration provided");ka=a.breed,void 0===a.id?da=null:(da=a.id,K()),va="created",ea=a.peer,fa=a.index,ia=a.mediaType,ja=a.type,la=a.sessionInfo,ga=a.pcConfiguration,this.index=function(){return fa},this.pcConfiguration=function(){return ga},this.peer=function(){return ea},this.codec=function(){return ya},this.mediaType=function(){return ia},this.type=function(){return ja},this.breed=function(){return ka},this.state=function(){return va},this.held=function(){return wa},this.muted=function(){return xa},this.participants=function(){return pa},this.invitations=function(){return oa},this.sessionInfo=function(){return la},this.id=function(){return da},this.localSdp=function(){return qa},this.remoteSdp=function(){return ra},this.localStream=function(){return sa},this.remoteStream=function(){return ta},this.canceled=function(){return za},this.rejected=function(){return Aa},this.modifications=function(){return Ea},this.on=O,this.off=P,this.createEventData=h,this.setId=L,this.setLocalSdp=M,this.setRemoteSdp=N,this.addStream=t,this.removeStream=u,this.validateOperation=V,this.connect=Q,this.disconnect=T,this.disconnectConference=U,this.addParticipant=R,this.removeParticipant=S,this.mute=W,this.unmute=X,this.hold=Z,this.resume=_,this.move=$,this.reject=aa,this.transfer=ca,this.sendDTMFTone=ba,a.test&&(this.operation=function(){return Fa},this.generator=function(){return Ga},this.setState=r,this.setHeld=function(a){wa=a},this.setModifications=function(a){Ea=a},this.setOperation=function(a){Fa=a})}var b=ATT["private"].factories,c=ATT["private"]["enum"],d=ATT.utils,e=ATT["private"].rtcManager,f=ATT.logManager.createLogger("call");if(f.logDebug("Loading att.rtc.call..."),ATT["private"].holdResumeOpt=2,void 0===ATT.rtc)throw new Error("Cannot export Call. ATT.rtc is undefined");ATT.rtc.Call=a}(),function(){"use strict";function a(){function a(a,b){e.logDebug("ATT.rtc.Session: publishError");var c;"object"==typeof a&&a.hasOwnProperty("ErrorCode")?(c=a,a=c.ErrorCode):"object"==typeof b&&b.hasOwnProperty("ErrorCode")?(c=b,a=c.ErrorCode,b=void 0):"string"==typeof a?c=o.getSDKError(a):a instanceof Error&&(b=a,c=o.getSDKError("0000"),a="0000"),void 0===c&&(b=new Error("TODO: Error with error code "+a+" is not defined in the SDK error dictionary"),a="0001",c=o.getSDKError(a)),void 0!==b&&(b instanceof Error?c.AdditionalInformation=b.message:"string"==typeof b?c.AdditionalInformation=b:c.AdditionalInformation=JSON.stringify(b)),e.logInfo("Publishing SDK error "+a),l.publish("error",c)}function g(a){e.logDebug("ATT.rtc.Session: onInvitationReceived"),e.logInfo("On getting invitation"),e.logTrace("Call information",a);var b,d,f;return null!==n.pendingCall?void l.publish("notification",{from:a.from,mediaType:a.mediaType,type:a.type,timestamp:new Date,message:"Can only handle one incoming call at a time; ignoring the second incoming call."}):Object.keys(r).length>=2?void l.publish("notification",{from:a.from,mediaType:a.mediaType,type:a.type,timestamp:new Date,message:"Two calls already in progress, unable to handle a third incoming call."}):(d=n.createCall({breed:a.type,id:a.id,peer:a.from,type:c.CALL_TYPE.INCOMING,mediaType:a.mediaType}),void(void 0!==d&&(a.sdp&&(f=a.sdp,d.setRemoteSdp({sdp:f,type:"offer"})),b="call"===d.breed()?"call:incoming":"conference-invite",l.publish(b,{from:d.peer(),mediaType:d.mediaType(),codec:d.codec(),timestamp:new Date}))))}function h(a,b){e.logDebug("ATT.rtc.Session: off"),e.logTrace("Un-subscribing from event:",a),l.unsubscribe(a,b)}function i(a,b){if(e.logDebug("ATT.rtc.Session: on"),e.logTrace("Subscribing to session event: ",a),"ready"!==a&&"connecting"!==a&&"connected"!==a&&"updating"!==a&&"needs-refresh"!==a&&"notification"!==a&&"call:incoming"!==a&&"conference-invite"!==a&&"call:switched"!==a&&"disconnecting"!==a&&"disconnected"!==a&&"address-updated"!==a&&"all-calls-terminated"!==a&&"error"!==a)throw e.logError("Event "+a+" not defined"),new Error("Event "+a+" not defined");l.unsubscribe(a,b),l.subscribe(a,b,this)}function j(){var a,b=0;for(a in r)r.hasOwnProperty(a)&&b<r[a].index()&&(b=r[a].index());return b}function k(a,b){var c={to:b.createEventData(),timestamp:new Date};null!==a&&(c.from=a.createEventData()),l.publish("call:switched",c)}e.logDebug("ATT.rtc.Session: Constructor");var l,m,n=this,o=ATT.errorDictionary,p=null,q=null,r={};l=b.createEventEmitter(),m=d.getRTCManager(),this.timeout=null,this.e911Id=null,this.pendingCall=null,this.currentCall=null,this.timer=null,this.getSupportedAudioCodecs=function(){return f.getSupportedAudioCodecs()},this.getPCConfiguration=function(){return f.getPCConfiguration()},this.setPCConfiguration=function(a){f.setPCConfiguration(a)},this.resetPCConfiguration=function(a){f.resetPCConfiguration(a)},this.on=i.bind(this),this.off=h.bind(this),this.getToken=function(){return e.logDebug("ATT.rtc.Session: getToken"),e.logInfo("Getting the token"),e.logTrace("Token",q),q},this.getId=function(){return e.logDebug("ATT.rtc.Session: getId"),e.logInfo("Getting the session id"),e.logTrace("getId-Session Id",p),p},this.setId=function(a){return e.logDebug("ATT.rtc.Session: setId"),e.logInfo("Setting the session Id"),e.logTrace("setId-Session Id",a),p=a,null===a?(e.logInfo("Null session Id"),void l.publish("disconnected")):void l.publish("connected")},this.update=function(b){if(e.logDebug("ATT.rtc.Session: update"),e.logInfo("Updating the session object"),e.logTrace("update-options",b),void 0===b)throw e.logError("No options provided"),new Error("No options provided");if(void 0!==b.timeout&&"number"!=typeof b.timeout)throw e.logError("Error invalid Timeout"),new Error("Timeout is not a number.");l.publish("updating",b),q=b.token||q,this.e911Id=b.e911Id||this.e911Id,e.logDebug("Updating the session object successfully"),void 0!==b.timeout&&(b.timeout<6e4?this.timeout=b.timeout:this.timeout=b.timeout-6e4,null!==this.timer&&clearInterval(this.timer),this.timer=setInterval(function(){l.publish("needs-refresh"),m.refreshSession({sessionId:p,token:q,success:function(){e.logDebug("refreshSession: success"),e.logInfo("Successfully refreshed the session")},error:function(b){e.logDebug("refreshSession: error"),e.logInfo("Error refreshing the session"),e.logTrace(b),a(b)}})},this.timeout))},this.connect=function(b){if(e.logDebug("ATT.rtc.Session: connect"),e.logTrace("connect-options",b),void 0===b||0===Object.keys(b).length)throw new Error("No options provided");if(void 0===b.token)throw new Error("No token provided");q=b.token,this.e911Id=b.e911Id,l.publish("connecting"),n=this,e.logInfo("Connect the session"),m.connectSession({token:b.token,e911Id:b.e911Id,onSessionConnected:function(a){e.logDebug("connectSession: onSessionConnected"),e.logTrace("Session Information",a),n.setId(a.sessionId),n.update({timeout:a.timeout})},onSessionReady:function(a){a.timeStamp=new Date,e.logDebug("connectSession: onSessionReady"),e.logTrace("onSessionReady-data",a),l.publish("ready",a),m.on("invitation-received:"+p,g)},onError:function(b){e.logDebug("connectSession: onError"),e.logError("Error during connectSession"),e.logError("Error during connectSession"),e.logTrace("connectSession: error",b),a("2000",b)}})},this.disconnect=function(){e.logDebug("ATT.rtc.Session: disconnect"),l.publish("disconnecting"),clearInterval(this.timer),e.logInfo("Disconnect the session"),m.disconnectSession({sessionId:n.getId(),token:n.getToken(),e911Id:n.e911Id,onSessionDisconnected:function(){e.logDebug("disconnectSession: onSessionDisconnected"),n.setId(null)},onError:function(b){e.logDebug("disconnectSession: onError"),e.logError("Error during disconnectSession"),e.logTrace("disconnectSession: error",b),n.setId(null),a("3000",b)}})},this.addCall=function(a){e.logDebug("ATT.rtc.Session: addCall"),e.logInfo("Adding a call in the calls array"),e.logTrace("callId",a.id()),e.logTrace("Before",r),r[a.id()]=a,e.logTrace("After",r)},this.createCall=function(a){e.logDebug("ATT.rtc.Session: createCall"),e.logInfo("Creating a new call"),e.logTrace("CreateCall-options",a);var b=new ATT.rtc.Call(ATT.utils.extend(a,{pcConfiguration:f.getPCConfiguration(),index:j()+1,sessionInfo:{sessionId:this.getId(),token:this.getToken()}}));return e.logTrace("call.peer()",b.peer()),e.logTrace("call object",b),b.on("connected",function(){e.logDebug("call.on: connected"),null!==n.currentCall&&(e.logInfo("Switching the calls..."),e.logTrace("From",n.currentCall.peer()),e.logTrace("To",n.pendingCall.peer()),k(n.currentCall,n.pendingCall)),n.currentCall=n.pendingCall,n.pendingCall=null,n.addCall(n.currentCall)}),b.on("error",function(){e.logDebug("call.on: error"),b===n.pendingCall&&(e.logInfo("Deleting pending call"),e.logTrace("session.pendingCall.peer",n.pendingCall.peer()),e.logTrace("session.pendingCall",n.pendingCall),n.pendingCall=null)}),this.pendingCall=b,e.logTrace("call.id",b.id()),e.logTrace("call object",b),b},this.getCall=function(a){return e.logDebug("ATT.rtc.Session: getCall"),e.logInfo("Getting call by id"),e.logTrace("callId",a),r[a]},this.getCalls=function(){return e.logDebug("ATT.rtc.Session: getCalls"),e.logInfo("Getting all calls"),e.logTrace("calls",Object.keys(r)),r},this.switchTo=function(a){if(e.logDebug("ATT.rtc.Session: switchTo"),e.logInfo("Switching to call by callId"),e.logTrace("callId",a),void 0===a)throw e.logError("You must pass a valid call id"),new Error("You must pass a valid call id");if(void 0===r[a])throw e.logError("Cannot find call with id "+a),new Error("Cannot find call with id "+a);r[a]!==this.currentCall&&(k(this.currentCall,r[a]),e.logInfo("Setting current call"),this.currentCall=r[a]),e.logTrace("currentCall.peer",this.currentCall.peer()),e.logTrace("currentCall",this.currentCall),"held"===this.currentCall.state()&&this.currentCall.autoresume&&(e.logInfo("resuming current call"),this.currentCall.resume(),this.currentCall.autoresume=!1)},this.terminateCalls=function(){e.logDebug("ATT.rtc.Session: terminateCalls"),e.logInfo("Terminating all the calls");var a;for(a in r)r.hasOwnProperty(a)&&(e.logTrace("callId",a),e.logTrace("call.peer",r[a].peer()),r[a].disconnect())},this.deleteCall=function(a){if(e.logDebug("ATT.rtc.Session: deleteCall"),e.logInfo("Deleting a call by callId"),e.logTrace("callId",a),void 0===r[a])throw e.logError("Call not found"),new Error("Call not found");e.logInfo("Call deleted with peer "+r[a].peer()),e.logTrace("Call deleted",r[a]),delete r[a],0===Object.keys(r).length&&(e.logInfo("All calls deleted from ATT.rtc.Session"),l.publish("all-calls-terminated"))},this.deletePendingCall=function(){e.logDebug("ATT.rtc.Session: deletePendingCall"),e.logInfo("Deleting pending call"),null!==this.pendingCall&&(e.logTrace("pendingCall.peer",this.pendingCall.peer()),e.logTrace("pendingCall",this.pendingCall),this.pendingCall=null)},this.deleteCurrentCall=function(){e.logDebug("ATT.rtc.Session: deleteCurrentCall"),e.logInfo("Deleting current call"),null!==this.currentCall&&(e.logTrace("currentCall.peer",this.currentCall.peer()),e.logTrace("currentCall",this.currentCall),this.deleteCall(this.currentCall.id()),this.currentCall=null)},this.associateToken=function(a){e.logDebug("ATT.rtc.Session: associateToken"),e.logInfo("Associating Token"),e.logTrace("associateToken.options",a),m.associateToken(a)},this.associateE911Id=function(b){e.logDebug("ATT.rtc.Session: associateE911Id"),e.logInfo("Associating E911 ID"),e.logTrace("associateE911Id.options",b),m.associateE911Id(ATT.utils.extend(b,{sessionId:this.getId(),token:this.getToken(),onSuccess:function(){e.logDebug("associateE911Id: onSuccess"),e.logInfo("Successfully associated E911 ID"),l.publish("address-updated",n.createEventData())},onError:function(b){e.logDebug("associateE911Id: onError"),e.logError("Error during associating E911 ID"),e.logTrace(b),a("2050",b)}}))},this.getVersion=function(){return f.getVersion()},this.createEventData=function(){var a={};return a.timestamp=new Date,null!==p&&(a.sessionId=p),a}}var b=ATT["private"].factories,c=ATT["private"]["enum"],d=ATT["private"].rtcManager,e=ATT.logManager.createLogger("session"),f=ATT["private"].config.app;if(e.logDebug("Loading att.rtc.session..."),void 0===ATT.rtc)throw new Error("Cannot export Session. ATT.rtc is undefined");ATT.rtc.Session=a}(),function(){"use strict";function a(a){function e(a,b){Va.push({event:a,data:b}),d.logInfo("Publishing event "+a),d.logTrace(a,b),Qa.publish(a,b)}function f(a,b){return a instanceof Error?void g("0000",a):(void 0!==b&&(b instanceof Error?a.AdditionalInformation=b.message:"string"==typeof b?a.AdditionalInformation=b:a.AdditionalInformation=JSON.stringify(b)),a.timeStamp=new Date,void e("error",a))}function g(a,b){d.logDebug("ATT.rtc.Phone: publishSDKError");var c=Sa.getSDKError(a);void 0===c&&(c=Sa.getSDKError("0001"),b=new Error("TODO: Error with error code "+a+" is not defined in the SDK error dictionary")),d.logInfo("Publishing SDK error "+a),f(c,b)}function h(a){return!(a instanceof HTMLMediaElement)}function i(a){void 0!==a.localMedia&&(Ta=a.localMedia),void 0!==a.localMedia&&(Ua=a.remoteMedia)}function j(a,b){var c;if("local"===a&&(c=Ta),"remote"===a&&(c=Ua),h(c))throw new Error("Failed to play "+a+" media as `"+a+"Media` element is not setup.");d.logInfo("Playing "+a+" media..."),c.src=window.URL.createObjectURL(b),c.play()}function k(a){j("local",a.local),j("remote",a.remote)}function l(a){var b;if("local"===a&&(b=Ta),"remote"===a&&(b=Ua),null!==b){if(h(b))throw new Error("Failed to stop "+a+" media as `"+a+"Media` element is not setup.");d.logInfo("Stopping "+a+" media..."),b.pause(),b.src=""}}function m(){l("local"),l("remote")}function n(a,b,c){getUserMedia({audio:!0,video:"video"===a},function(a){Pa=a,b.call(null,Pa)},c)}function o(){void 0!==Pa&&(d.logInfo("Releasing user media"),Pa.stop())}function p(a){return d.logDebug("ATT.rtc.Phone: onError"),d.logTrace("data",a),404===a.HttpStatusCode?(d.logError("session:expired by ATT.rtc.Phone"),void e("session:expired",Ra.createEventData())):502===a.HttpStatusCode||503===a.HttpStatusCode?(d.logError("gateway:unreachable by ATT.rtc.Phone"),void e("gateway:unreachable",Ra.createEventData())):(d.logError("error event by ATT.rtc.Phone"),void f(a))}function q(a){var b,c;return null!==Ra.pendingCall&&a.id()===Ra.pendingCall.id()||null!==Ra.currentCall&&a.id()===Ra.currentCall.id()?(d.logInfo("Foreground call event fired"),Ra.currentCall&&a.id()===Ra.currentCall.id()?(d.logInfo("Deleting current call"),Ra.deleteCurrentCall()):Ra.pendingCall&&a.id()===Ra.pendingCall.id()&&(d.logInfo("Deleting pending call"),d.logTrace(Ra.pendingCall.peer(),Ra.pendingCall),Ra.deletePendingCall()),b=Ra.getCalls(),c=Object.keys(b),m(),d.logInfo("Remaining calls: "+c.length),0===c.length?void o():(d.logInfo("Setting background call as current call"),void Ra.switchTo(c[0]))):(d.logInfo("Background call event fired"),d.logInfo("Deleting background call"),d.logTrace(a.peer(),a),Ra.deleteCall(a.id()),b=Ra.getCalls(),c=Object.keys(b),0===c.length?void m():void 0)}function r(a,b){return d.logDebug("call.on: disconnected"),a.off("disconnected",r),q(a),null!==Ra.currentCall&&Ra.currentCall.id()!==a.id()&&(b.background=!0),"conference"===a.breed()?(d.logInfo("conference:ended event by ATT.rtc.Phone"),d.logTrace("data",b),void e("conference:ended",b)):(d.logInfo("call:disconnected event by ATT.rtc.Phone"),d.logTrace("data",b),void e("call:disconnected",b))}function s(a,b){return a.off("canceled",s),q(a),"conference"===a.breed()?(d.logDebug("conference.on: canceled"),d.logInfo("conference:canceled event by ATT.rtc.Phone"),d.logTrace("data",b),void e("conference:canceled",b)):(d.logDebug("call.on: canceled"),d.logInfo("call:canceled event by ATT.rtc.Phone"),d.logTrace("data",b),void e("call:canceled",b))}function t(a,b){return a.off("rejected",t),("conference"!==a.breed()||c.CALL_TYPE.OUTGOING!==a.type())&&q(a),"conference"===a.breed()?(d.logDebug("conference.on: invitation-rejected"),d.logInfo("conference:invitation-rejected event by ATT.rtc.Phone"),d.logTrace("data",b),void e("conference:invitation-rejected",b)):(d.logDebug("call.on: rejected"),d.logInfo("call:rejected event by ATT.rtc.Phone"),d.logTrace("data",b),void e("call:rejected",b))}function u(a){d.logDebug("call.on: muted"),d.logInfo("call:muted event by ATT.rtc.Phone"),e("call:muted",a)}function v(a){d.logDebug("call.on: unmuted"),d.logInfo("call:unmuted event by ATT.rtc.Phone"),e("call:unmuted",a)}function w(a){var b=Ra.currentCall;return b.off("held",w),m(),"conference"===b.breed()?(d.logDebug("conference.on: held"),d.logInfo("conference:held event by ATT.rtc.Phone"),d.logTrace("data",a),void e("conference:held",a)):(d.logDebug("call.on: held"),d.logInfo("call:held event by ATT.rtc.Phone"),d.logTrace("data",a),void e("call:held",a))}function x(a){var b=Ra.currentCall;return k({local:b.localStream(),remote:b.remoteStream()}),b.off("resumed",x),"conference"===b.breed()?(d.logDebug("conference.on: resumed"),d.logInfo("conference:resumed event by ATT.rtc.Phone"),d.logTrace("data",a),void e("conference:resumed",a)):(d.logDebug("call.on: resumed"),d.logInfo("call:resumed event by ATT.rtc.Phone"),d.logTrace("data",a),void e("call:resumed",a))}function y(a){var b=Ra.currentCall;d.logDebug("call.on: moved"),d.logInfo("call:moved event by ATT.rtc.Phone"),d.logTrace("data",a),b.off("moved",y),m(),e("call:moved",a)}function z(a){d.logDebug("call.on: connected"),d.logInfo("call:connected event by ATT.rtc.Phone"),d.logTrace("data",a),e("call:connected",a)}function A(a,b){return d.logDebug("call.on: stream-added"),d.logTrace(b),j("remote",b.stream),"connecting"===a.state()&&"call"===a.breed()?(d.logInfo("Got early media"),d.logInfo("call:ringback-provided event by ATT.rtc.Phone"),void e("call:ringback-provided",a.createEventData())):"created"===a.state()?(d.logInfo("media:established event by ATT.rtc.Phone"),void e("media:established",a.createEventData())):void("connected"===a.state()&&(d.logInfo("media:established event by ATT.rtc.Phone"),e("media:established",a.createEventData())))}function B(a){d.logDebug("call.on: modification-in-progress"),d.logInfo("call:modification-in-progress event from Att.rtc.Phone"),d.logTrace("data",a),e("call:modification-in-progress",a)}function C(a,b){d.logDebug("call.on: state-changed"),d.logInfo("call:state-changed event from Att.rtc.Phone"),d.logTrace("data",b),null!==Ra.currentCall&&Ra.currentCall.id()!==a.id()&&(b.background=!0),e("call:state-changed",b)}function D(a,b){d.logDebug("call.on: notification"),d.logInfo("notification event by ATT.rtc.Phone"),("conference"!==a.breed()||c.CALL_TYPE.OUTGOING!==a.type())&&q(a),e("notification",b)}function E(a){d.logDebug("call.on: transferring"),d.logInfo("call:transferring event by ATT.rtc.Phone"),e("call:transferring",a)}function F(a){d.logDebug("call.on: transferred"),d.logInfo("call:transferred event by ATT.rtc.Phone"),e("call:transferred",a)}function G(a){d.logDebug("ATT.rtc.Phone: onSessionReady"),d.logTrace("data",a),Ra.off("ready",G),e("session:ready",a)}function H(a){d.logDebug("ATT.rtc.Phone: onSessionDisconnected"),d.logTrace("data",a),Ra.off("ready",G),Ra.off("disconnected",H),e("session:disconnected",a)}function I(a){e("dtmf:tone-sending",a)}function J(a){e("dtmf:tone-sent",a)}function K(a){return a=a.replace(/\s/g,""),a.indexOf("sip:")>-1||a.indexOf("tel:")>-1?!0:!1}function L(){return Ra}function M(){return Va}function N(){return Va[Va.length-1]}function O(a){d.logDebug("ATT.rtc.Phone: cleanPhoneNumber");try{return d.logInfo("Attempting to clean the phone number "+a),ATT.phoneNumber.cleanPhoneNumber(a)}catch(b){d.logError("Error during cleanPhoneNumber"),d.logTrace(b),g("3810",b)}}function P(a){d.logDebug("ATT.rtc.Phone: formatNumber");try{return d.logInfo("Attempting to format the phone number "+a),ATT.phoneNumber.formatNumber(a)}catch(b){d.logError("Error during formatNumber"),d.logTrace(b),g("3820",b)}}function Q(a){if(void 0===a)return null;var b,c={};try{a.indexOf(";")>-1&&(b=a.split(";"),b.forEach(function(b,d){if(0===d)a=b;else if(b.indexOf("=")>-1){var e=b.split("=");e.length>0&&(c[e[0]]=2===e.length?e[1]:"")}})),a.indexOf(":")>-1&&(b=a.split(":"),c.protocol=b.length>0?b[0]:"",a=b.length>=2?b[1]:"",c.port=b.length>=3?b[2]:""),b=a.split("@"),c.callerId=b.length>0?b[0]:"",c.domain=b.length>=2?b[1]:""}catch(e){d.logError("Error during getCallerInfo"),d.logTrace(e),g("3830",e)}return c}function R(a,b){return d.logDebug("ATT.rtc.Phone: on"),d.logInfo("Subscribing to phone event: "+a),void 0===a||"function"!=typeof b?void g("4901"):("session:ready"!==a&&"session:disconnected"!==a&&"session:call-switched"!==a&&"session:expired"!==a&&"gateway:unreachable"!==a&&"notification"!==a&&"dialing"!==a&&"answering"!==a&&"call:incoming"!==a&&"call:connecting"!==a&&"call:connected"!==a&&"call:disconnecting"!==a&&"call:disconnected"!==a&&"call:muted"!==a&&"call:unmuted"!==a&&"call:held"!==a&&"call:resumed"!==a&&"call:canceled"!==a&&"call:rejected"!==a&&"call:moved"!==a&&"call:transferring"!==a&&"call:transferred"!==a&&"address-updated"!==a&&"call:ringback-provided"!==a&&"media:captured"!==a&&"media:established"!==a&&"conference:invitation-received"!==a&&"conference:joining"!==a&&"conference:invitation-sending"!==a&&"conference:invitation-rejected"!==a&&"conference:connecting"!==a&&"conference:invitation-sent"!==a&&"conference:invitation-accepted"!==a&&"conference:participant-removed"!==a&&"conference:held"!==a&&"conference:resumed"!==a&&"conference:disconnecting"!==a&&"conference:ended"!==a&&"conference:canceled"!==a&&"conference:connected"!==a&&"warning"!==a&&"error"!==a&&"call:modification-in-progress"!==a&&"call:media-modification"!==a&&"call:state-changed"!==a&&"dtmf:tone-sending"!==a&&"dtmf:tone-sent"!==a&&g("4902"),Qa.unsubscribe(a,b),void Qa.subscribe(a,b,this))}function S(a){return void 0===a?void g("5101"):h(a.localMedia)?void g("5111"):h(a.remoteMedia)?void g("5112"):void i(a)}function T(a){if(void 0===a)return void g("5001");if(void 0===a.mediaType)return void g("5011");if(-1===["audio","video"].indexOf(a.mediaType))return void g("5012");try{n(a.mediaType,function(a){e("media:captured",a)},function(a){g("0020",a)})}catch(b){g("5000",b)}}function U(){o()}function V(){d.logDebug("ATT.rtc.Phone: getCalls");var a,b,c,e,f=Ra.getCalls(),g=[];d.logInfo("Getting list of calls...");for(a in f)if(f.hasOwnProperty(a)){if(d.logTrace("call id",a),b={index:f[a].index(),state:f[a].state(),breed:f[a].breed(),type:f[a].type()},"conference"===f[a].breed()){b.participants=[],e=f[a].participants(),d.logTrace("Participants",Object.keys(e).length);for(c in e)e.hasOwnProperty(c)&&(d.logTrace("participant",c),b.participants.push(e[c]))}else b.peer=f[a].peer();g.push(b)}return d.logTrace("Call List",g),g}function W(a){if(d.logDebug("ATT.rtc.Phone: login"),d.logTrace("options",a),void 0===a)return void g("2001");if(void 0===a.token)return void g("2002");if(null!==Ra.getId())return void g("2003");try{Ra.on("ready",G),d.logInfo("logging in..."),Ra.connect(a)}catch(b){d.logError("Error during login"),d.logTrace(b),g("2000",b)}}function X(a){if(d.logDebug("ATT.rtc: associateAccessToken"),d.logInfo("Associating access token  Domain"),void 0===a||0===Object.keys(a).length)throw new Error("No options provided");if(void 0===a.userId)throw new Error("No userId provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.success)throw new Error("No success callback provided");if(void 0===a.error)throw new Error("No error callback provided");Ra.associateToken(a)}function Y(a){if(d.logDebug("ATT.rtc.Phone: associateE911Id"),void 0===a)return void g("2051");if("string"!=typeof a.e911Id)return void g("2052");if(null===Ra.getId())return void g("2053");try{Ra.on("address-updated",function(a){d.logDebug("session.on: address-updated"),d.logInfo("address-updated event by ATT.rtc.Phone"),e("address-updated",a)}),d.logTrace(Ra.getId(),Ra),d.logTrace("E911 Id",Ra.e911Id),d.logInfo("Associating E911 Id..."),Ra.associateE911Id(a)}catch(b){d.logInfo("Error during associateE911Id"),d.logTrace(b),g("2050",b)}}function Z(){function a(){d.logDebug("session.on: all-calls-terminated"),d.logInfo("All calls were terminated successfully"),Ra.off("all-calls-terminated",a),d.logInfo("logging out..."),Ra.disconnect()}if(d.logDebug("ATT.rtc.Phone: logout"),Ra.on("error",H),null===Ra.getId())return void g("2101");try{d.logInfo("logging out..."),Ra.on("disconnected",H),null!==Ra.pendingCall&&(d.logInfo("Pending call exist. Deleting pending call..."),d.logTrace(Ra.pendingCall.peer(),Ra.pendingCall),Ra.deletePendingCall()),Object.keys(Ra.getCalls()).length>0?(d.logInfo("Active calls exist. Attempting to disconnect active calls..."),Ra.on("all-calls-terminated",a),Ra.terminateCalls()):(d.logInfo("logging out..."),Ra.disconnect())}catch(b){d.logError("Error during logout"),d.logTrace(b),g("2100",b)}}function $(a,b,c,e){try{j("local",b),d.logTrace("localStream",b),a.addStream(b),d.logInfo("Connecting..."),a.connect(),c()}catch(f){d.logError("Unknown exception during phone.connectCall."),d.logTrace(f),e(f)}}function _(a,b,e,f){return d.logDebug("ATT.rtc.Phone: connectCall"),a.on("stream-added",A.bind(null,a)),"object"==typeof f?void $(a,f,b,e):(void 0===f&&(f=a.mediaType()),d.logInfo("Attempting to get user media"),void n(f,function(c){d.logDebug("getUserMedia: onSuccess"),d.logInfo("Got local user media"),$(a,c,b,e)},function(a){d.logDebug("getUserMedia: onError"),d.logError("Error during getUserMedia"),null!==Ra.pendingCall&&c.CALL_TYPE.INCOMING===Ra.pendingCall.type()&&ia(),g("0020",a)}))}function aa(a){var b;i({localMedia:a.localMedia,remoteMedia:a.remoteMedia
});try{e("dialing",{to:a.destination,mediaType:a.mediaType,timestamp:new Date}),d.logInfo("Creating new call..."),b=Ra.createCall({peer:a.destination,breed:"call",type:c.CALL_TYPE.OUTGOING,mediaType:a.mediaType,localMedia:a.localMedia,remoteMedia:a.remoteMedia}),d.logTrace(b.peer(),b),b.on("connecting",function(a){d.logDebug("call.on: connecting"),d.logInfo("call:connecting event by ATT.rtc.Phone"),d.logTrace("data",a),e("call:connecting",a)}),b.on("rejected",t.bind(null,b)),b.on("connected",z),b.on("held",w),b.on("resumed",x),b.on("moved",y),b.on("disconnected",r.bind(null,b)),b.on("modification-in-progress",B),b.on("state-changed",C.bind(null,b)),b.on("notification",D.bind(null,b)),b.on("error",p),b.on("media-modification",function(a){d.logDebug("call.on: media-modification"),d.logInfo("call:media-modification event by ATT.rtc.Phone"),d.logTrace("data",a),e("call:media-modification",a)}),d.logInfo("Dialing..."),_(b,function(){d.logDebug("ATT.rtc.Phone: connectCall: success"),d.logDebug("Successfully connected call with media stream")},function(a){d.logDebug("ATT.rtc.Phone: connectCall: error"),d.logError("Error during connectCall"),d.logTrace(a),g("2200",a)},a.localStream||a.mediaType)}catch(f){d.logError("Error during dial"),d.logTrace(f),g("2200",f)}}function ba(a){return d.logDebug("ATT.rtc.Phone: dial"),d.logInfo("Dialing a call.."),d.logTrace("options",a),void 0===a?void g("2201"):"string"==typeof a.destination&&0<a.destination.length?K(a.destination)?void g("2212"):a.destination.split("@").length>2?void g("2213"):void 0!==a.mediaType&&-1===["audio","video"].indexOf(a.mediaType)?void g("2221"):void 0!==a.localMedia&&h(a.localMedia)?void g("2231"):void 0!==a.remoteMedia&&h(a.remoteMedia)?void g("2232"):null===Ra.getId()?void g("2241"):Ra.pendingCall?void g("2251"):null!==Ra.currentCall?void g("2252"):void aa(a):void g("2211")}function ca(a){function b(){d.logDebug("ATT.rtc.Phone: dialSecondCall"),c.off("held",b),d.logInfo("Dialing second call..."),aa(a)}d.logDebug("ATT.rtc.Phone: addCall"),d.logTrace("options",a);var c;if(void 0===a)return void g("3901");if(void 0===a.destination)return void g("3911");if(K(a.destination))return void g("3912");if(a.destination.split("@").length>2)return void g("3913");if(void 0!==a.mediaType&&"audio"!==a.mediaType&&"video"!==a.mediaType)return void g("3921");if(void 0!==a.localMedia&&h(a.localMedia))return void g("3931");if(void 0!==a.remoteMedia&&h(a.remoteMedia))return void g("3932");if(null===Ra.getId())return void g("3941");if(null===Ra.currentCall)return void g("3951");if(2<=V().length)return void g("3961");try{if(c=Ra.currentCall,d.logInfo("Putting existing call on hold"),"held"!==c.state())return c.on("held",b),c.hold(),void(c.autoresume=!0);b()}catch(e){d.logError("Error during hold current call"),d.logTrace(e),g("3900",e)}}function da(a,b){d.logDebug("ATT.rtc.Phone: answerCall"),d.logTrace("options",b),e("answering",{from:a.peer(),mediaType:a.mediaType(),codec:a.codec(),timestamp:new Date}),a.on("connecting",function(a){d.logDebug("call.on: connecting"),d.logInfo("call:connecting event by ATT.rtc.Phone"),d.logTrace("data",a),e("call:connecting",a)}),a.on("connected",z),a.on("held",w),a.on("resumed",x),a.on("moved",y),a.on("notification",D.bind(null,a)),a.on("modification-in-progress",B),a.on("media-modification",function(a){d.logDebug("call.on: media-modification"),d.logInfo("call:media-modification event by ATT.rtc.Phone"),d.logTrace("data",a),e("call:media-modification",a)}),a.on("state-changed",C.bind(null,a)),a.on("error",p),d.logInfo("Answering..."),_(a,function(){d.logDebug("ATT.rtc.Phone: connectCall: success"),d.logDebug("Successfully connected call with media stream")},function(a){d.logDebug("ATT.rtc.Phone: connectCall: error"),d.logError("Error during connect"),d.logTrace(a),g("2300",a)},b.localStream)}function ea(a){function b(){d.logDebug("ATT.rtc.Phone: answerSecondCall"),d.logInfo("Answering second call"),c="end"===a.action?"disconnected":"held",f.off(c,b),da(e,a)}d.logDebug("ATT.rtc.Phone: answer"),d.logTrace("options",a);var c,e,f;if(void 0===a)return void g("2301");if(void 0!==a.localMedia&&h(a.localMedia))return void g("2311");if(void 0!==a.remoteMedia&&h(a.remoteMedia))return void g("2312");if(i({localMedia:a.localMedia,remoteMedia:a.remoteMedia}),null===Ra.getId())return void g("2321");if(e=Ra.pendingCall,null===e)return void g("2331");try{if(f=Ra.currentCall,null!==f){if(d.logTrace(f.peer(),f),d.logInfo("There is an existing call"),"hold"!==a.action&&"end"!==a.action)return void g("2341");if("hold"===a.action){if("held"!==f.state())return d.logInfo("Putting the current call on hold"),f.on("held",b),f.hold(),void(f.autoresume=!0);b(e,a,!0)}return void("end"===a.action&&(d.logInfo("Ending the current call"),f.on("disconnected",b.bind(null,f)),f.disconnect()))}void 0!==a.action&&d.logWarning("There is no current call. Action `"+a.action+"` will be ignored"),da(e,a)}catch(j){d.logError("Error during answer"),d.logTrace(j),g("2300",j)}}function fa(){d.logDebug("ATT.rtc.Phone: hangup");var a;if(null===Ra.getId())return void g("2401");if(a=Ra.currentCall,null===a||null===a.id())return void g("2402");try{d.logTrace(a.peer(),a),a.on("disconnecting",function(a){d.logDebug("call.on: disconnecting"),d.logInfo("call:disconnecting event by ATT.rtc.Phone"),d.logTrace("data",a),e("call:disconnecting",a)}),d.logInfo("Hanging up..."),a.disconnect()}catch(b){d.logError("Error during hangup"),d.logTrace(b),g("2400",b)}}function ga(){d.logDebug("Att.rtc.Phone: cancel");var a;if(null===Ra.getId())return void g("2901");if(a=Ra.pendingCall,null===a)return void g("2902");try{d.logTrace(a.peer(),a),a.on("canceled",s.bind(null,a)),d.logInfo("Canceling..."),a.disconnect()}catch(b){d.logError("Error during cancel"),d.logTrace(b),g("2900",b)}}function ha(a){d.logDebug("ATT.rtc.Phone: setupStartConferenceEvents"),d.logTrace("options",a);var b;a.breed="conference",a.type=c.CALL_TYPE.OUTGOING,b=Ra.createCall(a),b.on("held",w),b.on("resumed",x),b.on("error",p),b.on("connected",function(a){d.logDebug("conference.on: connected"),d.logInfo("conference:connected event by ATT.rtc.Phone"),d.logTrace("data",a),Qa.publish("conference:connected",a)}),b.on("response-pending",function(a){d.logDebug("conference.on: response-pending"),d.logInfo("conference:invitation-sent event by ATT.rtc.Phone"),d.logTrace("data",a),Qa.publish("conference:invitation-sent",a)}),b.on("invite-accepted",function(a){d.logDebug("conference.on: invite-accepted"),d.logInfo("conference:invitation-accepted event by ATT.rtc.Phone"),d.logTrace("data",a),Qa.publish("conference:invitation-accepted",a)}),b.on("rejected",t.bind(null,b)),b.on("notification",D.bind(null,b)),b.on("participant-removed",function(a){d.logDebug("conference.on: participant-removed"),d.logInfo("conference:participant-removed event by ATT.rtc.Phone"),d.logTrace("data",a),Qa.publish("conference:participant-removed",a)}),b.on("state-changed",C.bind(null,b)),b.on("disconnected",r.bind(null,b)),d.logInfo("Starting conference..."),_(b,function(){d.logDebug("ATT.rtc.Phone: connectCall: success"),d.logDebug("Successfully connected conference with media stream")},function(a){d.logDebug("ATT.rtc.Phone: connectCall: error"),d.logError("Error during connectCall"),d.logTrace(a),g("3100",a)},a.localStream||a.mediaType)}function ia(){d.logDebug("Att.rtc.Phone: reject");var a;if(null===Ra.getId())return void g("3001");if(a=Ra.pendingCall,null===a||null===a.id())return void g("3002");try{a.on("rejected",t.bind(null,a)),d.logInfo("Rejecting..."),a.reject()}catch(b){d.logError("Error during reject"),d.logTrace(b),console.log(b.message),g("3000",b)}}function ja(a){function b(e){d.logDebug("ATT.rtc.Phone: startSecondConference"),Qa.publish("conference:held",e),c.off("held",b),d.logInfo("Starting second conference..."),ha(a)}d.logDebug("ATT.rtc.Phone: startConference"),d.logTrace("options",a);var c;if(void 0===a||0===Object.keys(a).length)return d.logError("No options provided"),void g("3101");if(void 0===a.mediaType||"audio"!==a.mediaType&&"video"!==a.mediaType)return d.logError("mediaType not provided"),void g("3111");if(void 0!==a.localMedia&&h(a.localMedia))return d.logError("localMedia not provided"),void g("3121");if(void 0!==a.remoteMedia&&h(a.remoteMedia))return d.logError("remoteMedia not provided"),void g("3122");if(null===Ra.getId())return d.logError("Cannot start session. user is not logged in"),void g("3131");if(2<=this.getCalls().length)return void g("3961");i({localMedia:a.localMedia,remoteMedia:a.remoteMedia});try{if(c=Ra.currentCall,null!==c)return d.logTrace(c.peer(),c),d.logInfo("There is an existing conference"),"held"===c.state()||"hold"===c.state()?void b():(d.logInfo("Putting the current conference on hold"),c.on("held",b),c.hold(),void(c.autoresume=!0));ha(a)}catch(e){d.logError("Error during start conference"),d.logTrace(e),console.log(e.message),g("3100",e)}}function ka(a,b){d.logDebug("ATT.rtc.Phone: setupJoinConferenceEvents"),d.logTrace("options",b),Qa.publish("conference:joining",{from:a.peer(),mediaType:a.mediaType(),codec:a.codec(),timestamp:new Date}),a.on("held",w),a.on("state-changed",C.bind(null,a)),a.on("error",p),a.on("connecting",function(a){d.logDebug("conference.on: connecting"),d.logInfo("conference:connecting event by ATT.rtc.Phone"),d.logTrace("data",a),Qa.publish("conference:connecting",a)}),a.on("connected",function(a){d.logDebug("conference.on: connected"),d.logInfo("conference:connected event by ATT.rtc.Phone"),d.logTrace("data",a),Qa.publish("conference:connected",a)}),a.on("notification",D.bind(null,a)),d.logInfo("Joining conference..."),_(a,function(){d.logDebug("ATT.rtc.Phone: connectCall: success"),d.logDebug("Successfully connected conference with media stream")},function(a){d.logDebug("ATT.rtc.Phone: connectCall: error"),d.logError("Error during connectCall"),d.logTrace(a),g("3200",a)},b.localStream)}function la(){if(d.logDebug("ATT.rtc.Phone: rejectConference"),null===Ra.getId())return void g("3301");if(null===Ra.pendingCall)return void g("3302");try{var a=Ra.pendingCall;d.logTrace(a.peer(),a),a.on("rejected",t.bind(null,a)),d.logInfo("Rejecting conference invite..."),a.reject()}catch(b){d.logError("Error during reject conference"),d.logTrace(b),g("3300",b)}}function ma(a){function b(){d.logDebug("ATT.rtc.Phone: joindSecondConference"),d.logInfo("Joining second conference"),c="held","end"===a.action&&(c="disconnected"),j.off(c,b),ka(f,a)}d.logDebug("ATT.rtc.Phone: joinConference"),d.logTrace("options",a);var c,e,f,j;if(void 0===a)return void g("3201");if(void 0!==a.localMedia&&h(a.localMedia))return d.logError("localMedia not provided"),void g("3211");if(void 0!==a.remoteMedia&&h(a.remoteMedia))return d.logError("remoteMedia not provided"),void g("3212");if(null===Ra.getId())return void g("3221");if(null===Ra.pendingCall||"conference"!==Ra.pendingCall.breed())return void g("3231");i({localMedia:a.localMedia,remoteMedia:a.remoteMedia}),f=Ra.pendingCall;try{if(j=Ra.currentCall,null!==j){if(d.logTrace(j.peer(),j),d.logInfo("There is an existing conference"),"hold"!==a.action&&"end"!==a.action)return void g("3241");if("hold"===a.action)return"held"===j.state()||"hold"===j.state()?void b():(d.logInfo("Putting the current conference on hold"),j.on("held",b),j.hold(),void(j.autoresume=!0));if("end"===a.action){if(d.logInfo("Ending the current conference"),e=j.breed(),j.on("disconnected",b),"conference"===e)return void j.disconnectConference();j.disconnect()}return}void 0!==a.action&&d.logWarning("There is no current call. Action `"+a.action+"` will be ignored"),ka(f,a),d.logTrace(f.peer(),f)}catch(k){d.logError("Error during joinConference"),d.logTrace(k),g("3200",k)}}function na(a){d.logDebug("ATT.rtc.Phone: addParticipant"),d.logTrace("participant",a);var b,c,f;if("string"!=typeof a||0===a.length)return void g("3611");if(d.logInfo("Validating participant to add"),K(a))return void g("3612");if(a.split("@").length>2)return void g("3613");if(null===Ra.getId())return void g("3621");if(b=Ra.currentCall,d.logTrace(b.peer(),b),null===b||"conference"!==b.breed())return d.logError("Conference not initiated "),void g("3631");d.logTrace("participant",a);try{if(d.logInfo("Adding Participant..."),d.logInfo("Getting list of current participants"),f=b.participants(),d.logTrace("currentParticipants",f),0<Object.keys(f).length)for(c in f)if(f.hasOwnProperty(c)&&c===a)return void g("3641",new Error(c+" is already a party to this conference"));e("conference:invitation-sending",{invitee:a,timestamp:new Date}),b.addParticipant(a)}catch(h){d.logInfo("Error during addParticipant"),d.logTrace(h),g("3600",h)}}function oa(){d.logDebug("ATT.rtc.Phone: getParticipants");var a,b;if(null===Ra.getId())return void g("3401");if(a=Ra.currentCall,null===a||"conference"!==a.breed())return void g("3402");try{return d.logTrace(a.peer(),a),d.logInfo("Getting participants..."),b=a.participants(),d.logTrace("participants",b),b}catch(c){d.logError("Error during getParticipants"),d.logTrace(c),g("3400",c)}}function pa(a){d.logDebug("ATT.rtc.Phone: removeParticipant");var b;if(void 0===a)return void g("3711");if(null===Ra.getId())return void g("3721");if(b=Ra.currentCall,null===b||"conference"!==b.breed())return void g("3731");try{d.logTrace(b.peer(),b),d.logInfo("Removing participant"),b.removeParticipant(a)}catch(c){d.logError("Error during removeParticipant"),d.logTrace(c),g("3700",c)}}function qa(){d.logDebug("ATT.rtc.Phone: endConference");var a;if(null===Ra.getId())return void g("3501");if(a=Ra.currentCall,null===a||"conference"!==a.breed())return void g("3502");try{d.logTrace(a.peer(),a),a.on("disconnecting",function(a){d.logDebug("conference.on: disconnecting"),d.logInfo("conference:disconnecting event by ATT.rtc.Phone"),d.logTrace("data",a),e("conference:disconnecting",a)}),d.logInfo("Disconnecting conference"),a.disconnectConference()}catch(b){d.logError("Error during endConference"),d.logTrace(b),g("3500",b)}}function ra(){d.logDebug("ATT.rtc.Phone: mute");var a;if(null===Ra.getId())return void g("2701");if(a=Ra.currentCall,null===a||null===a.id)return void g("2702");d.logTrace(a.peer(),a);try{if(a.off("muted",u),a.on("muted",u),a.muted())return d.logWarning("warning event by ATT.rtc.Phone"),void e("warning",{message:"Cannot mute call that is already muted"});d.logInfo("Muting..."),a.mute()}catch(b){d.logError("Error during mute"),d.logTrace(b),g("2700",b)}}function sa(){d.logDebug("ATT.rtc.Phone: unmute");var a;if(null===Ra.getId())return void g("2801");if(a=Ra.currentCall,null===a||null===a.id)return void g("2802");try{if(d.logTrace(a.peer(),a),a.off("unmuted",v),a.on("unmuted",v),!a.muted())return d.logWarning("warning event by ATT.rtc.Phone"),void e("warning",{message:"Cannot umute call that is not muted"});d.logInfo("Unmuting..."),a.unmute()}catch(b){d.logError("Error during unmute"),d.logTrace(b),g("2800",b)}}function ta(){d.logDebug("ATT.rtc.Phone: hold");var a;if(null===Ra.getId())return void g("2501");if(a=Ra.currentCall,null===a||null===a.id())return void g("2502");try{d.logTrace(a.peer(),a),a.validateOperation("hold"),d.logInfo("Holding..."),a.hold()}catch(b){if(d.logError("Error during hold"),d.logTrace(b),"Error"===b.name)return void g("2503",b);g("2500",b)}}function ua(){d.logDebug("ATT.rtc.Phone: resume");var a;if(null===Ra.getId())return void g("2601");if(a=Ra.currentCall,null===a||null===a.id())return void g("2602");try{d.logTrace(a.peer(),a),a.validateOperation("resume"),d.logInfo("Resuming..."),a.resume()}catch(b){if(d.logError("Error during resume"),d.logTrace(b),"Error"===b.name)return void g("2603",b);g("2600",b)}}function va(){d.logDebug("ATT.rtc.Phone: move");var a;if(null===Ra.getId())return void g("4001");if(a=Ra.currentCall,null===a||null===a.id())return void g("4002");if("conference"===a.breed())return void g("4004");try{d.logTrace(a.peer(),a),a.validateOperation("move"),d.logInfo("Moving..."),a.move()}catch(b){if(d.logError("Error during move"),d.logTrace(b),"Error"===b.name)return void g("4003",b);g("4000",b)}}function wa(){function a(){d.logDebug("ATT.rtc.Phone: switchToCall");var c,e,f;b.off("held",a),e=Ra.getCalls();for(c in e)if(e.hasOwnProperty(c)&&c!==b.id()){f=c;break}d.logInfo("Switching calls..."),d.logTrace("Switch to call id",f),Ra.switchTo(f)}d.logDebug("ATT.rtc.Phone: switchCall");var b=Ra.currentCall;if(null===Ra.getId())return void g("4201");if(null===Ra.currentCall||null===Ra.currentCall.id())return void g("4202");if(2>Object.keys(Ra.getCalls()).length)return void g("4203");try{if(d.logTrace(b.peer(),b),"held"!==b.state())return d.logInfo("Putting current call on hold"),b.on("held",a),b.hold(),void(b.autoresume=!0);a()}catch(c){d.logError("Error during switch"),d.logTrace(c),g("4200",c)}}function xa(){d.logDebug("ATT.rtc.Phone: transfer");var a,b,c,e;if(null===Ra.getId())return void g("4101");if(a=Ra.currentCall,null===a||null===a.id())return void g("4102");if("conference"===a.breed())return void g("4104");if(2>Object.keys(Ra.getCalls()).length)return void g("4105");try{d.logTrace("currentCall",a.peer()),d.logTrace("currentCall id",a.id()),d.logInfo("Retrieving background call for transfer"),b=Ra.getCalls();for(c in b)if(b.hasOwnProperty(c)&&c!==Ra.currentCall.id()){e=Ra.getCall(c);break}if(d.logTrace("backgroundCall",e.peer()),d.logTrace("backgroundCall id",e.peer()),"conference"===e.breed())return void g("4104");e.validateOperation("transfer"),e.off("transferring",E),e.on("transferring",E),e.off("transferred",F),e.on("transferred",F),d.logInfo("Transferring call with peer "+e.peer()+" to "+a.peer()),e.transfer({targetCallId:a.id()})}catch(f){if(d.logError("Error during transfer call"),d.logTrace(f),"Error"===f.name)return void g("4103",f);g("4100",f)}}function ya(){d.logInfo("Starting downgrade..."),d.logDebug("Phone: downgrade");var a;if(null===Ra.getId())return void g("4501");if(a=Ra.currentCall,null===a||void 0===a.id())return void g("4502");if("audio"===a.mediaType())return void g("4504");if("conference"===a.breed())return void g("4505");try{a.validateOperation("downgrade"),d.logInfo("Trying to get the audio media stream"),n("audio",function(b){d.logInfo("Successfully got user media."),Pa=b,a.removeStream(a.localStream()),a.addStream(Pa),j("local",Pa),a.connect()},function(a){d.logError("Failed to get user media during downgrade"),d.logTrace("error",a),g("0020",a)})}catch(b){if(d.logError("Error during downgrade"),d.logTrace(b),"Error"===b.name)return void g("4503",b);g("4500",b)}}function za(){d.logInfo("Starting upgrade..."),d.logDebug("ATT.rtc.Phone: upgrade");var a;if(null===Ra.getId())return void g("4601");if(a=Ra.currentCall,null===a)return void g("4602");if("video"===a.mediaType())return void g("4604");if("conference"===a.breed())return void g("4605");try{a.validateOperation("upgrade"),d.logInfo("Trying to get the video media stream"),n("video",function(b){d.logInfo("Entered onUserMedia"),Pa=b,a.removeStream(a.localStream()),a.addStream(Pa),j("local",Pa),a.connect()},function(a){d.logError("Failed to get user media during upgrade"),d.logTrace(a),g("0020",a)})}catch(b){if(d.logError("Error during upgrade"),d.logTrace(b),"Error"===b.name)return void g("4603",b);g("4600",b)}}function Aa(){d.logDebug("Phone: acceptModification");var a;if(null===Ra.getId())return void g("4301");if(a=Ra.currentCall,null===a||null===a.id())return void g("4302");if(void 0===a.modifications()||null===a.modifications())return void g("4304");try{a.validateOperation("acceptMod"),d.logInfo("Trying to get the "+a.modifications().mediaType+" media stream"),n(a.modifications().mediaType,function(b){d.logInfo("Successfully got user media."),Pa=b,a.removeStream(a.localStream()),a.addStream(Pa),j("local",Pa),a.connect()},function(a){d.logError("Failed to get user media during acceptModification"),d.logTrace("error",a),g("0020")})}catch(b){if(d.logInfo("Error during acceptModification"),d.logTrace("error",b),"Error"===b.name)return void g("4303",b);g("4300",b)}}function Ba(){d.logDebug("Phone: rejectModification");var a;if(null===Ra.getId())return void g("4401");if(a=Ra.currentCall,null===a||null===a.id())return void g("4402");if(void 0===a.modifications()||null===a.modifications())return void g("4404");try{a.validateOperation("rejectMod"),d.logInfo("Rejecting media modification..."),a.connect()}catch(b){if(d.logInfo("Error during rejectModification"),d.logTrace("error",b),"Error"===b.name)return void g("4403",b);g("4400",b)}}function Ca(){d.logDebug("ATT.rtc.Phone: getMediaType"),d.logInfo("Getting current call media type...");var a=Ra.currentCall;return d.logTrace(a.peer(),a),d.logTrace("MediaType",a.mediaType()),a?a.mediaType():null}function Da(){d.logDebug("ATT.rtc.Phone: isCallInProgress"),d.logInfo("Checking if current call exists...");var a=Ra.currentCall;return null!==a?(d.logTrace("Call in progress",!0),d.logTrace(a.peer(),a),!0):(d.logTrace("Call in not in progress",!1),!1)}function Ea(a){d.logDebug("ATT.rtc.Phone: sendDTMFTone"),d.logInfo("Sending DTMF tone..."),d.logTrace("options",a);var b;if(void 0===a)return void g("4711");if(void 0===a.input)return void g("4712");if(null===Ra.getId())return void g("4721");if(b=Ra.currentCall,null===b||null===b.id())return void g("4731");try{b.validateOperation("sendDTMFTone"),b.off("tone-sending",I),b.off("tone-sent",J),b.on("tone-sending",I),b.on("tone-sent",J),d.logInfo("sending the dial tone"),b.sendDTMFTone(a)}catch(c){if(d.logInfo("Error during sendDTMDTone"),d.logTrace("error",c),"Error"===c.name)return void g("4741",c);g("4700",c)}}function Fa(){d.logDebug("ATT.rtc.phone: getIceServers"),d.logInfo("getting current iceServer value of peerConnection");var a=Ra.getPCConfiguration().iceServers;return d.logTrace("iceServers",a),a}function Ga(a){d.logDebug("ATT.rtc.phone: setIceServers"),d.logInfo("sets the new iceServers value to peerConnection"),d.logTrace("iceServers",a);try{Ra.setPCConfiguration({iceServers:a})}catch(b){g("4811",b)}}function Ha(){d.logDebug("ATT.rtc.phone: resetIceServers"),d.logInfo("Reset iceServers value of peerConnection to default"),Ra.resetPCConfiguration("iceServers")}function Ia(){d.logDebug("ATT.rtc.phone: getIceTransport"),d.logInfo("getting current iceTransport value of peerConnection");var a=Ra.getPCConfiguration().iceTransports;return d.logTrace("iceTransports",a),a}function Ja(a){d.logDebug("ATT.rtc.phone: setIceTransport"),d.logInfo("sets the new iceTransport value to peerConnection"),d.logTrace("iceTransports",a);try{Ra.setPCConfiguration({iceTransports:a})}catch(b){g("4821",b)}}function Ka(){d.logDebug("ATT.rtc.phone: resetIceTransport"),d.logInfo("Reset iceTransport value of peerConnection to default"),Ra.resetPCConfiguration("iceTransports")}function La(){d.logDebug("ATT.rtc.phone: getIpv6"),d.logInfo("getting current ipv6 value of peerConnection");var a=Ra.getPCConfiguration().ipv6;return d.logTrace("ipv6",a),a}function Ma(a){d.logDebug("ATT.rtc.phone: setIpv6"),d.logInfo("sets the new ipv6 value to peerConnection"),d.logTrace("ipv6",a);try{Ra.setPCConfiguration({ipv6:a})}catch(b){g("4831",b)}}function Na(){d.logDebug("ATT.rtc.phone: resetIpv6"),d.logInfo("Reset ipv6 value of peerConnection to default"),Ra.resetPCConfiguration("ipv6")}function Oa(){return Ra.getVersion()}var Pa,Qa=b.createEventEmitter(),Ra=new ATT.rtc.Session,Sa=ATT.errorDictionary,Ta=null,Ua=null,Va=[];d.logDebug("ATT.rtc.Phone: Constructor"),d.logInfo("Creating a new instance of Phone"),Ra.on("call:incoming",function(a){d.logDebug("session.on: call:incoming"),d.logInfo("call:incoming event  by ATT.rtc.Phone"),d.logTrace("data",a),e("call:incoming",a),Ra.pendingCall&&(Ra.pendingCall.on("canceled",s.bind(null,Ra.pendingCall)),Ra.pendingCall.on("disconnected",r.bind(null,Ra.pendingCall)))}),Ra.on("conference-invite",function(a){d.logDebug("session.on: conference-invite"),d.logInfo("conference:invitation-received event by ATT.rtc.Phone"),d.logTrace("data",a),e("conference:invitation-received",a),Ra.pendingCall&&(Ra.pendingCall.on("canceled",s.bind(null,Ra.pendingCall)),Ra.pendingCall.on("disconnected",r.bind(null,Ra.pendingCall)))}),Ra.on("call:switched",function(a){d.logDebug("session.on: call:switched"),d.logInfo("session:call-switched event by ATT.rtc.Phone"),d.logTrace("data",a),e("session:call-switched",a)}),Ra.on("notification",function(a){d.logDebug("session.on: notification"),d.logInfo("notification event by ATT.rtc.Phone"),d.logTrace("data",a),e("notification",a)}),Ra.on("error",p),this.on=R,this.setup=S,this.getSession=L,this.associateAccessToken=X,this.associateE911Id=Y,this.login=W,this.logout=Z,this.dial=ba,this.addCall=ca,this.answer=ea,this.hangup=fa,this.cancel=ga,this.reject=ia,this.move=va,this.transfer=xa,this.downgrade=ya,this.upgrade=za,this.acceptModification=Aa,this.rejectModification=Ba,this.startConference=ja,this.joinConference=ma,this.endConference=qa,this.rejectConference=la,this.addParticipant=na,this.getParticipants=oa,this.removeParticipant=pa,this.mute=ra,this.unmute=sa,this.hold=ta,this.resume=ua,this.switchCall=wa,this.eventsPublished=M,this.lastEventPublished=N,this.getUserMedia=T,this.releaseLocalUserMedia=U,this.getCalls=V,this.getMediaType=Ca,this.isCallInProgress=Da,this.cleanPhoneNumber=O,this.formatNumber=P,this.getCallerInfo=Q,this.sendDTMFTone=Ea,this.getIceServers=Fa,this.setIceServers=Ga,this.resetIceServers=Ha,this.getIceTransport=Ia,this.setIceTransport=Ja,this.resetIceTransport=Ka,this.getIpv6=La,this.setIpv6=Ma,this.resetIpv6=Na,this.getVersion=Oa,void 0!==a&&a.test&&(this.localMedia=function(){return Ta},this.remoteMedia=function(){return Ua},this.localStream=function(){return Pa},this.setLocalStream=function(a){Pa=a})}var b=ATT["private"].factories,c=ATT["private"]["enum"],d=ATT.logManager.createLogger("phone");if(d.logDebug("Loading att.rtc.phone..."),void 0===ATT["private"])throw new Error("Error exporting ATT.private.Phone.");if(ATT["private"].Phone=a,void 0===ATT.rtc)throw new Error("Error exporting ATT.rtc.Phone.");ATT.rtc.Phone=function(){var b;return{getPhone:function(){return d.logDebug("ATT.rtc.Phone: getPhone"),void 0===b&&(b=new a),b}}}()}(),function(){"use strict";function a(a){if(i.logDebug("ATT.rtc: configure"),i.logTrace("options",a),i.logDebug("Configuring the SDK"),void 0===a||0===Object.keys(a).length)throw new Error("No options provided");h.app.setAppConfiguration(a)}function b(){return ATT.rtc.Phone.getPhone().getSession()}function c(){return b().getSupportedAudioCodecs()}function d(){return b().getPCConfiguration().audioCodec}function e(a){b().setPCConfiguration({audioCodec:a})}function f(){b().resetPCConfiguration("audioCodec")}function g(){return b().getVersion()}var h=ATT["private"].config,i=ATT.logManager.createLogger("rtc");i.logDebug("Loading att.rtc..."),ATT.rtc.getSupportedAudioCodecs=c,ATT.rtc.getAudioCodec=d,ATT.rtc.setAudioCodec=e,ATT.rtc.resetAudioCodec=f,ATT.rtc.configure=a,ATT.rtc.getVersion=g}(),function(){"use strict";var a,b=ATT.logManager.createLogger("main");return b.logDebug("Loading att.main..."),b.logInfo("Attempting to load Enhanced WebRC SDK..."),void 0===window.ATT?void b.logError("Cannot load ATT's Enhanced WebRTC SDK. ATT is not defined."):(a=window.ATT,window.ATT=void 0,"Not Supported"===a.browser.hasWebRTC()?(window.ATT={browser:a.browser},void b.logError("Failed to load ATT's Enhanced WebRTC SDK. The browser doesn't support Enhanced WebRTC")):(window.ATT=a,b.logInfo("Loading error dictionary..."),void 0===ATT["private"].createErrorDictionary?void b.logError("Failed to load error dictionary. Missing ATT.private.createErrorDictionary."):(ATT.errorDictionary=ATT["private"].createErrorDictionary(ATT["private"].errorStore.SDKErrors,ATT["private"].errorStore.APIErrors),(void 0===ATT.errorDictionary||null===ATT.errorDictionary)&&b.logError("Failed to create error dictionary"),b.logInfo("Loading error dictionary complete"),void b.logInfo("Loading Enhanced WebRC SDK complete"))))}();